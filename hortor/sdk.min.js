function e(e, t) {
    function n() {
        this.constructor = e;
    }
    Pt(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype,
        new n());
}

function t(e, t, n, r) {
    return new(n || (n = Promise))(function (i, o) {
        function s(e) {
            try {
                c(r.next(e));
            } catch (e) {
                o(e);
            }
        }

        function a(e) {
            try {
                c(r.throw(e));
            } catch (e) {
                o(e);
            }
        }

        function c(e) {
            e.done ? i(e.value) : new n(function (t) {
                t(e.value);
            }).then(s, a);
        }
        c((r = r.apply(e, t || [])).next());
    });
}

function n(e, t) {
    function n(n) {
        return function (s) {
            return function (n) {
                if (r) throw new TypeError("Generator is already executing.");
                for (; a;) try {
                    if (r = 1, i && (o = 2 & n[0] ? i.return : n[0] ? i.throw || ((o = i.return) && o.call(i),
                            0) : i.next) && !(o = o.call(i, n[1])).done) return o;
                    switch (i = 0, o && (n = [2 & n[0], o.value]), n[0]) {
                        case 0:
                        case 1:
                            o = n;
                            break;

                        case 4:
                            return a.label++, {
                                value: n[1],
                                done: !1
                            };

                        case 5:
                            a.label++, i = n[1], n = [0];
                            continue;

                        case 7:
                            n = a.ops.pop(), a.trys.pop();
                            continue;

                        default:
                            if (o = a.trys, !((o = o.length > 0 && o[o.length - 1]) || 6 !== n[0] && 2 !== n[0])) {
                                a = 0;
                                continue;
                            }
                            if (3 === n[0] && (!o || n[1] > o[0] && n[1] < o[3])) {
                                a.label = n[1];
                                break;
                            }
                            if (6 === n[0] && a.label < o[1]) {
                                a.label = o[1], o = n;
                                break;
                            }
                            if (o && a.label < o[2]) {
                                a.label = o[2], a.ops.push(n);
                                break;
                            }
                            o[2] && a.ops.pop(), a.trys.pop();
                            continue;
                    }
                    n = t.call(e, a);
                } catch (e) {
                    n = [6, e], i = 0;
                } finally {
                    r = o = 0;
                }
                if (5 & n[0]) throw n[1];
                return {
                    value: n[0] ? n[1] : void 0,
                    done: !0
                };
            }([n, s]);
        };
    }
    var r, i, o, s, a = {
        label: 0,
        sent: function () {
            if (1 & o[0]) throw o[1];
            return o[1];
        },
        trys: [],
        ops: []
    };
    return s = {
        next: n(0),
        throw: n(1),
        return: n(2)
    }, "function" == typeof Symbol && (s[Symbol.iterator] = function () {
        return this;
    }), s;
}

function r() {
    for (var e = 0, t = 0, n = arguments.length; t < n; t++) e += arguments[t].length;
    var r = Array(e),
        i = 0;
    for (t = 0; t < n; t++)
        for (var o = arguments[t], s = 0, a = o.length; s < a; s++,
            i++) r[i] = o[s];
    return r;
}

function i(e) {
    for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
    Un.sdkConfig().isHideLog || console.log.apply(console, r([At(e)], t));
}

function o(e) {
    for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
    Un.sdkConfig().isHideLog || console.info.apply(console, r([At(e)], t));
}

function s(e) {
    for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
    Un.sdkConfig().isHideLog || console.warn.apply(console, r([At(e)], t));
}

function a(e) {
    var t = this;
    this.data = e, this._stopped = !1, this.stopPropagation = function () {
        t._stopped = !0;
    }, this.isStopped = function () {
        return t._stopped;
    };
}

function c() {
    this.timer = null;
}

function u(e, t) {
    var n = d().SDKVersion;
    return !(!wx[e] || !yn.geVersion(n, t));
}

function d() {
    return hn || ((hn = wx.getSystemInfoSync()).hortorSDKVersion = Ut), hn || {};
}

function l() {
    if (!gn) {
        var e = d();
        gn = JSON.stringify({
            SDKVersion: e.SDKVersion,
            brand: e.brand,
            model: e.model,
            system: e.system,
            version: e.version,
            screenHeight: e.screenHeight,
            screenWidth: e.screenWidth,
            pixelRatio: e.pixelRatio,
            benchmarkLevel: e.benchmarkLevel,
            hortorSDKVersion: e.hortorSDKVersion
        });
    }
    return gn;
}

function f() {
    return t(this, void 0, void 0, function () {
        return n(this, function (e) {
            switch (e.label) {
                case 0:
                    return fn ? [3, 2] : (u("offNetworkStatusChange", "2.8.1") && yn.defineProperty(wx, "offNetworkStatusChange", m),
                        p(), [4, h()]);

                case 1:
                    fn = e.sent(), e.label = 2;

                case 2:
                    return [2, fn];
            }
        });
    });
}

function h() {
    return new Promise(function (e, t) {
        wx.getNetworkType({
            success: e,
            fail: t
        });
    });
}

function g(e) {
    yn.isFun(e) && u("onNetworkStatusChange", "1.1.0") && wx.onNetworkStatusChange(e);
}

function p() {
    g(function (e) {
        fn = e;
    });
}

function m(e) {
    return function (t) {
        yn.isFun(e) && e(t), p();
    };
}

function v() {
    var e = d(),
        t = e.screenHeight,
        n = void 0 === t ? 0 : t,
        r = e.screenWidth;
    return {
        result: n / (void 0 === r ? 1 : r) > 2
    };
}

function y(e) {
    return d().platform === e;
}

function w() {
    return y("ios");
}

function I() {
    return y("devtools");
}

function _(e, t) {
    return new Promise(function (n, r) {
        e().then(function (e) {
            n(e);
        }).catch(function (i) {
            t > 1 ? _(e, t - 1).then(function (e) {
                return n(e);
            }).catch(function (e) {
                return r(e);
            }) : r(i);
        });
    });
}

function S(e) {
    try {
        return JSON.stringify(e);
    } catch (e) {
        return "";
    }
}

function T() {
    var e = new Date(),
        t = e.getFullYear(),
        n = String(e.getMonth() + 1);
    1 === n.length && (n = "0" + n);
    var r = String(e.getDate());
    1 === r.length && (r = "0" + r);
    var i = String(e.getHours());
    1 === i.length && (i = "0" + i);
    var o = String(e.getMinutes());
    1 === o.length && (o = "0" + o);
    var s = String(e.getSeconds());
    1 === s.length && (s = "0" + s);
    var a = String(e.getMilliseconds());
    return 1 === a.length ? a = "00" + a : 2 === a.length && (a = "0" + a), t + "-" + n + "-" + r + " " + i + ":" + o + ":" + s + "." + a;
}

function b(e, t) {
    var n = xn[e] || [];
    n.push(t), xn[e] = n;
}

function C(e, r) {
    return t(this, void 0, void 0, function () {
        var t, i, o, s;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    if (!(t = this.getProcessors(e))) return [2, r];
                    i = {}, o = 0, n.label = 1;

                case 1:
                    return o < t.length ? [4, t[o](r)] : [3, 4];

                case 2:
                    s = n.sent(), i = Object.assign(i, s || {}), n.label = 3;

                case 3:
                    return o++, [3, 1];

                case 4:
                    return [2, i];
            }
        });
    });
}

function x() {
    return wx.getLaunchOptionsSync();
}

function k(e) {
    wx.onShow(e);
}

function O(e) {
    wx.onHide(e);
}

function P(e) {
    setTimeout(function () {
        i("onShow", e), i("_launchOptions", Sn);
    }, 1e3), Sn = Et(Et({}, e), {
        custom: E(e)
    });
}

function E(e) {
    var t = (e || {}).query,
        n = void 0 === t ? {} : t,
        r = {
            channel: n.channel || n.c || "hortor",
            origChannel: n.origChannel || "",
            shareConfigId: n.shareConfigId || "",
            activityId: n.activityId || "",
            h_shareCode: n.h_shareCode || "",
            pageQuery: n.scene || "",
            boxCode: n.wallCode || n.horwall || ""
        },
        i = yn.queryToJson(n.scene);
    return r.channel = i.channel || i.c || r.channel, r.origChannel = i.origChannel || r.origChannel,
        r.boxCode = i.wallCode || i.horwall || r.boxCode, r;
}

function A(e, t) {
    return "function" == typeof (null == e ? void 0 : e.listener) ? e : (s("请正确调用api: ", t + "({ listener: listenFunction })"),
        "function" == typeof e ? {
            listener: e
        } : {
            listener: function () {}
        });
}

function U() {
    return Sn || P(x()), Sn || {};
}

function D() {
    return Un.sdkConfig() || {};
}

function M(e, t) {
    void 0 === t && (t = {});
    try {
        var n = Tn.platform.information,
            r = (n && n.getUserInfo() || {}).uniqueId,
            i = (D() || {}).gameId;
        bn.post(tn.logHost + "/wxlog/api/v1/log", {
            msg: e,
            err: JSON.stringify(t),
            combGameId: Un.option.combGameId,
            subGameId: i,
            uniqueId: r,
            gameTp: "minigame"
        }).catch(console.log);
    } catch (e) {
        console.warn("postMonitor err", e);
    }
}

function N(e) {
    return "https://" + e + ".hortorgames.com";
}

function L() {
    return new Promise(function (e, t) {
        wx.getSetting({
            withSubscriptions: !0,
            success: function (t) {
                i("wx setting ", JSON.parse(JSON.stringify(t))), e(t);
            },
            fail: function (e) {
                t(e);
            }
        });
    });
}

function R(e) {
    var t = e || {},
        n = t.adUnitId;
    return yi = t.customScene, this.options = e || {}, this.adUnitId = n, this.adInstance = null,
        this.destroyed = !1, this.create(e), this;
}

function q() {
    var e = D(),
        t = e.videoCoolTime,
        n = e.videoTimeout;
    this.adInstance = void 0, this.loaded = !1, this.loading = !0, this.loadReported = !1,
        this.coolLoad = !1, this.coolTimer = null, this.loadCoolTime = t || 18e4, this.callTimeout = n || 5e3,
        this.destroyed = !1, this.fstLoaded = !1, this.cacheQueue = [], this.isOnlyUseWX = !0,
        this.cacheHortorAdInfo = null, this.isNeedConsumeQueue = !0, this.preAd = 0, this.videoPlayFreezeTime = 0,
        this.videoPlayFreezeEnable = 0, this.activeFreezeTime = 0, this.freezeTimer = 0,
        Zt.on(Or, this._initVideoFreezeTime.bind(this));
}

function H(e) {
    for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
    "function" == typeof e && e.apply(void 0, t);
}

function F() {
    var e = D().gameId,
        t = tn.combHost + "/comb-ad-server/api/v1/combAd?gameId=" + e + "&gameTp=minigame&adTp=miniGameWxAdId";
    return new Promise(function (e, n) {
        bn.get(t).then(function (t) {
            var r;
            0 === (null === (r = null == t ? void 0 : t.meta) || void 0 === r ? void 0 : r.errCode) ? (Ci = t.data || {},
                e(Ci)) : n(null == t ? void 0 : t.meta);
        }).catch(function (e) {
            i("err", e), n(e);
        });
    });
}

function j() {
    return Ci ? Promise.resolve(Ci) : F();
}

function V(e, t, n) {
    var r = e[t];
    Object.defineProperty(e, t, {
        value: n(r)
    });
}

function G(e) {
    Yi.length <= 10 && Yi.push(e);
}

function W(e) {
    $i.length <= 10 && $i.push(e);
}

function K(e) {
    io.notify(e);
}

function B() {
    return new Promise(function (e, t) {
        wx.getUserInfo({
            withCredentials: !0,
            lang: "zh_CN",
            success: function (n) {
                if ((n || {}).encryptedData) return e(n);
                t(er);
            },
            fail: t
        });
    });
}

function z(e, r) {
    return t(this, void 0, void 0, function () {
        var t;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return An.login = Date.now(), we({
                        eventName: "sdk_startlogin"
                    }), Zt.dispatch(jt), [4, X(e, r, !1)];

                case 1:
                    return t = n.sent(), fe(3), Zt.dispatch(Vt, t),
                        function () {
                            if (!Ro) {
                                Ro = !0;
                                var e = (D() || {}).gameId,
                                    t = (Mr.getTempUser() || {}).uniqueId;
                                bn.post("" + tn.combHost + an, {
                                    gameId: e,
                                    gameTp: "minigame",
                                    uniqueId: t
                                }).then(function (e) {}).catch(function (e) {});
                            }
                        }(), we({
                            eventType: "user_add",
                            data: {
                                sdk_total_login: 1
                            }
                        }), we({
                            eventType: "user_set",
                            data: {
                                sdk_last_time: T()
                            }
                        }), An.loginSuccess = Date.now(), An.platformLoginCost = An.loginSuccess - An.platformLogin,
                        An.loginCost = An.loginSuccess - An.login, Lo || (Lo = !0, we({
                            eventName: "sdk_timing",
                            data: An
                        })), [2, t.combUser];
            }
        });
    });
}

function J(e) {
    var t = D().getUserInfoBtn,
        n = function (e) {
            return wo ? wx.createUserInfoButton(Object.assign({}, {
                lang: "zh_CN"
            }, e)) : null;
        }(e || t);
    return n && n.onTap(function (e) {
        var t = e || {},
            n = t.userInfo,
            r = t.encryptedData,
            i = n || {},
            o = i.nickName,
            s = i.gender;
        o && Zt.dispatch(mr, {
            nickName: o,
            gender: s
        }), r || (Zt.dispatch(vr), fe(10, {
            errMsg: e.errMsg
        }));
    }), n;
}

function Q() {
    return t(this, void 0, void 0, function () {
        return n(this, function (e) {
            switch (e.label) {
                case 0:
                    return e.trys.push([0, 5, , 6]), wo ? [4, new Promise(function (e, t) {
                        L().then(function (t) {
                            e(t.authSetting[yo]);
                        }).catch(function (e) {
                            t(e);
                        });
                    })] : [3, 2];

                case 1:
                case 3:
                    return [2, e.sent()];

                case 2:
                    return [4, new Promise(function (e, t) {
                        wx.authorize({
                            scope: yo,
                            success: function () {
                                e(!0);
                            },
                            fail: t
                        });
                    })];

                case 4:
                    return [3, 6];

                case 5:
                    return i("checkAuth fail", e.sent()), [2, !1];

                case 6:
                    return [2];
            }
        });
    });
}

function X(e, r, o) {
    return t(this, void 0, void 0, function () {
        var t, a, c, u, d, f, h, g, p, m, v, y;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    if (n.trys.push([0, 6, , 7]), 0 == Un._hasInitSuccess) throw lr;
                    return [4, Y(r, o)];

                case 1:
                    return t = n.sent(), a = D(), c = a.gameId, u = a.cryptRule, t && (d = t.userSdk) && d.gameId === c ? (i("storageInfo", t),
                        we({
                            eventName: "sdk_loginsuccess",
                            data: {
                                login_type: "mini_trylogin"
                            }
                        }),
                        function (e, t, n) {
                            var r = D(),
                                i = r.gameId,
                                o = r.gameVersion,
                                a = r.cryptRule,
                                c = Math.floor(new Date().getTime() / 1e3),
                                u = e.combSdkInfo,
                                d = e.combUser,
                                f = e.envCombSdkInfo,
                                h = U(),
                                g = h.custom,
                                p = h.query,
                                m = h.scene,
                                v = h.referrerInfo,
                                y = "",
                                I = "";
                            v && v.extraData && (y = v.extraData.origGameId || "", I = v.extraData.origUniqueId || "");
                            var _ = g || {},
                                S = _.channel,
                                T = _.origChannel,
                                b = _.pageQuery,
                                C = _.shareConfigId,
                                x = _.activityId,
                                k = _.h_shareCode,
                                O = _.boxCode,
                                P = "";
                            try {
                                P = JSON.stringify(h);
                            } catch (e) {
                                s("launchOptions error", e);
                            }
                            var E = "" + tn.combHost + on + "?gameId=" + i + "&gameTp=minigame&system=" + (w() ? "ios" : "android") + "&version=" + o + "&deviceUniqueId=" + Un.deviceId + "&loginTag=code&cryptVersion=1.1.0",
                                A = {
                                    gameId: i,
                                    gameTp: nn,
                                    timestamp: c,
                                    loginInfo: {
                                        combSdkInfo: u,
                                        combUser: d,
                                        envCombSdkInfo: f,
                                        requestBodyInfo: {
                                            gameTp: nn,
                                            origGameId: y,
                                            origUniqueId: I,
                                            version: Ut,
                                            gameId: i,
                                            channel: S,
                                            origChannel: T,
                                            query: b,
                                            queryRaw: JSON.stringify(p),
                                            shareConfigId: C,
                                            activityId: x,
                                            h_shareCode: k,
                                            boxCode: O,
                                            isWeak: t,
                                            forceAuth: n,
                                            sysInfo: l(),
                                            scene: m,
                                            rawData: P
                                        }
                                    }
                                },
                                M = a.codeBook;
                            a.codeBookLen;
                            var N = a.swapTimes,
                                L = a.keySkip,
                                R = a.keyOffset,
                                q = So.encode(No(JSON.stringify(A)), M, N, L, R),
                                H = No(q);
                            bn.postText(E, H).then(function () {}).catch(function () {});
                        }(t, r, o), [2, t]) : (Zt.dispatch(gr, {
                        stage: "开始请求微信登录",
                        storageInfo: t,
                        req: {
                            btnConfig: e,
                            isWeak: r,
                            forceAuth: o
                        }
                    }), [4, ee()]);

                case 2:
                    return f = n.sent(), Zt.dispatch(gr, {
                        stage: "微信登录返回结果",
                        code: f,
                        req: {
                            btnConfig: e,
                            isWeak: r,
                            forceAuth: o
                        }
                    }), h = new Date().getTime(), Zt.dispatch(gr, {
                        stage: "开始请求平台登录",
                        startTime: h,
                        req: {
                            btnConfig: e,
                            isWeak: r,
                            forceAuth: o
                        }
                    }), [4, te(f, r, o, u)];

                case 3:
                    return g = n.sent(), p = new Date().getTime(), m = p - h, v = (g || {}).userSdk,
                        Zt.dispatch(gr, {
                            stage: "平台登录返回结果",
                            platUserInfo: g,
                            costTime: m,
                            req: {
                                btnConfig: e,
                                isWeak: r,
                                forceAuth: o
                            }
                        }), v && v.isAuth ? (we({
                            eventName: "sdk_loginsuccess",
                            data: {
                                login_type: "mini_login",
                                isPost: !1
                            }
                        }), [2, g]) : [4, ne(e)];

                case 4:
                    return [4, re(n.sent(), u)];

                case 5:
                    return [2, n.sent()];

                case 6:
                    throw y = n.sent(), Zt.dispatch(gr, {
                        stage: "登录失败",
                        error: y,
                        req: {
                            btnConfig: e,
                            isWeak: r,
                            forceAuth: o
                        }
                    }), we({
                        eventName: "sdk_loginfail",
                        data: {
                            login_type: "mini_login",
                            login_callback: S({
                                error: y,
                                req: {
                                    btnConfig: e,
                                    isWeak: r,
                                    forceAuth: o
                                }
                            })
                        }
                    }), M(HSDK.MonitorType.LoginFail, {
                        error: y,
                        req: {
                            btnConfig: e,
                            isWeak: r,
                            forceAuth: o
                        }
                    }), yn.pkgError(y, Nt);

                case 7:
                    return [2];
            }
        });
    });
}

function Y(e, r) {
    return t(this, void 0, void 0, function () {
        var t, i;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return r ? [2, null] : (t = Mr.getUserInfo(e)) ? (An.checkSession = Date.now(),
                        [4, Z()]) : [2, null];

                case 1:
                    return i = n.sent(), An.checkSessionComplete = Date.now(), An.checkSessionCost = An.checkSessionComplete - An.checkSession,
                        [2, i ? t : null];
            }
        });
    });
}

function $() {
    return null === Fo && (Fo = setTimeout(function () {
        qo = null, window.clearTimeout(Fo), Fo = null;
    }, 3e3)), null === qo ? new Promise(function (e, t) {
        (Io ? Promise.resolve(Io) : new Promise(function (e, t) {
            wx.checkSession({
                success: function () {
                    Io = !0, e(!0);
                },
                fail: function () {
                    t(!1);
                }
            });
        })).then(function () {
            qo = !0, e(!0);
        }).catch(function (e) {
            Ho = e, qo = !1, t(e);
        });
    }) : !1 === qo ? Promise.reject(Ho) : Promise.resolve(!0);
}

function Z() {
    return t(this, void 0, void 0, function () {
        var e;
        return n(this, function (t) {
            switch (t.label) {
                case 0:
                    return t.trys.push([0, 2, , 3]), [4, $()];

                case 1:
                    return t.sent(), Zt.dispatch(fr, {}), [2, !0];

                case 2:
                    return s("session fail", e = t.sent()), Zt.dispatch(fr, {
                        err: e
                    }), [2, !1];

                case 3:
                    return [2];
            }
        });
    });
}

function ee() {
    return t(this, void 0, void 0, function () {
        var e, t;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return n.trys.push([0, 2, , 3]), An.getCode = Date.now(), [4, new Promise(function (e, t) {
                        wx.login({
                            success: function (n) {
                                var r = (n || {}).code;
                                r ? e(r) : t(Jn);
                            },
                            fail: function (e) {
                                t(e);
                            }
                        });
                    })];

                case 1:
                    return e = n.sent(), An.getCodeSuccess = Date.now(), An.getCodeCost = An.getCodeSuccess - An.getCode,
                        Zt.dispatch(hr, {
                            code: e
                        }), [2, e];

                case 2:
                    throw t = n.sent(), Zt.dispatch(hr, {
                        err: t
                    }), M(HSDK.MonitorType.WxLoginFail, t), yn.pkgError(t, Jn);

                case 3:
                    return [2];
            }
        });
    });
}

/**
 * 平台登录请求
 * @param e 微信登录code
 * @param r 是否弱登录
 * @param o 是否强制授权
 * @param a 加密配置
 * @returns {Promise<LoginResult>} 登录结果
 */
async function te(e, r, o, a) {
    // 解构加密配置
    const {
        codeBook: t,
        swapTimes: c,
        keySkip: u,
        keyOffset: d
    } = a;

    // 获取SDK配置
    const f = D();
    const h = f.gameId;
    const g = f.gameVersion;

    // 获取启动参数
    const p = U();
    const {
        custom: m,
        query: v,
        scene: y,
        referrerInfo: I
    } = p;

    // 处理来源信息
    let _ = '';
    let S = '';
    if (I?.extraData) {
        _ = I.extraData.origGameId || '';
        S = I.extraData.origUniqueId || '';
    }

    // 处理自定义参数
    const T = m || {};
    const b = T.channel;
    const C = T.origChannel;
    const x = T.pageQuery;
    const k = T.shareConfigId;
    const O = T.activityId;
    const P = T.h_shareCode;
    const E = T.boxCode;

    // 序列化启动参数
    let A = '';
    try {
        A = JSON.stringify(p);
    } catch (err) {
        s('launchOptions error', err);
    }

    // 构建请求参数
    const N = {
        gameTp: 'minigame',
        origGameId: _,
        origUniqueId: S,
        version: Ut,
        gameId: h,
        channel: b,
        origChannel: C,
        query: x,
        queryRaw: JSON.stringify(v),
        shareConfigId: k,
        activityId: O,
        h_shareCode: P,
        boxCode: E,
        isWeak: r,
        forceAuth: o,
        code: e,
        sysInfo: l(),
        scene: y,
        rawData: A
    };

    try {
        // 构建请求URL
        const L = `${tn.combHost}${rn}?gameId=${h}&gameTp=minigame&system=${w() ? 'ios' : 'android'}&version=${g}&deviceUniqueId=${Un.deviceId}&loginTag=code&cryptVersion=1.1.0`;

        // 打印日志
        i('login code params', N);

        // 加密请求参数
        const R = So.encode(No(JSON.stringify(N)), t, c, u, d);
        const q = No(R);

        // 记录请求时间
        An.platformLogin = Date.now();

        // 发送请求
        // const H = (await bn.postText(L, q)).data;
        // {"seq":0,"ack":0,"time":1723785305348,"resp":1,"cmd":"login_authuserresp","data":{"roleToken":"fNw3smGu7ndB607RR6WYeAJlsHeaFxWYOfsa/7RfeCRreCWf26dXEQHnFdi2WvcyB/crAQ+uGRUM+5q0shxgt8WDJnJ9zpWKkuCldOodg/8K9u9lBTogJUg/7HjygyGwRRTDw8Fq3Q/9UuaXkOp1B0+F/vbDMMCv16hQNz4xnRs=","roleId":93699499},"rtt":0}
        var H = {
            "meta": {
                "errCode": 0,
                "errMsg": "success"
            },
            "data": {
                "combUser": {
                    "encryptCombUser": "wd1XL1mWJJslCa/BG7fW2KC2XmqErVYvTZ0bYl7uvKv0CO4UJSe9NQX5NZB7/qBsv9kEqBT0D1iSQlv3CLVcBJsc5Tsvud+kgNTXIp/FTdMDnvSMD0J7DRH34WCMQVegwKwvc3WOUnACEN6WBbJWc1u9QJBO3bPo13KjyDhGpzQhWWLmpMxCQBYB13N6dHVfPXZbSVzrXLg3lB8JXqddvvU0Do2yD5hvgVHa4ex4riFnwBt20brYJkI5VlVIG6Qg6b/Jeh5rJSD/HqC4Ytoqj8fh4Lr9Xejf77lPacTLCQ41XWHd2XfxjmJaeAXdfSu40DPq1pWGow99MfsgBHfGpIsu7zwHvp/Exc78j4NEL7Rmk0WhSZUwrSGU76iypYn0E3T31FsHjMT0AckrptG1lnlY1XOTWXGR7g4hUUr7imBijZY9juCepDUS4wG2MI/7X33a7v4neRb7kEVQmP2jyhGDRpxFy7OHVkTI/s4ZdHSMeuEmb7yuC3Nrlm6kf/c2oYURvQcSgiDwFSgaezexYkASXDLv1Jzl2Vl0lKhvDJpakIjPRYhWeapI1zTqQjTfco4LWGClzYdho+iwjOW9zOzHf3vZTDcCTeSRw1Ss9cJKil/7lL0mlOVqw5X0EDUbM89KjB5RGT09yCrW8AAZOuFxDrfBcP4DwARvn7vELT8pZgp+4fawJ/D9dsDcUW2AIwlDOU5fMV6ieUi4v/+UyMODKe6Af0siaFjB7qoQg/ngS4QI0G83ptWwz+bivpFsQW04W6ydDdt8QOFdRatxkW5OK2kqYX/OTXLJjnORpeJhQ66uqnIAQdKhg6N1iHrPFukavOxRhiPctBQexhMBeQ==",
                    "timestamp": 1733130017,
                    "sign": "5e560b8dc81af761f730e91b554abd82"
                },
                "combSdkInfo": {
                    "isAuth": true,
                    "hasUserInfo": true,
                    "userId": "oIRDe5bAIAImQCD700O8Yg88mVtg",
                    "uniqueId": "ef9abe1972578ceb534ab63deb90ddc9",
                    "channel": "hortor",
                    "origChannel": "trafficScheme",
                    "h_shareCode": "0ebfa6089e09ce8e7a955dd46faaa086",
                    "sex": 0,
                    "name": "薛先生",
                    "isNewUser": false,
                    "createdAt": 1655365572,
                    "alias": "xyzwprod_entry"
                },
                "envCombSdkInfo": null
            }
        };
        // 处理用户信息
        H = H.data;
        const F = H.combUser;
        const j = F.encryptCombUser;
        const V = F.timestamp;
        const G = F.sign;

        H.encryptUserInfo = {
            userInfo: j,
            timestamp: V,
            sign: G
        };

        // 处理SDK信息
        H.userSdk = H.combSdkInfo;
        H.userSdk.userId = H.envCombSdkInfo ?
            H.envCombSdkInfo.userId :
            H.combSdkInfo.userId;

        if (H.envCombSdkInfo) {
            H.userSdk.isAuth = H.envCombSdkInfo.isAuth;
        }

        i('entry login', H);

        // 处理未授权情况
        if (H.userSdk.isAuth === false || o) {
            H.encryptUserInfo = null;
            H.combUser = null;
        }

        // 保存用户信息
        se(H);
        Mr.setTempUser(H);

        return H;

    } catch (W) {
        s('entry err', W);
        Mr.clearUserInfo();
        M(HSDK.MonitorType.PlatformLoginFail, W);
        throw yn.pkgError(W, Lt);
    }
}

function ne(e) {
    return t(this, void 0, void 0, function () {
        var t;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return t = null, wo ? [4, ie(e)] : [3, 2];

                case 1:
                    return t = n.sent(), [3, 4];

                case 2:
                    return [4, de()];

                case 3:
                    t = n.sent(), n.label = 4;

                case 4:
                    return i("fetch userinfo", t), [2, t];
            }
        });
    });
}

function re(e, r) {
    return t(this, void 0, void 0, function () {
        var t, o, a, c, u, d, l, f, h, g, p, m, v, y, I, _, S, T, b, C, x, k, O;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    t = r.codeBook, r.codeBookLen, o = r.swapTimes, a = r.keySkip, c = r.keyOffset,
                        u = D(), d = u.gameId, l = u.gameVersion, h = (f = e || {}).encryptedData, g = f.iv,
                        p = Mr.getTempUser() || {}, m = p.userId, v = p.uniqueId, i("update params", y = {
                            entryAlias: "minisdk",
                            gameId: d,
                            userId: m,
                            uniqueId: v,
                            encryptedData: h,
                            iv: g
                        }), n.label = 1;

                case 1:
                    return n.trys.push([1, 3, , 4]), I = "" + tn.combHost + rn + "?gameId=" + d + "&gameTp=minigame&system=" + (w() ? "ios" : "android") + "&version=" + l + "&deviceUniqueId=" + Un.deviceId + "&loginTag=update&cryptVersion=1.1.0",
                        _ = So.encode(No(JSON.stringify(y)), t, o, a, c), S = No(_), [4, bn.postText(I, S)];

                case 2:
                    if (!(T = n.sent().data) || !T.combUser) throw Lt;
                    return b = T.combUser, C = b.encryptCombUser, x = b.timestamp, k = b.sign, T.encryptUserInfo = {
                        userInfo: C,
                        timestamp: x,
                        sign: k
                    }, T.userSdk = T.combSdkInfo, se(T), we({
                        eventName: "sdk_loginsuccess",
                        data: {
                            login_type: "mini_login",
                            isPost: !0
                        }
                    }), [2, T];

                case 3:
                    throw O = n.sent(), M(HSDK.MonitorType.PlatformUpdateFail, O), s("_postUserInfo err", O),
                        yn.pkgError(O, Lt);

                case 4:
                    return [2];
            }
        });
    });
}

function ie(e) {
    return t(this, void 0, void 0, function () {
        var t, r, i, o, s, a;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return [4, Q()];

                case 1:
                    return n.sent() ? [4, oe()] : [3, 3];

                case 2:
                    return r = n.sent(), [3, 4];

                case 3:
                    r = null, n.label = 4;

                case 4:
                    if (t = r) return [2, t];
                    if (Zt.dispatch(pr), i = D().getUserInfoBtn, s = (o = e || {}).useGameBtn, a = o.config,
                        s || !a && !i) throw Zn;
                    return [4, ae(e)];

                case 5:
                    return [2, n.sent()];
            }
        });
    });
}

function oe() {
    return t(this, void 0, void 0, function () {
        return n(this, function (e) {
            switch (e.label) {
                case 0:
                    return e.trys.push([0, 2, , 3]), [4, B()];

                case 1:
                    return [2, e.sent()];

                case 2:
                    return e.sent(), [2, null];

                case 3:
                    return [2];
            }
        });
    });
}

function se(e) {
    var t = e || {},
        n = t.encryptUserInfo,
        r = t.userSdk,
        i = t.combSdkInfo.uniqueId,
        o = D().gameId;
    n && (function () {
        if (!Mr.getUserInfo(!0)) {
            var e = U() || {},
                t = e.custom || {},
                n = t.shareConfigId,
                r = t.activityId;
            fe(1, {
                content: yn.copy(e, ["custom"]),
                shareConfigId: n,
                activityId: r
            });
        }
    }(), r && (r.masterUniqueId = i, r.gameId = o), Mr.setUserInfo(e));
}

function ae(e) {
    var t = e || {},
        n = t.config,
        r = t.onTap,
        i = t.onShow,
        o = t.stayOnDeny;
    return new Promise(function (e, t) {
        var s = ce(n);
        if (!s) throw ir;
        s.onTap(function (n) {
            var i = (n || {}).encryptedData;
            i ? e(n) : o || t($n), r && r(n), !i && o || ue();
        }), s.show(), i && i();
    });
}

function ce(e) {
    return ue(), Po = J(e);
}

function ue() {
    Po && (Po.hide(), Po.destroy(), Po = null);
}

function de() {
    return t(this, void 0, void 0, function () {
        var e;
        return n(this, function (t) {
            switch (t.label) {
                case 0:
                    return [4, Q()];

                case 1:
                    return (e = t.sent()) ? [3, 3] : [4, le()];

                case 2:
                    e = t.sent(), t.label = 3;

                case 3:
                    if (!e) throw $n;
                    return [4, B()];

                case 4:
                    return [2, t.sent()];
            }
        });
    });
}

function le() {
    return t(this, void 0, void 0, function () {
        return n(this, function (e) {
            switch (e.label) {
                case 0:
                    return e.trys.push([0, 4, , 5]), [4, new Promise(function (e, t) {
                        wx.openSetting({
                            success: function (t) {
                                e(t.authSetting[yo]);
                            },
                            fail: t
                        });
                    })];

                case 1:
                    return e.sent() ? [2, !0] : [4, _o({
                        title: "提示",
                        content: "需要开启访问用户信息权限",
                        showCancel: !0,
                        cancelText: "知道了",
                        confirmText: "去设置"
                    })];

                case 2:
                    return e.sent().confirm ? [4, le()] : [2, !1];

                case 3:
                    return [2, e.sent()];

                case 4:
                    return i("low auth fail", e.sent()), [2, !1];

                case 5:
                    return [2];
            }
        });
    });
}

function fe(e, t) {
    var n = Mr.getTempUser() || {},
        r = n.userId,
        i = n.uniqueId,
        o = U(),
        a = "";
    try {
        a = JSON.stringify(o);
    } catch (e) {
        s("_postLog err", e);
    }
    var c = Bn.getStorage("__sdk_postLog_rawData_logType_" + e + "__");
    c && c === a ? a = "" : Bn.setStorage("__sdk_postLog_rawData_logType_" + e + "__", a);
    var u = o.custom,
        d = o.scene,
        l = u || {},
        f = o.coldStart ? 0 : 1,
        h = {
            logType: e,
            channel: l.channel,
            origChannel: l.origChannel,
            shareConfigId: l.shareConfigId,
            scene: d,
            userId: r,
            uniqueId: i,
            time: new Date().getTime()
        };
    3 !== e && 45 !== e || (h.open_type = f), a && (h.rawData = a);
    var g = t ? Object.assign(h, t) : h;
    Zt.dispatch(Kt, {
        log: g
    });
}

function he(e) {
    var t;
    e = A(e, "registerOnLogin"), t = e.listener, Zt.on(Vt, function (e) {
        t && t(null == e ? void 0 : e.data);
    });
}

function ge(e, t, n) {
    return this.guid = yn.generateGuid(), this.opt = e, this.topic = e.topic, this.fromPlatform = !!n,
        this._init(t), this;
}

function pe() {
    Zt.on(Bt, function (e) {
        ! function (e, t) {
            var n = po[e];
            n && ve(Object.assign({}, n, t || {}), t);
        }(mo.SET_USER_INFO, e.data);
    });
    var e = D(),
        t = e.autoUploadSDTLog,
        n = e.stdAutoUpload,
        r = e.tgaAutoUpload,
        i = e.stdHeartBeatInterval;
    if (!1 !== r || n || t) {
        if (me(po.INIT, {
                eventType: "track",
                eventName: "sdk_init"
            }, !0), Zt.on(qt, function () {
                me(po.OPEN, null, !0);
            }), Zt.on(Ht, function () {
                me(po.CLOSE, null, !0);
            }), Zt.on(wr, function (e) {
                me(po.SHARE, e.data, !0);
            }), Zt.on(Ir, function (e) {
                me(po.SHARE_END, e.data, !0);
            }), Zt.on(_r, function (e) {
                me(po.SHARE, e.data, !0);
            }), Zt.on(Sr, function (e) {
                me(po.SHARE_END, e.data, !0);
            }), Zt.on(br, function (e) {
                me(po.VIDEO_AD_SHOW, e.data, !0);
            }), Zt.on(Cr, function (e) {
                me(po.VIDEO_AD_END, e.data, !0);
            }), Zt.on(kr, function (e) {
                me(po.VIDEO_AD_END, e.data, !0);
            }), Zt.on(mr, function (e) {
                me(po.AUTH, e.data, !0);
            }), Zt.once(Vt, function (e) {
                me(po.LOGIN, e.data, !0), new Promise(function (e, t) {
                    u("getUserGameLabel", "2.9.3") ? wx.getUserGameLabel({
                        success: e,
                        fail: t
                    }) : t(ir);
                }).then(function (e) {
                    me(po.PROFILE, e, !0);
                }).catch(function (e) {});
            }), i) {
            var o = i - 0 || 60,
                s = {
                    interval: o
                };
            isNaN(o) || yn.resetInterval(function () {
                me(po.BEAT, s, !0);
            }, 1e3 * o);
        }
        Zt.on(Tr, function (e) {
            me(po.SHARE_FRIEND, {
                extend: e.data
            }, !0);
        });
    }
}

function me(e, t, n) {
    var r = uo,
        i = lo,
        o = D(),
        s = o.autoUploadSDTLog,
        a = o.stdAutoUpload,
        c = o.tgaAutoUpload,
        u = e.logType;
    a || s || (u = (u | i) === u ? u ^ i : u), !1 === c && (u = (u | r) === u ? u ^ r : u),
        u && (e.logType = u, ve(e, t, n));
}

function ve(e, t, n) {
    var r = new ge(e, t, n),
        i = r.getConfig(),
        o = i.stopWhenShare,
        s = i.callAfterLogin;
    Bo.getState(Pr) && o || (s ? function (e) {
        if (yn.isFun(e)) {
            var t = Mr.getSDKUserInfo() || {},
                n = t.uniqueId;
            t.userId && n ? e() : (zo.push(e), Zt.once(Vt, function (e) {
                zo.forEach(function (t) {
                    return t(e);
                }), zo = [];
            }));
        }
    }(function () {
        Wo.collect(r.refreshData().toLogData());
    }) : Wo.collect(r.toLogData()));
}

function ye(e) {
    return void 0 === (null == e ? void 0 : e.logType) && (e.logType = 2), void 0 === (null == e ? void 0 : e.eventType) && (e.eventType = "track"),
        e && e.customData && (e.extend = e.customData), e.extend ? e.extend.sdk_trackplatform = "game_c" : e.extend = {
            sdk_trackplatform: "game_c"
        }, ve(e, e, !1);
}

function we(e) {
    var t = e.eventName,
        n = void 0 === t ? "" : t,
        r = e.data,
        i = void 0 === r ? {} : r,
        o = e.eventType,
        s = void 0 === o ? "track" : o;
    i.sdk_trackplatform = "sdk_c";
    var a = {
        eventName: n,
        extend: i,
        logType: 2,
        eventType: s
    };
    return ve(a, a, !1);
}

function Ie(e) {
    var t = e.state,
        n = e.type,
        r = void 0 === n ? "" : n,
        i = e.errMsg,
        o = void 0 === i ? "" : i,
        s = e.id;
    we({
        eventName: "sdk_ad",
        data: {
            ad_state: t,
            ad_placeid: (void 0 === s ? "" : s) || "",
            sdk_ad_type: r,
            ad_callback: o
        }
    });
}

function _e(e) {
    if (Ie({
            state: "call",
            errMsg: S({
                id: null == e ? void 0 : e.id
            })
        }), null == e ? void 0 : e.id) {
        var t = e.id,
            n = Qo[t];
        n ? j().then(function (t) {
            var r = t[null == e ? void 0 : e.id];
            if (void 0 === r) H(null == e ? void 0 : e.onShowFail, {
                errMsg: Xo
            });
            else if ("loaded" === n.status) {
                var i = null == r ? void 0 : r.miniGameWxAdId;
                "reward_video" === (null == r ? void 0 : r.adShowTp) ? function (e) {
                    (null == e ? void 0 : e.id) && (e.adUnitId = e.id), "boolean" == typeof (null == e ? void 0 : e.isMulti) && (e.multiton = e.isMulti),
                    ki.show(Et(Et({}, e), {
                        onClose: function (t) {
                            Ie({
                                state: "close",
                                type: "RewardedVideo",
                                errMsg: S(t),
                                id: e.id
                            }), H(null == e ? void 0 : e.onClose, t), (null == t ? void 0 : t.isEnded) ? (H(null == e ? void 0 : e.onFinishClose, t),
                                we({
                                    eventType: "user_add",
                                    data: {
                                        sdk_total_ad: 1
                                    }
                                })) : H(null == e ? void 0 : e.onQuitClose, t);
                        }
                    })).then(function (t) {
                        H(null == e ? void 0 : e.onPlaySuccess, t), Ie({
                            state: "success",
                            type: "RewardedVideo",
                            id: e.id
                        });
                    }).catch(function (t) {
                        H(null == e ? void 0 : e.onPlayFail, t), K({
                            msg: "showVideoAd err",
                            data: {
                                option: e,
                                err: t
                            }
                        }), Ie({
                            state: "fail",
                            type: "RewardedVideo",
                            errMsg: S(t),
                            id: e.id
                        });
                    });
                }(Object.assign({}, e, {
                    id: i
                })) : "interstitial" === (null == r ? void 0 : r.adShowTp) ? function (e) {
                    (null == e ? void 0 : e.id) && (e.adUnitId = e.id, Ii.show(Et(Et({}, e), {
                        onClose: function (t) {
                            H(null == e ? void 0 : e.onClose, t);
                        }
                    })).then(function (t) {
                        H(null == e ? void 0 : e.onShowSuccess, t), Ie({
                            state: "success",
                            type: "Interstitial",
                            id: e.id
                        });
                    }).catch(function (t) {
                        H(null == e ? void 0 : e.onShowFail, t), K({
                            msg: "showInterstitialAd err",
                            data: {
                                option: e,
                                err: t
                            }
                        }), Ie({
                            state: "fail",
                            type: "Interstitial",
                            errMsg: S(t),
                            id: e.id
                        });
                    }));
                }(Object.assign({}, e, {
                    id: i
                })) : "wxmg_template" === (null == r ? void 0 : r.adShowTp) ? function (e) {
                    (null == e ? void 0 : e.id) && $o[e.id].show().then(function (t) {
                        H(e.onShowSuccess, t), Ie({
                            state: "success",
                            type: "CustomAd",
                            id: e.id
                        });
                    }).catch(function (t) {
                        H(e.onShowFail, t), K({
                            msg: "showCustomAd err",
                            data: {
                                option: e,
                                err: t
                            }
                        }), Ie({
                            state: "fail",
                            type: "CustomAd",
                            errMsg: S(t),
                            id: e.id
                        });
                    });
                }(Object.assign({}, e, {
                    id: i
                })) : "banner" === (null == r ? void 0 : r.adShowTp) && function (e) {
                    if ((null == e ? void 0 : e.id) && Yo[e.id]) {
                        var t = Yo[e.id];
                        t.show().then(function (t) {
                            H(null == e ? void 0 : e.onShowSuccess, t), Ie({
                                state: "success",
                                type: "Banner",
                                id: e.id
                            });
                        }).catch(function (t) {
                            H(null == e ? void 0 : e.onShowFail, t), K({
                                msg: "showBannerAd err",
                                data: {
                                    option: e,
                                    err: t
                                }
                            }), Ie({
                                state: "fail",
                                type: "Banner",
                                errMsg: S(t),
                                id: e.id
                            });
                        }), e.style && (t.style = Object.assign(t.style, e.style));
                    }
                }(Object.assign({}, e, {
                    id: i
                }));
            } else "loading" === n.status && (n.isImmediateShow = !0, n.showOption = e);
        }).catch(function (t) {
            H(null == e ? void 0 : e.onShowFail, t);
        }) : H(null == e ? void 0 : e.onShowFail, {
            errMsg: "makesure preload before show"
        });
    } else H(null == e ? void 0 : e.onShowFail, {
        errMsg: "广告id不能为空"
    });
}

function Se(e) {
    return ts.openCustomer(e);
}

function Te(e, r) {
    return t(this, void 0, void 0, function () {
        return n(this, function (t) {
            switch (t.label) {
                case 0:
                    return cc && cc.ENGINE_VERSION ? "2" != cc.ENGINE_VERSION[0] ? [3, 2] : [4, Ce(e, r)] : [3, 4];

                case 1:
                case 3:
                    return [2, t.sent()];

                case 2:
                    return "3" != cc.ENGINE_VERSION[0] ? [3, 4] : [4, be(e, r)];

                case 4:
                    return [2, Yn];
            }
        });
    });
}

function be(e, r) {
    return t(this, void 0, void 0, function () {
        var t, i, o, s, a, c, u, d;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    t = r || cc.director.getScene(), i = Oe("modalNode", {
                        isHorizontal: !0,
                        isVertical: !0
                    }), t.addChild(i), Jo = i, o = cc.winSize.width, s = cc.winSize.height, n.label = 1;

                case 1:
                    return n.trys.push([1, 3, , 4]), a = ss(i), is(a, new cc.Size(o, s)), i.on(cc.Node.EventType.TOUCH_END, function () {
                            ke(i);
                        }), i.addComponent(cc.Canvas), (c = i.addComponent("cc.Graphics")).rect(-a.width / 2, -a.height / 2, a.width, a.height),
                        c.fillColor = new cc.Color().fromHEX("#000000cc"), c.fill(), u = Oe("panelNode", {
                            isVertical: !0,
                            isHorizontal: !0
                        }), i.addChild(u), u.addComponent("cc.BlockInputEvents"), d = Oe("lb", {
                            isHorizontal: !0,
                            isVertical: !0
                        }), u.addChild(d), d.addComponent("cc.Label").string = "加载中...", [4, xe({
                            node: u,
                            url: e,
                            x: 0,
                            y: 0,
                            width: 750,
                            height: 1001,
                            type: 3
                        })];

                case 2:
                    return n.sent(), [2, {
                        errCode: 0,
                        errMsg: "生成二维码成功"
                    }];

                case 3:
                    return n.sent(), ke(i), [2, Xn];

                case 4:
                    return [2];
            }
        });
    });
}

function Ce(e, r) {
    return t(this, void 0, void 0, function () {
        var t, i, o, s, a, c, u;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    t = r || cc.director.getScene(), i = new cc.Node("modalNode"), Jo = i, n.label = 1;

                case 1:
                    return n.trys.push([1, 3, , 4]), t.addChild(i), i.width = cc.winSize.width, i.height = cc.winSize.height,
                        (o = i.addComponent(cc.Widget)).isAlignHorizontalCenter = !0, o.isAlignVerticalCenter = !0,
                        i.zIndex = cc.macro.MAX_ZINDEX, i.on(cc.Node.EventType.TOUCH_END, function () {
                            cc.tween(a).to(.35, {
                                scale: 0,
                                opacity: 0
                            }, {
                                easing: cc.easing.backIn
                            }).call(function () {
                                ke(i);
                            }).start();
                        }), (s = i.addComponent(cc.Graphics)).rect(-i.width / 2, -i.height / 2, i.width, i.height),
                        s.fillColor = new cc.Color().fromHEX("#000000cc"), s.fill(), i.addComponent("cc.BlockInputEvents"),
                        a = new cc.Node("panelNode"), i.addChild(a), c = a.addComponent(cc.Widget), a.addComponent(cc.BlockInputEvents),
                        c.verticalCenter = 0, c.horizontalCenter = 0, u = new cc.Node(), a.addChild(u),
                        u.addComponent(cc.Label).string = "加载中...", [4, xe({
                            node: a,
                            url: e,
                            x: 0,
                            y: 0,
                            width: 750,
                            height: 1001,
                            type: 2
                        })];

                case 2:
                    return n.sent(), cc.tween(a).set({
                        scale: 0,
                        opacity: 0
                    }).to(.4, {
                        scale: 1,
                        opacity: 255
                    }, {
                        easing: cc.easing.backOut
                    }).start(), [2, {
                        errCode: 0,
                        errMsg: "生成二维码成功"
                    }];

                case 3:
                    return n.sent(), ke(i), [2, Xn];

                case 4:
                    return [2];
            }
        });
    });
}

function xe(e) {
    var t = e.node,
        n = e.url,
        r = e.x,
        i = e.y,
        o = e.width,
        s = e.height,
        a = e.type;
    return new Promise(function (e, c) {
        var u, d;
        2 == a && (u = new cc.Node(), d = u.addComponent(cc.Sprite), u.x = r, u.y = i, cc.loader.load({
            url: n,
            type: "image"
        }, function (n, r) {
            n ? (console.error("加载图片失败: " + n), c()) : (d.spriteFrame = new cc.SpriteFrame(r),
                u.width = o, u.height = s, t.setContentSize(o, s), e());
        })), 3 == a && (u = Oe("img", {
            isHorizontal: !0,
            isVertical: !0
        }), d = u.addComponent(cc.Sprite), cc.loader.load({
            url: n,
            type: "image"
        }, function (t, n) {
            if (t) console.error("加载图片失败: " + t), c();
            else {
                var r = new cc.SpriteFrame(),
                    i = new cc.Texture2D();
                i.image = n, r.texture = i, d.spriteFrame = r, e();
            }
        })), u.off(cc.Node.EventType.TOUCH_END), t.addChild(u);
    });
}

function ke(e) {
    e && "function" == typeof e.destroy && (e.destroyAllChildren(), e.destroy(), e = null);
}

function Oe(e, t) {
    void 0 === t && (t = {});
    var n = new cc.Node(e);
    return rs(n), t && os(n, t), n;
}

function Pe(e) {
    var t = e.url,
        n = e.resolve,
        r = e.reject,
        i = e.parent || cc.director.getScene();
    (as = new cc.Node("modalNode")).width = cc.winSize.width, as.height = cc.winSize.height;
    var o = as.addComponent(cc.Widget);
    o.isAlignHorizontalCenter = !0, o.isAlignVerticalCenter = !0, as.zIndex = cc.macro.MAX_ZINDEX;
    var s = as.addComponent(cc.Graphics);
    s.rect(-as.width / 2, -as.height / 2, as.width, as.height), s.fillColor = new cc.Color().fromHEX("#000000cc"),
        s.fill(), i.insertChild(as, i.childrenCount), as.addComponent("cc.BlockInputEvents");
    var a = new cc.Node("pannelNode");
    as.insertChild(a, as.childrenCount), a.width = 640, a.height = 880;
    var c = a.addComponent(cc.Widget);
    c.verticalCenter = 0, c.horizontalCenter = 0;
    var u = new cc.Node("pannelGraphicsNode");
    u.width = a.width, u.height = a.height, u.on(cc.Node.EventType.TOUCH_END, function (e) {
        e.stopPropagation();
    }), a.insertChild(u, a.childrenCount);
    var d = u.addComponent(cc.Graphics);
    d.roundRect(0 - a.width / 2, -400, a.width, a.height, 5), d.fillColor = new cc.Color().fromHEX("#FFFFFF"),
        d.fill(), as.on(cc.Node.EventType.TOUCH_END, function () {
            Ae();
        }), Ee({
            node: a,
            url: t,
            x: 0,
            y: 70,
            width: 380,
            height: 380
        }).then(function (e) {
            e.on(cc.Node.EventType.TOUCH_END, function (e) {
                e.stopPropagation();
            }), n();
        }).catch(function (e) {
            r({
                errMsg: "展示二维码失败, 请重试"
            });
        });
    var l = new cc.Node("subTitleTextNode"),
        f = l.addComponent(cc.Label);
    f.string = "请使用微信扫一扫完成支付", f.fontSize = 32, f.fontFamily = "Impact", a.addChild(l),
        l.y = -250, l.color = new cc.Color().fromHEX("#000000cc"), Ee({
            node: function (e) {
                var t = e.node,
                    n = e.x,
                    r = e.y,
                    i = e.width,
                    o = e.height,
                    s = e.callBack,
                    a = new cc.Node();
                return a.x = n, a.y = r, a.width = i, a.height = o, a.anchorX = 0, a.anchorY = 0,
                    a.on(cc.Node.EventType.TOUCH_END, function () {
                        s();
                    }), t.addChild(a, t.childrenCount), a;
            }({
                node: a,
                x: a.width / 2 - 75 - 10,
                y: a.width / 2 + 75,
                width: 100,
                height: 100,
                callBack: function () {
                    Ae();
                }
            }),
            url: "https://wxmini-resource.hortorgames.com/background-image/close-1692082564.png",
            x: 50,
            y: 50,
            width: 28,
            height: 28
        }).then(function (e) {}).catch(function (e) {});
}

function Ee(e) {
    var t = e.node,
        n = e.url,
        r = e.x,
        i = e.y,
        o = e.width,
        s = e.height;
    return new Promise(function (e, a) {
        var c = new cc.Node();
        c.x = r, c.y = i;
        var u = c.addComponent(cc.Sprite);
        cc.loader.load({
            url: n,
            type: "image"
        }, function (t, n) {
            t && a(t), e(c), u.spriteFrame = new cc.SpriteFrame(n), c.setContentSize(o, s);
        }), c.off(cc.Node.EventType.TOUCH_END), t.addChild(c, t.childrenCount);
    });
}

function Ae() {
    return as && "function" == typeof as.destroy && (as.destroy(), as = null), Promise.resolve();
}

function Ue(e) {
    var t = e.state,
        n = e.type,
        r = void 0 === n ? "" : n,
        i = e.errMsg;
    we({
        eventName: "sdk_c_pay",
        data: {
            pay_state: t,
            order_id: ls,
            pay_amount: fs,
            pay_type: r,
            pay_callback: void 0 === i ? "" : i
        }
    });
}

function De(e) {
    var r, i, o, s, a, c, u, l;
    return t(this, void 0, void 0, function () {
        var t, f, h, g, p, m;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return t = D().gameId, f = tn.combHost + "/comb-pay-server/api/v1/order/pay/mini",
                        h = (Mr.getSDKUserInfo() || {}).uniqueId, g = (null === (o = null === (i = null === (r = null == In ? void 0 : d()) || void 0 === r ? void 0 : r.system) || void 0 === i ? void 0 : i.toLowerCase()) || void 0 === o ? void 0 : o.startsWith("ios")) || (null === (c = null === (a = null === (s = null == In ? void 0 : d()) || void 0 === s ? void 0 : s.system) || void 0 === a ? void 0 : a.toLowerCase()) || void 0 === c ? void 0 : c.startsWith("mac")),
                        p = g ? "ios" : "android", m = {
                            gameId: t,
                            gameTp: "minigame",
                            uniqueId: h,
                            orderId: null == e ? void 0 : e.orderId,
                            system: p,
                            systemString: (null === (u = null == In ? void 0 : d()) || void 0 === u ? void 0 : u.system) || "",
                            platformString: (null === (l = null == In ? void 0 : d()) || void 0 === l ? void 0 : l.platform) || ""
                        }, [4, bn.post(f, m)];

                case 1:
                    return [2, n.sent()];
            }
        });
    });
}

function Me(e) {
    Ue({
        state: "orderfail",
        errMsg: S(e)
    });
}

function Ne(e, r) {
    return fs = e.money, r.showJumpCustomerTip && (e.showJumpCustomerTip = r.showJumpCustomerTip),
        function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s, a, c, u, d, l, f, h;
                return n(this, function (n) {
                    return t = e.orderId, r = e.img, i = e.title, o = e.money, s = e.host, a = e.previewImg,
                        c = e.showJumpCustomerTip, u = e.alertContent, d = e.alertTitle, l = e.jumpButton,
                        f = e.cancelButton, h = e.hideOpenCustomerServiceParam, [2, new Promise(function (e, n) {
                            var g = function (e, n, c) {
                                    var u = !1;
                                    if (null != c && (u = c.isCancel), u) {
                                        var d = "tip cancel";
                                        Be({
                                            state: "sdkfail",
                                            errMsg: d
                                        }), Be({
                                            state: "dialogue1cancel"
                                        }), n({
                                            errMsg: d
                                        });
                                    } else {
                                        Be({
                                            state: "dialogue1confirm"
                                        });
                                        var l = "index?min_h5_orderInfo=" + JSON.stringify({
                                                host: encodeURIComponent(s),
                                                money: o,
                                                orderId: t,
                                                previewImg: a
                                            }),
                                            f = h ? {} : {
                                                sessionFrom: l,
                                                showMessageCard: !0,
                                                sendMessageTitle: i,
                                                sendMessageImg: r,
                                                sendMessagePath: l
                                            };
                                        es.openCustomerServiceConversation(f).then(function (t) {
                                            Be({
                                                state: "sdksuccess"
                                            }), Be({
                                                state: "dialogue2confirm"
                                            }), e({
                                                msg: "跳转客服会话成功"
                                            });
                                        }).catch(function (e) {
                                            M(HSDK.MonitorType.PayFail, {
                                                err: e,
                                                orderId: ls
                                            }), M(HSDK.MonitorType.CustomerPayFail, {
                                                err: e,
                                                orderId: ls
                                            }), Be({
                                                state: "dialogue2cancel"
                                            }), Be({
                                                state: "sdkfail",
                                                errMsg: "open " + S(e)
                                            }), n(e);
                                        });
                                    }
                                },
                                p = {
                                    title: d,
                                    content: u,
                                    confirmText: l,
                                    cancelText: f,
                                    showCancel: !!f
                                };
                            "function" == typeof c ? c(function (t) {
                                return g(e, n, t);
                            }, p) : wx.showModal(Et(Et({}, p), {
                                success: function (t) {
                                    if (t.confirm) g(e, n, null);
                                    else if (t.cancel) {
                                        var r = "modal cancel";
                                        Be({
                                            state: "sdkfail",
                                            errMsg: r
                                        }), n({
                                            errMsg: r
                                        });
                                    }
                                },
                                fail: function (e) {
                                    Be({
                                        state: "sdkfail",
                                        errMsg: "modal " + S(e)
                                    }), n(e);
                                }
                            }));
                        })];
                });
            });
        }(e);
}

function Le(e, t) {
    return new Promise(function (n, r) {
        (null == e ? void 0 : e.previewImg) ? Pe({
            url: tn.combHost + "/comb-pay-server/api/v1/tools/qr_gen?u=" + encodeURIComponent(e.previewImg),
            resolve: n,
            reject: r,
            parent: t.parent
        }): r();
    });
}

function Re(e, r) {
    var i = this;
    return new Promise(function (o, s) {
        return t(i, void 0, void 0, function () {
            var t, i, a;
            return n(this, function (n) {
                return (t = null === (a = null == e ? void 0 : e.miniH5QrPayInfo) || void 0 === a ? void 0 : a.previewImg) ? (i = tn.combHost + "/comb-pay-server/api/v1/tools/qr?u=" + encodeURIComponent(t),
                    o(Te(i, r))) : s(e), [2];
            });
        });
    });
}

function qe(e, r) {
    var i = this;
    return new Promise(function (o, s) {
        return t(i, void 0, void 0, function () {
            var t, i, a, c;
            return n(this, function (n) {
                return t = D().combGameId, (i = null === (c = null == e ? void 0 : e.miniH5IOSQrWxPayInfo) || void 0 === c ? void 0 : c.previewImg) ? (a = tn.combHost + "/comb-pay-server/api/v1/tools/qr/minigame_ios?gameId=" + t + "&platType=" + e.platType + "&u=" + encodeURIComponent(i),
                    o(Te(a, r))) : s(e), [2];
            });
        });
    });
}

function He(e, t, n) {
    Zt.dispatch(Kt, {
        log: {
            orderId: t,
            logType: e,
            errMsg: n
        }
    });
}

function Fe(e, r) {
    return t(this, void 0, void 0, function () {
        var t, o, s;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    if (!e) throw tr;
                    He(13, e, "[SDK] call midashi: " + e), n.label = 1;

                case 1:
                    return n.trys.push([1, 4, , 5]), i("payInfo", r), [4, ns(r)];

                case 2:
                    return n.sent(), Ue({
                            state: "paysuccess",
                            type: "mdsPay"
                        }), He(8, e, "[SDK] midashi success: " + e), t = tn.combHost + "/comb-pay-server/api/v1/order/pay/mini/mds/callback",
                        [4, bn.post(t, {
                            orderId: e
                        })];

                case 3:
                    if ("success" !== (o = n.sent().data)) throw Ue({
                        state: "payfail",
                        errMsg: S(o),
                        type: "mdsPay"
                    }), M(HSDK.MonitorType.PayFail, {
                        err: o,
                        orderId: ls
                    }), M(HSDK.MonitorType.MdsPlatformCallbackFail, {
                        err: o,
                        orderId: ls
                    }), Xn;
                    return He(9, e, "[SDK] MinigameCallback Success: " + e), [3, 5];

                case 4:
                    throw Ue({
                        state: "payfail",
                        errMsg: S(s = n.sent()),
                        type: "mdsPay"
                    }), He(7, e, JSON.stringify(s)), Zt.dispatch(yr, {
                        payType: 0,
                        err: s
                    }), i("midasPay fail", s), M(HSDK.MonitorType.PayFail, {
                        err: s,
                        orderId: ls
                    }), M(HSDK.MonitorType.MdsPayFail, {
                        err: s,
                        orderId: ls
                    }), s;

                case 5:
                    return [2];
            }
        });
    });
}

function je(e) {
    return t(this, void 0, void 0, function () {
        var t, r, i;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    if (t = e.orderId, r = e.jumpType, !t || "number" != typeof r) throw tr;
                    n.label = 1;

                case 1:
                    return n.trys.push([1, 8, , 9]), r !== cs ? [3, 3] : [4, Ve(e)];

                case 2:
                    return [2, n.sent()];

                case 3:
                    return r !== ds ? [3, 5] : [4, We(e)];

                case 4:
                    return [2, n.sent()];

                case 5:
                    return r !== us ? [3, 7] : [4, Ge(e)];

                case 6:
                    return [2, n.sent()];

                case 7:
                    return [3, 9];

                case 8:
                    throw i = n.sent(), Zt.dispatch(yr, {
                        payType: r,
                        err: i
                    }), He(7, t, JSON.stringify(i)), i;

                case 9:
                    return [2];
            }
        });
    });
}

function Ve(e) {
    return t(this, void 0, void 0, function () {
        var t, r, o, s, a, c, u, d, l, f;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    r = (t = e || {}).orderId, o = t.appId, s = t.path, a = t.extraData, c = t.envVersion,
                        u = void 0 === c ? "release" : c, d = encodeURIComponent("o=" + r), l = s || "/pages/index/index?scene=" + d,
                        n.label = 1;

                case 1:
                    return n.trys.push([1, 3, , 7]), [4, Zo.navigateToMiniProgram({
                        appId: o,
                        path: l,
                        extraData: a,
                        envVersion: u
                    })];

                case 2:
                    return [2, n.sent()];

                case 3:
                    if (f = n.sent(), M(HSDK.MonitorType.PayFail, {
                            err: f,
                            orderId: ls
                        }), M(HSDK.MonitorType.JumpPayFail, {
                            err: f,
                            orderId: ls
                        }), Ue({
                            state: "payfail",
                            errMsg: S(f),
                            type: "shellJump"
                        }), !f || !f.isCancel) return [3, 4];
                    throw Qn;

                case 4:
                    return i("jumpAppPay fail", f), [4, Ge(e)];

                case 5:
                    return [2, n.sent()];

                case 6:
                    return [3, 7];

                case 7:
                    return [2];
            }
        });
    });
}

function Ge(e) {
    return t(this, void 0, void 0, function () {
        var t, r;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return t = e.orderId, r = tn.combHost + "/comb-pay-server/api/v1/order/pay/mini/shell/qrcode?orderId=" + t,
                        [4, Zo.previewImage(r)];

                case 1:
                    return [2, n.sent()];
            }
        });
    });
}

function We(e) {
    return t(this, void 0, void 0, function () {
        var t, r, i, o;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    if (t = e.path, r = e.title, i = e.imgUrl, o = {
                            showMessageCard: !0,
                            sendMessageTitle: r,
                            sendMessageImg: i,
                            sendMessagePath: t
                        }, !r || !i || !t) throw tr;
                    return [4, es.openCustomerServiceConversation(o)];

                case 1:
                    return [2, n.sent()];
            }
        });
    });
}

function Ke(e) {
    return new Promise(function (t, n) {
        wx.showModal({
            title: e.title || "支付提示",
            content: e.content || "1.点击复制付款链接后，打开微信\n2.将链接粘贴并发送给自己或文件传输助手\n3.点击链接完成支付后回到游戏自动发放道具",
            cancelText: e.cancelButton || "关闭",
            confirmText: e.confirmButton || "复制链接",
            success: function (r) {
                if (!r.confirm) return n(Qn);
                wx.setClipboardData({
                    data: e.link,
                    success: function () {
                        return t({
                            errCode: 0,
                            errMsg: "支付方式生成成功"
                        });
                    },
                    fail: function (e) {
                        return n(e.errMsg);
                    }
                });
            }
        });
    });
}

function Be(e) {
    var t = e.state,
        n = e.errMsg;
    we({
        eventName: "sdk_h5_pay",
        data: {
            pay_state: t,
            orderId: ls,
            pay_amount: fs,
            pay_callback: void 0 === n ? "" : n
        }
    });
}

function ze(e) {
    void 0 === e && (e = {}), this.lastIndex = -1, this.allZero = !1, this.allWeight = 0,
        this.unitWeight = 100, this.opt = e, this._init();
}

function Je(e) {
    wx.showShareMenu(e);
}

function Qe(e) {
    return new Promise(function (t, n) {
        gs ? void 0 === e.isUpdatableMessage || ps ? wx.updateShareMenu(Object.assign({}, e || {}, {
            success: t,
            fail: n
        })) : n(nr) : n(ir);
    });
}

function Xe() {
    return this.forceResult = void 0, this.destroyed = !1, this.inited = !1, this;
}

function Ye(e) {
    i("share process aggr req");
    var t = (e || {}).resp,
        n = (t || {}).share;
    return n && $e(n), t || null;
}

function $e(e) {
    var t;
    if (0 === (null === (t = null == e ? void 0 : e.meta) || void 0 === t ? void 0 : t.errCode) && (null == e ? void 0 : e.data)) {
        var n = [];
        Object.keys(e.data).forEach(function (t) {
            e.data[t].forEach(function (e) {
                var r = e.shareDescription,
                    i = e.id,
                    o = e.shareImgUrl,
                    s = e.previewId,
                    a = e.previewUrl,
                    c = e.shareSceneType,
                    u = e.shareSuccessDiff,
                    d = e.thumbnailId,
                    l = e.thumbnailUrl,
                    f = e.shareTitle,
                    h = e.msgTp;
                n.push({
                    type: t,
                    category: "",
                    desc: r,
                    gameID: ys.gameId,
                    id: i,
                    imageUrl: o,
                    position: 0,
                    previewId: s,
                    previewUrl: a,
                    shareScene: c,
                    shareSuccessDiff: u,
                    thumbnailId: d,
                    thumbnailUrl: l,
                    title: f,
                    weight: 0,
                    msgTp: h
                });
            });
        }), ws = hs.renderShareThemes(n.map(function (e) {
            return 2 === e.shareScene && (e.imageUrl = e.thumbnailUrl, e.imageUrlId = e.thumbnailId,
                e.imagePreviewUrl = e.previewUrl, e.imagePreviewUrlId = e.previewId), e;
        }));
    }
}

function Ze(e, t) {
    e ? Zt.dispatch(_r, {
        wx_share_type: 1
    }) : Zt.dispatch(wr, {
        wx_share_type: 0
    });
}

function et(e, t, n, r, i) {
    Bo.setState(Pr, !1);
    var o = r ? Math.max(yn.getTime() - r, 0) : 0,
        s = Et(Et({
            shareData: t,
            shareSuccess: n,
            spentTime: o
        }, e), {
            wx_share_type: i ? 1 : 0
        });
    return i ? Zt.dispatch(Sr, s) : Zt.dispatch(Ir, s), s;
}

function tt(e) {
    var t = (ys || {}).shareData,
        n = (e || {}).shareType,
        r = n ? ws[n] : null,
        i = r ? r.getData() : t || {};
    return hs.renderShare(e, i);
}

function nt(e, t, n, r) {
    _s = r;
    var o, s = yn.getTime();
    if ("" !== e.shareType) o = tt(e), Is = "";
    else {
        var a = tt(e);
        o = Object.assign(a, {
            shareConfigId: (null == a ? void 0 : a.shareConfigId) || ""
        });
    }
    i("_handleShare inData", o);
    var c = ys || {},
        u = c.shareSuccessDiff,
        d = c.onShareCallbackTime,
        l = o || {},
        f = l.shareSuccessDiff,
        h = l.onShareCallbackTime,
        g = l.activityId,
        p = Object.assign({}, o, {
            shareSuccessDiff: f || u,
            onShareCallbackTime: h || d
        }),
        m = t || {},
        v = m.success,
        y = m.fail,
        w = m.complete,
        I = hs.renderPostParams(p),
        _ = new Xe(),
        S = {
            complete: function (e) {
                _.destroy(), w && yn.isFun(w) && w(e), g && ms.clear().catch(function (e) {
                    i("update fail", e);
                });
            },
            success: function (e) {
                i("share success", e);
                var t = et(e, p, !0, s);
                r || (rt(I, 2), rt(I, 12)), yn.isFun(v) && v(t);
            },
            fail: function (e) {
                i("share fail", e);
                var t = et(e, p, !1, s);
                yn.isFun(y) && y(t);
            }
        },
        T = Et(Et({}, p), S);
    return _.init(T), rt(I, r ? 2 : 11), Ze(!1), T;
}

function rt(e, t) {
    Zt.dispatch(Kt, {
        log: Et(Et({}, e), {
            logType: t,
            customScene: _s ? "hsdk_menue" : Is
        })
    });
}

function it(e, t) {
    return new Promise(function (t, n) {
        var r, i = nt(e, {
            success: t,
            fail: n
        }, 0, !1);
        if ("poster" === i.msgTp) {
            if (wx.showShareImageMenu) {
                var o = function (e, t) {
                    i.style = "v2", i.needShowEntrance = !0, i.path = e, i.entrancePath = "?" + t, wx.showShareImageMenu(i);
                };
                i.imageUrl.includes("://tmp") ? o(i.imageUrl, i.query) : wx.downloadFile({
                    url: i.imageUrl,
                    success: function (e) {
                        o(e.tempFilePath, i.query);
                    },
                    fail: function (e) {
                        i.fail();
                    },
                    complete: function () {
                        i.complete();
                    }
                });
            }
        } else {
            r = i, wx.shareAppMessage(r);
            var s = i.shareSuccessDiff || ys.shareSuccessDiff;
            "number" == typeof s ? setTimeout(function () {
                i.success({});
            }, s) : i.success({});
        }
    });
}

function ot(e) {
    ! function (e) {
        wx.onShareAppMessage(e);
    }(function (t) {
        var n = e && yn.isFun(e) ? e(t) : null,
            r = n || {};
        return nt(n, {
            success: r.success,
            fail: r.fail,
            complete: r.complete
        }, 0, !0);
    });
}

function st(e) {
    ! function (e) {
        wx.onShareTimeline && wx.onShareTimeline(e);
    }(function (t) {
        var n = e && yn.isFun(e) ? e(t) : null,
            r = n || {};
        return function (e, t, n, r) {
            _s = !0;
            var o, s = yn.getTime();
            if ("" !== e.shareType) o = tt(e), Is = "";
            else {
                var a = tt(e);
                o = Object.assign(a, {
                    shareConfigId: (null == a ? void 0 : a.shareConfigId) || ""
                });
            }
            var c = ys || {},
                u = c.shareSuccessDiff,
                d = c.onShareCallbackTime,
                l = o || {},
                f = l.shareSuccessDiff,
                h = l.onShareCallbackTime,
                g = l.activityId,
                p = Object.assign({}, o, {
                    shareSuccessDiff: f || u,
                    onShareCallbackTime: h || d
                }),
                m = t || {},
                v = m.success,
                y = m.fail,
                w = m.complete,
                I = hs.renderPostParams(p),
                _ = new Xe(),
                S = {
                    complete: function (e) {
                        i("share complete", e), _.destroy(), w && yn.isFun(w) && w(e), g && ms.clear().catch(function (e) {
                            i("update fail", e);
                        });
                    },
                    success: function (e) {
                        i("share success", e);
                        var t = et(e, p, !0, s, !0);
                        yn.isFun(v) && v(t);
                    },
                    fail: function (e) {
                        i("share fail", e);
                        var t = et(e, p, !1, s, !0);
                        yn.isFun(y) && y(t);
                    }
                },
                T = Et(Et({}, p), S);
            return _.init(T), rt(I, 44), Ze(!0), T;
        }(n, {
            success: r.success,
            fail: r.fail,
            complete: r.complete
        });
    });
}

function at() {
    if (I()) return i("devtool is not support private share");
    if (D().usePrivateShare) {
        var e = D().gameId,
            r = Mr.getSDKUserInfo() || {},
            o = r.uniqueId,
            s = r.userId;
        bn.post(tn.combHost + "/comb-login-server/api/v1/user/activityId", {
            gameId: e,
            uniqueId: o,
            openId: s
        }).then(function (e) {
            var r = e.data,
                i = r.activityId,
                o = r.activityKey;
            Ss = o,
                function (e) {
                    t(this, void 0, void 0, function () {
                        return n(this, function (t) {
                            switch (t.label) {
                                case 0:
                                    return [4, Qe({
                                        withShareTicket: !0,
                                        isPrivateMessage: !0,
                                        activityId: e
                                    })];

                                case 1:
                                    return [2, t.sent()];
                            }
                        });
                    });
                }(i);
        });
    }
}

function ct() {
    return t(this, void 0, void 0, function () {
        return n(this, function (e) {
            return [2, new Promise(function (e, t) {
                var n, r = U(),
                    i = r.shareTicket,
                    o = r.query;
                n = {
                    shareTicket: i,
                    success: function (t) {
                        return e(Et(Et({}, t), {
                            activityKey: o.activityKey
                        }));
                    },
                    fail: t
                }, wx.authPrivateMessage(n);
            })];
        });
    });
}

function ut(e) {
    var t = e.state,
        n = e.type,
        r = void 0 === n ? "chat" : n,
        i = e.errMsg;
    we({
        eventName: "sdk_c_share",
        data: {
            share_state: t,
            share_type: r,
            share_callback: void 0 === i ? "" : i
        }
    });
}

function dt(e) {
    return new Promise(function (t, n) {
        Ts ? wx.requestSubscribeMessage(Object.assign({}, e, {
            success: t,
            fail: n
        })) : n(ir);
    });
}

function lt(e) {
    return new Promise(function (t, n) {
        u("requestSubscribeSystemMessage", "2.32.1") ? wx.getSetting({
            withSubscriptions: !0,
            success: function (e) {
                var n, r;
                t("accept" === (null === (r = null === (n = null == e ? void 0 : e.subscriptionsSetting) || void 0 === n ? void 0 : n.itemSettings) || void 0 === r ? void 0 : r.SYS_MSG_TYPE_WHATS_NEW) ? {
                    hasSubscribed: !0
                } : {
                    hasSubscribed: !1
                });
            },
            fail: n
        }) : (bs || n(ir), wx.getWhatsNewSubscriptionsSetting(Object.assign({}, e, {
            success: function (e) {
                2 === (null == e ? void 0 : e.status) ? t({
                    hasSubscribed: !0
                }) : 1 === (null == e ? void 0 : e.status) ? t({
                    hasSubscribed: !1
                }) : n(e);
            },
            fail: n
        })));
    });
}

function ft(e) {
    return new Promise(function (t, n) {
        u("requestSubscribeSystemMessage", "2.32.1") ? wx.requestSubscribeSystemMessage({
            msgTypeList: ["SYS_MSG_TYPE_WHATS_NEW"],
            success: function (e) {
                t("accept" === (null == e ? void 0 : e.SYS_MSG_TYPE_WHATS_NEW) ? {
                    isAgree: !0
                } : {
                    isAgree: !1
                });
            },
            fail: function (e) {
                n(e);
            }
        }) : (bs || n(ir), wx.requestSubscribeWhatsNew(Object.assign({}, e, {
            success: function (e) {
                t((null == e ? void 0 : e.confirm) ? {
                    isAgree: !0
                } : {
                    isAgree: !1
                });
            },
            fail: n
        })));
    });
}

function ht(e) {
    return t(this, void 0, void 0, function () {
        var t, r, o, s, a;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    r = (t = e || {}).playerId, t.tmplIds, n.label = 1;

                case 1:
                    return n.trys.push([1, 3, , 4]), [4, dt(e)];

                case 2:
                    return o = n.sent(), s = function (e, t) {
                        var n = {
                            playerId: t
                        };
                        for (var r in Cs) n[Cs[r]] = [];
                        for (var r in e) {
                            var i = Cs[e[r]];
                            n[i] && n[i].push(r);
                        }
                        return n;
                    }(o, r), gt(s, 0), [2, s];

                case 3:
                    return i("订阅消息 err", a = n.sent()), [2, Promise.reject(a)];

                case 4:
                    return [2];
            }
        });
    });
}

function gt(e, t) {
    if (void 0 === t && (t = 0), !(t > 3)) {
        var n = D().gameId,
            r = e || {},
            o = r.acceptIds,
            s = void 0 === o ? [] : o,
            a = r.playerId;
        if (s.length) {
            var c = Mr.getSDKUserInfo() || {},
                u = c.userId,
                d = c.uniqueId,
                l = {
                    gameId: n,
                    playerId: yn.toNStr(a),
                    openId: u,
                    uniqueId: d,
                    templateIds: s
                },
                f = tn.subscribeHost + "/subscribe-server/api/v1/msg";
            bn.post(f, l).then(function () {
                i("subscribe count add", l);
            }).catch(function () {
                setTimeout(function () {
                    gt(e, ++t);
                }, 5e3);
            });
        }
    }
}

function pt() {
    Bn.removeStorage(qs);
}

function mt(e) {
    return function (e) {
        return Vs ? wx.getLogManager(e) : null;
    }(e);
}

function vt(e) {
    return function (e) {
        return js ? wx.createFeedbackButton(e) : null;
    }(e);
}

function yt(e, t, n) {
    Fs || (Fs = mt()), Fs && Fs[e]("SDK " + t, n || "");
}

function wt(e) {
    return u(e.apiName, e.version) ? Promise.resolve() : Promise.reject({
        errMsg: ir
    });
}

function It(e) {
    return new Promise(function (t, n) {
        var r = (Mr.getSDKUserInfo() || {}).uniqueId,
            i = tn.gsHost + "/community-server/api/v1/game/account/background/config?gameId=" + Un.option.combGameId + "&level=" + (e || 1) + "&uniqueId=" + r;
        bn.get(i).then(function (e) {
            var r;
            console.log("getGsSetting", e), 0 === (null === (r = null == e ? void 0 : e.meta) || void 0 === r ? void 0 : r.errCode) && (null == e ? void 0 : e.data) || n(e);
            var i = {
                status: e.data.status,
                iconUrl: e.data.iconUrl,
                iconX: e.data.iconX,
                iconY: e.data.iconY
            };
            Ks = e.data.programAppId, t(i);
        }).catch(function (e) {
            n(e);
        });
    });
}

function _t(e, t, n) {
    wx.authorize({
        scope: Bs,
        success: function () {
            St(e, t, n);
        },
        fail: function (e) {
            n({
                errMsg: JSON.stringify(e)
            });
        }
    });
}

function St(e, t, n) {
    wx.saveImageToPhotosAlbum({
        filePath: e,
        success: function (e) {
            t();
        },
        fail: function (e) {
            n({
                errMsg: JSON.stringify(e)
            });
        }
    });
}

function Tt(e) {
    return t(this, void 0, void 0, function () {
        return n(this, function (t) {
            return [2, new Promise(function (t, n) {
                wx.getGameClubData({
                    dataTypeList: e,
                    success: t,
                    fail: n
                });
            })];
        });
    });
}

function bt(e, r, i) {
    var o, s;
    return t(this, void 0, void 0, function () {
        var t, a, c, u;
        return n(this, function (n) {
            switch (n.label) {
                case 0:
                    return t = Un.sdkConfig().gameId, a = (null === (o = Mr.combUserInfo.envCombSdkInfo) || void 0 === o ? void 0 : o.uniqueId) || Mr.combUserInfo.combSdkInfo.uniqueId,
                        c = {
                            gameId: t,
                            uniqueId: a,
                            gameTp: "minigame",
                            wxGameCircle: {
                                encryptedData: e,
                                iv: r,
                                signature: i
                            }
                        }, [4, bn.post(tn.combHost + "/comb-platform-server/api/v1/game_circle/decode_user", c)];

                case 1:
                    if (u = n.sent(), 0 !== (null === (s = null == u ? void 0 : u.meta) || void 0 === s ? void 0 : s.errCode)) throw new Error(u.meta.errMsg);
                    return [2, u.data.wxData];
            }
        });
    });
}

function Ct(e) {
    return new Promise(function (t, n) {
        var r = D().gameId;
        bn.get(decodeURIComponent(tn.combHost + "/common/api/v1/private_policy?gameId=" + r + "&type=" + e + "&lng=zh")).then(function (e) {
            e && e.data && e.data.content ? t(e.data.content) : n(e);
        }).catch(function (e) {
            n(e);
        });
    });
}

function xt(e) {
    we({
        eventName: "privacyAuth",
        data: {
            sdk_msg: e
        }
    });
}

function kt(e) {
    var t = (Mr.getSDKUserInfo() || {}).uniqueId,
        n = D().gameId,
        r = U().query;
    bn.post(tn.combHost + "/brand_wall-server/api/v1/brand_game/log", {
        gameId: n,
        uniqueId: t,
        gameTp: zs,
        logTp: e,
        queryRaw: JSON.stringify(r),
        sysInfo: l()
    }).then(function (e) {}).catch(function (e) {});
}

Object.defineProperty(exports, "__esModule", {
    value: !0
});

var Ot = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) {
    return typeof e;
} : function (e) {
    return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e;
};

(window || global).regeneratorRuntime = void 0;

var Pt = function (e, t) {
        return (Pt = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                e.__proto__ = t;
            } || function (e, t) {
                for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]);
            })(e, t);
    },
    Et = function () {
        return (Et = Object.assign || function (e) {
            for (var t, n = 1, r = arguments.length; n < r; n++)
                for (var i in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]);
            return e;
        }).apply(this, arguments);
    },
    At = function (e) {
        return "[HSDK] " + e;
    },
    Ut = "1.9.0",
    Dt = "weixin",
    Mt = "object" == Ot(window.tt) && "object" == Ot(window.wx) && window.tt === window.wx ? (s("当前为头条环境, 但是使用的是微信sdk, 请使用头条sdk"),
        "tt") : "object" == Ot(window.wx) ? "wx" : "debug",
    Nt = {
        errCode: 500,
        errMsg: "未知错误"
    },
    Lt = {
        errCode: 1e3,
        errMsg: "网络错误"
    },
    Rt = "EVT_SDK_READY",
    qt = "EVT_ON_SHOW",
    Ht = "EVT_ON_HIDE",
    Ft = "EVT_ON_ERROR",
    jt = "EVT_LOGIN_START",
    Vt = "EVT_ON_LOGIN",
    Gt = "EVT_UPDATE_START",
    Wt = "EVT_ON_UPDATE",
    Kt = "EVT_REPORT_LOG",
    Bt = "EVT_SET_GAMEUSER",
    zt = "Test",
    Jt = "Prod",
    Qt = "Dev",
    Xt = "PROC_PRE_AGGR",
    Yt = "PROC_REQ_AGGR",
    $t = {},
    Zt = {
        _on: function (e, t, n, r) {
            if (void 0 === n && (n = 0), void 0 === r && (r = !1), t) {
                var i = $t[e] || [];
                i.push({
                    priority: n,
                    listener: t,
                    once: r
                }), $t[e] = i.sort(function (e, t) {
                    return e.priority < t.priority ? 1 : e.priority > t.priority ? -1 : 0;
                });
            }
        },
        once: function (e, t, n) {
            void 0 === n && (n = 0), this._on(e, t, n, !0);
        },
        on: function (e, t, n) {
            void 0 === n && (n = 0), this._on(e, t, n, !1);
        },
        off: function (e, t) {
            var n = $t[e];
            n && (n = n.filter(function (e) {
                return e.listener !== t;
            }), $t[e] = n);
        },
        dispatch: function (e, t) {
            this._dispatch(e, t);
        },
        _dispatch: function (e, t) {
            var n = $t[e];
            if (n && !(n.length <= 0))
                for (var r = new a(t), i = 0; i < n.length; i++) {
                    var o = n[i];
                    try {
                        o.listener(r);
                    } catch (t) {
                        s("EventBus invoke '" + e + "' exception: ", t);
                    }
                    if (o.once && this.off(e, o.listener), r.isStopped()) break;
                }
        }
    },
    en = {
        Dev: "-dev",
        Test: "-test",
        Prod: ""
    },
    tn = {
        get combHost() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://comb-platform" + en[e] + ".hortorgames.com";
        },
        get logHost() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://platform-stat" + en[e] + ".hortorgames.com";
        },
        get combKMS() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://kms-server" + en[e] + ".hortorgames.com";
        },
        get sAPI() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://comb-sapi" + en[e] + ".hortorgames.com";
        },
        get subscribeHost() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://subscribe" + en[e] + ".hortorgames.com";
        },
        get gsHost() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://community-server" + en[e] + ".hortorgames.com";
        },
        get combAPI() {
            var e = Un.sdkConfig() && Un.sdkConfig().env || "Prod";
            return "https://comb-active" + en[e] + ".hortorgames.com/comb-active-server/api/v1/";
        }
    },
    nn = "minigame",
    rn = "/comb-login-server/api/v1/login",
    on = "/comb-login-server/api/v1/login/check",
    sn = "/comb-share/server/v1/scheme",
    an = "/comb-pay-server/api/v1/order/pay/mini/action/login",
    cn = {
        isFun: function (e) {
            return "function" == typeof e;
        },
        isNull: function (e) {
            return null == e;
        },
        toNStr: function (e, t) {
            return void 0 === t && (t = ""), "string" == typeof e ? e : this.toStr(e, t);
        },
        toStr: function (e, t) {
            if (void 0 === t && (t = ""), this.isNull(e)) return t;
            try {
                return JSON.stringify(e);
            } catch (e) {
                return t;
            }
        },
        toNumber: function (e, t) {
            void 0 === t && (t = 0);
            try {
                return Number(e) || t;
            } catch (e) {
                return t;
            }
        },
        toBoolean: function (e, t) {
            void 0 === t && (t = !1);
            try {
                return !!JSON.parse(e);
            } catch (n) {
                return !!e || t;
            }
        },
        toObject: function (e, t) {
            void 0 === t && (t = void 0);
            try {
                return JSON.parse(e);
            } catch (e) {
                return t;
            }
        },
        isEmpty: function (e) {
            return this.isNull(e) || "" === e;
        },
        wait: function (e) {
            return new Promise(function (t) {
                setTimeout(t, e);
            });
        },
        toLine: function (e) {
            return e.replace(/([A-Z])/g, "_$1").toLowerCase();
        },
        startsWith: function (e, t) {
            return e.slice(0, t.length) === t;
        },
        endsWith: function (e, t) {
            return -1 !== e.indexOf(t, e.length - t.length);
        },
        generateGuid: function () {
            for (var e = [], t = "0123456789abcdef", n = 0; n < 36; ++n) e[n] = t.substr(Math.floor(16 * Math.random()), 1);
            return e[14] = "4", e[19] = t.substr(3 & e[19] | 8, 1), e[8] = e[13] = e[18] = e[23] = "-",
                e.join("");
        }
    };

c.prototype = {
    setTimer: function (e) {
        this.timer = e;
    },
    getTimer: function () {
        return this.timer;
    }
};

var un, dn, ln, fn, hn, gn, pn = {
        getTime: function () {
            return Date.now();
        },
        getTimeSec: function () {
            return Math.floor(this.getTime() / 1e3);
        },
        todayStart: function (e) {
            var t = e ? new Date(e) : new Date();
            return new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime();
        },
        toMSecond: function (e) {
            return 3600 * e * 1e3;
        },
        resetInterval: function (e, t) {
            var n = new c();
            return n.setTimer(setTimeout(function r() {
                e && !1 !== e() && n.setTimer(setTimeout(r, t));
            }, t)), n;
        },
        reclearInterval: function (e) {
            var t = e && e.getTimer ? e.getTimer() : null;
            t && (clearTimeout(t), e.setTimer(null));
        }
    },
    mn = {
        geVersion: function (e, t) {
            return this._compareVersion(e, t) >= 0;
        },
        ltVersion: function (e, t) {
            return this._compareVersion(e, t) < 0;
        },
        _compareVersion: function (e, t) {
            for (var n = e.split("."), r = t.split("."), i = Math.max(n.length, r.length), o = 0; o < i; o++) {
                var s = parseInt(n[o], 10) || 0,
                    a = parseInt(r[o], 10) || 0;
                if (s > a) return 1;
                if (s < a) return -1;
            }
            return 0;
        }
    },
    vn = {
        reset: function (e, t) {
            var n = Object.assign({}, e);
            return Object.keys(t || {}).forEach(function (r) {
                cn.isNull(e[r]) && !cn.isNull(t[r]) && (n[r] = t[r]);
            }), n;
        },
        copy: function (e, t) {
            if (void 0 === t && (t = []), cn.isNull(e)) return {};
            var n = {};
            return Object.keys(e).forEach(function (r) {
                t && t.indexOf(r) > -1 || cn.isNull(e[r]) || (n[r] = e[r]);
            }), n;
        },
        deepCopyTo: function (e, t, n, r, i) {
            var o = this;
            return void 0 === n && (n = 0), void 0 === r && (r = []), void 0 === i && (i = 0),
                null === e || "object" != (void 0 === e ? "undefined" : Ot(e)) || !t || 0 !== n && i >= n ? e : (Object.keys(e).forEach(function (s) {
                    r && r.indexOf(s) > -1 || (t[s] = o.deepCopyTo(e[s], t[s], n, r, ++i));
                }), t);
        },
        queryToJson: function (e) {
            if (cn.isEmpty(e)) return {};
            try {
                var t = {};
                return decodeURIComponent(e).split("&").forEach(function (e) {
                    if (e && e.split) {
                        var n = e.split("=");
                        t[n[0]] = n[1];
                    }
                }), t;
            } catch (e) {
                return {};
            }
        },
        jsonToQuery: function (e, t) {
            if (cn.isNull(e)) return "";
            try {
                var n = [];
                return Object.keys(e).forEach(function (r) {
                    if (!cn.isNull(e[r])) {
                        var i = t ? encodeURIComponent(e[r]) : e[r];
                        n.push(r + "=" + i);
                    }
                }), n.join("&");
            } catch (e) {
                return "";
            }
        },
        addToQuery: function (e, t) {
            var n = this.queryToJson(e),
                r = this.reset(n, t);
            return this.jsonToQuery(r);
        },
        defineProperty: function (e, t, n) {
            if (e) {
                var r = "function" == typeof e[t] ? e[t].bind(e) : e[t];
                Object.defineProperty(e, t, {
                    value: n(r)
                });
            }
        }
    },
    yn = Et(Et(Et(Et(Et({}, cn), pn), mn), {
        pkgError: function (e, t) {
            return {
                errCode: e && e.errCode || t.errCode,
                errMsg: e && (e.errMsg || e.message) || t.errMsg
            };
        }
    }), vn),
    wn = null === (ln = null === (dn = null === (un = d()) || void 0 === un ? void 0 : un.system) || void 0 === dn ? void 0 : dn.toLowerCase()) || void 0 === ln ? void 0 : ln.startsWith("ios"),
    In = Object.freeze({
        __proto__: null,
        canUse: u,
        getSystemInfo: d,
        isAppleOS: wn,
        getSystemStr: l,
        getNetStatus: f,
        getNetworkType: h,
        onNetworkStatusChange: g,
        _onNetChange: p,
        _handleOffNetChange: m,
        getNotchInfo: v,
        checkPlatform: y,
        isAndroid: function () {
            return y("android");
        },
        isIOS: w,
        isPC: I
    }),
    _n = window || global || {};

_n.$__sdk__ || (_n.$__sdk__ = {});

var Sn, Tn = {
        platform: _n.$__sdk__.platform
    },
    bn = {
        request: function (e, r, i, o, a, c) {
            return void 0 === c && (c = !0), t(this, void 0, void 0, function () {
                var t, u, d, l, f, h, g;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            t = null, n.label = 1;

                        case 1:
                            return n.trys.push([1, 3, , 4]), u = Object.assign({}, a, {
                                "content-type": c ? "application/json" : "application/x-www-form-urlencoded"
                            }), d = this._jointQuery(r, i || {}), [4, Tn.platform.network.request(e, d, o, u)];

                        case 2:
                            return l = n.sent(), f = l.data, h = void 0 === f ? {} : f, this._checkRespValid(l) ? [2, {
                                meta: h.meta,
                                data: h.data
                            }] : (t = h.meta, [3, 4]);

                        case 3:
                            return s("request get failed", g = n.sent()), t = g, [3, 4];

                        case 4:
                            return [4, this._onFailed(t)];

                        case 5:
                            return [2, n.sent()];
                    }
                });
            });
        },
        get: function (e, t) {
            return void 0 === t && (t = null), this.request("GET", e, t);
        },
        post: function (e, t, n) {
            return void 0 === n && (n = null), this.request("POST", e, n, t, {}, !0);
        },
        postText: function (e, r, i) {
            return t(this, void 0, void 0, function () {
                var t, o, a, c, u, d, l;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            t = null, n.label = 1;

                        case 1:
                            return n.trys.push([1, 3, , 4]), o = {
                                "content-type": "text/plain"
                            }, a = this._jointQuery(e, i || {}), [4, Tn.platform.network.request("POST", a, r, o)];

                        case 2:
                            return c = n.sent(), u = c.data, d = void 0 === u ? {} : u, this._checkRespValid(c) ? [2, {
                                meta: d.meta,
                                data: d.data
                            }] : (t = d.meta, [3, 4]);

                        case 3:
                            return s("request get failed", l = n.sent()), t = l, [3, 4];

                        case 4:
                            return [4, this._onFailed(t)];

                        case 5:
                            return [2, n.sent()];
                    }
                });
            });
        },
        postForm: function (e, t, n) {
            return void 0 === n && (n = null), this.request("POST", e, n, t, {}, !1);
        },
        _onFailed: function (e) {
            var t = e && e.errCode ? e : Lt;
            return i("--- net error ---", e, t), Promise.reject(t);
        },
        _checkRespValid: function (e) {
            return 200 === e.statusCode && e.data && (!e.data.meta || 0 === e.data.meta.errCode);
        },
        _jointQuery: function (e, t) {
            return Object.keys(t).forEach(function (n, r) {
                var i = 0 === r && e.indexOf("?") < 0 ? "?" : "&";
                e += "" + i + n + "=" + t[n];
            }), e;
        }
    },
    Cn = {
        getString: function (e, t) {
            return void 0 === t && (t = ""), this._get(e, function (e) {
                return yn.toStr(e, t);
            });
        },
        getNumber: function (e, t) {
            return void 0 === t && (t = 0), this._get(e, function (e) {
                return yn.toNumber(e, t);
            });
        },
        getBoolean: function (e, t) {
            return void 0 === t && (t = !1), this._get(e, function (e) {
                return yn.toBoolean(e, t);
            });
        },
        get: function (e, t) {
            return void 0 === t && (t = void 0), this._get(e, function (e) {
                return yn.toObject(e, t);
            });
        },
        set: function (e, t) {
            return this._set(e, t);
        },
        remove: function (e) {
            return Tn.platform.storage.removeStorage(e);
        },
        clear: function () {
            return Tn.platform.storage.clearStorage();
        },
        _get: function (e, t) {
            return t(Tn.platform.storage.getStorage(e));
        },
        _set: function (e, t) {
            var n = yn.toStr(t);
            return Tn.platform.storage.setStorage(e, n);
        }
    },
    xn = {},
    kn = !1;

kn || (kn = !0, Zt.on(qt, function (e) {
    P(e.data);
}));

var On, Pn, En, An = {
        run: Date.now()
    },
    Un = {
        _hasInitSuccess: !1,
        _canTry: !0,
        config: {},
        init: function (e) {
            var t = this;
            return An.init = Date.now(), An.runCost = An.init - An.run, this._checkValid(e) ? (this.config = Object.assign({}, e),
                this._print(e), this._canTry ? (this._canTry = !1, setTimeout(function () {
                    t._canTry = !0;
                }, 3e3), _(this._comb2Sub.bind(this), 3)) : Promise.reject({
                    errMsg: "wait to init"
                })) : Promise.reject();
        },
        get storagePrefix() {
            return (this.config.combGameId || this.config.gameId) + "_" + this.config.env + "_hsdk_";
        },
        get deviceId() {
            var e = this.storagePrefix + "deviceId";
            if (Cn.get(e)) return Cn.get(e);
            var t = Math.random().toString(36).slice(-8);
            return Cn.set(e, t), t;
        },
        _comb2Sub: function () {
            var e = this,
                t = this.sdkConfig(),
                n = t.gameId,
                r = t.gameVersion,
                i = tn.combHost + "/comb-login-server/api/v1/login/crypt/mix?combGameId=" + n + "&gameTp=minigame&system=" + (w() ? "ios" : "android") + "&version=" + r + "&deviceUniqueId=" + this.deviceId;
            return new Promise(function (t, n) {
                bn.get(i).then(function (r) {
                    var i;
                    if (0 === (null === (i = null == r ? void 0 : r.meta) || void 0 === i ? void 0 : i.errCode) && (null == r ? void 0 : r.data)) {
                        var o = r.data,
                            s = o.subGameId,
                            a = o.cryptRule;
                        e.config.combGameId = e.config.gameId, e.config.gameId = s, e.config.cryptRule = a,
                            Zt.dispatch(Rt, e.config), e._hasInitSuccess = !0, An.initSuccess = Date.now(),
                            An.initCost = An.initSuccess - An.init, t(!0);
                    } else n(r);
                }).catch(function (e) {
                    M(HSDK.MonitorType.InitFail, e), n(e);
                });
            });
        },
        sdkConfig: function () {
            return this.config || {};
        },
        get option() {
            return this.config;
        },
        _checkValid: function (e) {
            return this._hasInitSuccess ? (s("already initiated"), !1) : !!this._checkConfigValid(e) || (function (e) {
                for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
                Un.sdkConfig().isHideLog || console.error.apply(console, r([At(e)], t));
            }("initiate failed, please check config!"), !1);
        },
        _checkConfigValid: function (e) {
            return e.env && e.gameId && e.gameVersion;
        },
        _print: function (e) {
            o("/*************************/"), o(" SDK Version: " + Ut), o(" SDK Release Time: 9/27/2024, 3:50:03 PM"),
                o(" Platform: wx"), o(" Api Type: new_promise_mix"), o(" Env: " + e.env), o(" Game ID: " + e.gameId),
                o(" Game Version: " + e.gameVersion), o(" Private Share: " + e.usePrivateShare),
                o("/*************************/");
        }
    },
    Dn = {
        weixin: {
            host: {
                prod: "wxmini",
                test: "wxmini-test",
                dev: "wxmini-dev"
            },
            server: {
                prod: "platform",
                test: "platform-test",
                dev: "platform-dev"
            },
            log: {
                prod: "wxmini-log",
                test: "wxmini-test",
                dev: "wxmini-dev"
            }
        },
        toutiao: {
            host: {
                prod: "platform-douyin",
                test: "platform-douyin-test",
                dev: "platform-douyin-dev"
            },
            server: {
                prod: "platform",
                test: "platform-test",
                dev: "platform-dev"
            },
            log: {
                prod: "platform",
                test: "platform-test",
                dev: "platform-dev"
            }
        }
    } [Dt],
    Mn = {
        HOST: (On = {}, On[Jt] = N(Dn.host.prod), On[zt] = N(Dn.host.test), On[Qt] = N(Dn.host.dev),
            On),
        HOST_SERVER: (Pn = {}, Pn[Jt] = N(Dn.server.prod), Pn[zt] = N(Dn.server.test), Pn[Qt] = N(Dn.server.dev),
            Pn),
        HOST_LOG: (En = {}, En[Jt] = N(Dn.log.prod), En[zt] = N(Dn.log.test), En[Qt] = N(Dn.log.dev),
            En)
    },
    Nn = function () {
        var e = Un.sdkConfig() && Un.sdkConfig().env || Jt,
            t = Mn.HOST_SERVER;
        return (void 0 === t ? {} : t)[e];
    },
    Ln = function () {
        var e = Un.sdkConfig() && Un.sdkConfig().env || Jt,
            t = Mn.HOST_LOG;
        return (void 0 === t ? {} : t)[e];
    },
    Rn = {
        weixin: "/mini/api/v1/log/multi",
        toutiao: "/wxlog/api/v1/log/douyin/multi"
    } [Dt],
    qn = Kt,
    Hn = Zt,
    Fn = Tn,
    jn = i,
    Vn = bn,
    Gn = {
        _logs: [],
        _delayer: void 0,
        post: function (e, t) {
            void 0 === t && (t = !1), e && (this._logs.push(e), t ? this._report() : this._delayReport());
        },
        _init: function () {
            Hn.on(qn, this._onReport.bind(this));
        },
        _onReport: function (e) {
            var t = e.data || {},
                n = t.log,
                r = t.immediate;
            this.post(n, r);
        },
        _report: function () {
            var e = this._logs;
            this._logs = [];
            var t = Fn.platform.information,
                n = t.getUserInfo() || {},
                r = n.userId,
                i = n.uniqueId,
                o = t.getConfig(),
                s = o.gameId,
                a = o.gameVersion,
                c = t.getSystemStr(),
                u = t.getLaunchOpts().query;
            null == e || e.forEach(function (e) {
                e.queryRaw = JSON.stringify(u);
            });
            var d = {
                    gameId: s,
                    userId: r,
                    uniqueId: i,
                    gameVersion: a,
                    sysInfo: c,
                    logs: e
                },
                l = function () {
                    var e = "" + Ln() + Rn;
                    Vn.post(e, d).then(function () {}).catch(function () {});
                };
            Un.sdkConfig() && Un.sdkConfig().env ? l() : Hn.once("EVT_SDK_READY", function () {
                jn("sdk ready report"), l();
            });
        },
        _delayReport: function () {
            var e = this;
            if (!this._delayer) {
                var t = (Fn.platform.information.getConfig() || {}).logReportFrequency,
                    n = void 0 === t ? 5e3 : t;
                this._delayer = setTimeout(function () {
                    e._report(), e._delayer = null;
                }, n);
            }
        }
    };

Gn._init();

var Wn = {
        post: Gn.post.bind(Gn)
    },
    Kn = {
        request: function (e, t, n, r, i) {
            return new Promise(function (o, s) {
                var a = {
                    url: t,
                    method: e,
                    enableHttp2: !0,
                    data: n,
                    header: r,
                    responseType: i,
                    success: function (e) {
                        o(e);
                    },
                    fail: function (e) {
                        s(e);
                    }
                };
                wx.request(a);
            });
        }
    },
    Bn = {
        getStorage: function (e) {
            try {
                return wx.getStorageSync(e);
            } catch (e) {
                return null;
            }
        },
        setStorage: function (e, t) {
            if (yn.isNull(t)) return !1;
            try {
                return wx.setStorageSync(e, t), !0;
            } catch (e) {
                return !1;
            }
        },
        removeStorage: function (e) {
            try {
                return wx.removeStorageSync(e), !0;
            } catch (e) {
                return !1;
            }
        },
        clearStorage: function () {
            try {
                return wx.clearStorageSync(), !0;
            } catch (e) {
                return !1;
            }
        }
    },
    zn = "__sdk_fail_logs_native",
    Jn = {
        errCode: 1001,
        errMsg: "微信Code获取失败"
    },
    Qn = {
        errCode: 1002,
        errMsg: "支付取消"
    },
    Xn = {
        errCode: 1003,
        errMsg: "支付失败"
    },
    Yn = {
        errCode: 1003,
        errMsg: "支付失败，暂不支持该平台"
    },
    $n = {
        errCode: 1005,
        errMsg: "拒绝授权获取用户信息"
    },
    Zn = {
        errCode: 1006,
        errMsg: "需要用户授权"
    },
    er = {
        errCode: 1007,
        errMsg: "获取用户信息失败"
    },
    tr = {
        errCode: 20002,
        errMsg: "订单数据不全，请传入创建订单返回的全部数据"
    },
    nr = {
        errCode: 20008,
        errMsg: "当前版本不支持使用动态分享"
    },
    rr = {
        errCode: 20009,
        errMsg: "频繁调用分享"
    },
    ir = {
        errCode: 3e4,
        errMsg: "方法暂不支持"
    },
    or = {
        errCode: 30001,
        errMsg: "传参错误"
    },
    sr = {
        errCode: 30002,
        errMsg: "未登录"
    },
    ar = {
        errCode: 30003,
        errMsg: "已销毁"
    },
    cr = {
        errCode: 1004,
        errMsg: "暂无广告"
    },
    ur = {
        errCode: 1005,
        errMsg: "微信广告单元id参数必填"
    },
    dr = {
        errCode: 1006,
        errMsg: "无效hortor视频广告"
    },
    lr = {
        errCode: -1,
        errMsg: "还没有初始化，请在初始化后调用接口"
    },
    fr = "EVT_SESSION",
    hr = "EVT_WX_LOGIN",
    gr = "EVT_TRACK_LOGIN",
    pr = "EVT_NEED_AUTH",
    mr = "EVT_ON_AUTH",
    vr = "EVT_AUTH_DENY",
    yr = "EVY_PAY_FAIL",
    wr = "EVT_SHARE_START",
    Ir = "EVT_SHARE_END",
    _r = "EVT_SHARE_TIME_START",
    Sr = "EVT_SHARE_TIME_END",
    Tr = "EVT_SHARE_FRIEND",
    br = "EVT_VIDEO_AD_PLAY_START",
    Cr = "EVT_VIDEO_AD_PLAY_FINISH",
    xr = "EVT_VIDEO_AD_ERROR",
    kr = "EVT_INTERSTITIAL_AD_SHOW",
    Or = "EVT_HORTOR_AD_PLAY_SUCCESS",
    Pr = "sharing",
    Er = function () {
        var e = D();
        return "__sdk_login_native_" + e.gameId + "_" + e.env + "_1.9.0";
    },
    Ar = function () {
        return Cn.get(Er(), null);
    },
    Ur = void 0,
    Dr = {},
    Mr = {
        clearUserInfo: function () {
            return Cn.remove(Er());
        },
        get combUserInfo() {
            return this.getUserInfo(!1) || this.getUserInfo(!0) || {
                envCombSdkInfo: null,
                combSdkInfo: {}
            };
        },
        getUserInfo: function (e) {
            var t = Ar() || {},
                n = t.userInfo,
                r = t.saveTime;
            if (!n || !r) return null;
            var i = ((n || {}).userSdk || {}).hasUserInfo;
            if (!e && !i) return null;
            var o = D().expireTime || 86400,
                s = yn.getTimeSec();
            return r + o < s || r > s ? null : n;
        },
        setUserInfo: function (e) {
            var t = e || {},
                n = t.encryptUserInfo,
                r = t.userSdk;
            if (!n) return !1;
            var i = {
                userInfo: e,
                saveTime: yn.getTimeSec()
            };
            Cn.set(Er(), i), i.userInfo = Object.assign(e, {
                userSdk: this._inheritOldData(r)
            });
        },
        _inheritOldData: function (e) {
            var t = this.getTempUser();
            if (!t || !e) return e;
            var n = t.isNewUser;
            return yn.isNull(n) || (e.isNewUser = !!n), e;
        },
        getSDKUserInfo: function () {
            var e = ((Ar() || {}).userInfo || {}).userSdk;
            return e && (e.gameUser = this.getGameUser()), e;
        },
        updateIsNewUser: function () {
            var e = Ar();
            e.userInfo.userSdk.isNewUser = !1, Cn.set(Er(), e);
        },
        setTempUser: function (e) {
            var t = (e || {}).userSdk;
            Ur = t ? this._inheritOldData(t) : null;
        },
        getTempUser: function () {
            if (!Ur) {
                var e = ((Ar() || {}).userInfo || {}).userSdk;
                Ur = e || null;
            }
            return Ur;
        },
        setGameUser: function (e) {
            Dr = Object.assign(Dr, e), Zt.dispatch(Bt, Dr);
        },
        getGameUser: function () {
            return Dr;
        }
    },
    Nr = {
        getUserInfo: function () {
            return Mr.getSDKUserInfo();
        },
        getSystemStr: function () {
            return l();
        },
        getSystemInfo: function () {
            return d();
        },
        getNetStatus: function () {
            return f();
        },
        getLaunchOpts: function () {
            return U();
        },
        getConfig: function () {
            return D();
        }
    },
    Lr = {
        _isShowed: !1,
        _isLaunched: !1,
        _sdkInited: !1,
        _hideAt: 0,
        init: function () {
            k(this._handleOnShow.bind(this)), O(this._handleOnHide.bind(this)), Zt.once(Rt, this._onSDKInit.bind(this), -1);
        },
        _onSDKInit: function () {
            var e = this;
            this._sdkInited = !0, this._isShowed ? this._triggerOnShow() : setTimeout(function () {
                e._isShowed || e._triggerOnShow();
            }, 2e3);
        },
        _triggerOnShow: function () {
            var e = x();
            this._handleOnShow(e);
        },
        _handleOnShow: function (e) {
            var t = this._hideAt ? Date.now() - this._hideAt : 0;
            e.hideDuration = t, this._isShowed = !0, e.coldStart = !this._isLaunched, Zt.dispatch(qt, e),
                (Mr.getTempUser() || {}).userId && this._logOnShow(e), this._sdkInited && (this._isLaunched = !0);
        },
        _handleOnHide: function (e) {
            this._hideAt = Date.now(), Zt.dispatch(Ht, e);
        },
        _logOnShow: function (e) {
            void 0 === e && (e = {}), e && delete e.hideDuration;
            var t = e.scene,
                n = e.coldStart,
                r = Mr.getTempUser() || {},
                i = r.userId,
                o = r.uniqueId,
                s = U().custom || {},
                a = s.channel,
                c = s.origChannel,
                u = s.shareConfigId,
                d = n ? 0 : 1,
                l = "";
            try {
                e = Object.assign(e, {
                    at: "onShow"
                }), l = JSON.stringify(e);
            } catch (e) {}
            var f = Bn.getStorage("__sdk_logOnShow_rawData__");
            f && f === l ? l = "" : Bn.setStorage("__sdk_logOnShow_rawData__", l);
            var h = {
                logType: 3,
                channel: a,
                origChannel: c,
                shareConfigId: u,
                scene: t,
                userId: i,
                uniqueId: o,
                open_type: d,
                rawData: l
            };
            l && Zt.dispatch(Kt, {
                log: h
            });
        }
    },
    Rr = {
        network: Kn,
        storage: Bn,
        information: Nr
    };

Tn.platform = Rr, Lr.init();

var qr, Hr = {
        Development: "Dev",
        Test: "Test",
        Production: "Prod"
    },
    Fr = {
        Ali: 1,
        TGA: 2,
        STD: 4,
        Platform: 8
    },
    jr = {
        Track: "track",
        UserSet: "user_set",
        UserSetOnce: "user_setOnce",
        UserAdd: "user_add",
        UserUnset: "user_unset",
        UserDel: "user_del"
    },
    Vr = {
        Text: 1,
        Image: 2,
        TextAndImage: 3,
        Scroll: 4,
        ScrollAndText: 5,
        ScrollAndImage: 6,
        All: 7
    },
    Gr = {
        Login: "login",
        Register: "register",
        ResetPass: "resetPass",
        Binding: "binding"
    },
    Wr = {
        Friend: 0,
        Space: 1
    },
    Kr = {
        Session: 0,
        Timeline: 1,
        Favorite: 2,
        SpecifiedSession: 3
    },
    Br = {
        Test: 1,
        Release: 3
    },
    zr = {
        Release: 0,
        Development: 1,
        Experience: 2
    },
    Jr = {
        Release: 0,
        Development: 1,
        Experience: 2
    },
    Qr = {
        WX: "app-we",
        QQ: "app-qq",
        Mobile: "app-mobile",
        Apple: "app-apple"
    },
    Xr = {
        QuitGame: 0,
        SwitchAccount: 1
    },
    Yr = {
        Opened: 1,
        Closed: 0,
        NotConfigured: -1
    },
    $r = {
        IconShow: "ICON_SHOW",
        IconClick: "ICON_CLICK",
        PageShow: "PAGE_SHOW",
        JumpCustomer: "JUMP_CUSTOMER",
        PageShowForce: "PAGE_SHOW_FORCE",
        JumpCustomerForce: "JUMP_CUSTOMER_FORCE"
    },
    Zr = {
        DaShi: "gs",
        XiaoMi: "secret"
    },
    ei = {
        WeChat: "wechat",
        Customer: "customerSession"
    },
    ti = {
        Short: 0,
        Long: 1
    };

! function (e) {
    e.InitFail = "init_fail", e.LoginFail = "login_fail", e.WxLoginFail = "wx_login_fail",
        e.PlatformLoginFail = "platform_login_fail", e.PlatformUpdateFail = "platform_update_fail",
        e.PayFail = "pay_fail", e.CreateOrderFail = "create_order_fail", e.MdsPayFail = "mds_pay_fail",
        e.MdsPlatformCallbackFail = "mds_platform_callback_fail", e.CustomerPayFail = "customer_pay_fail",
        e.JumpPayFail = "jump_pay_fail";
}(qr || (exports.MonitorType = qr = {}));

var ni = {
        AggrType: {
            SWITCH: "customSwitch",
            IP_REGION: "ipregion",
            SHARE: "share"
        },
        post: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s, a, c, u, d, l, f, h, g, p;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = Un.sdkConfig(), r = t.gameId, i = t.gameVersion, o = Tn.platform.information,
                                s = o.getUserInfo() || {}, a = s.uniqueId, c = s.userId, u = s.name, d = o.getSystemStr(),
                                [4, C(Xt, e)];

                        case 1:
                            return l = n.sent(), f = Object.keys(l), h = {
                                gameId: r,
                                gameVersion: i,
                                openId: c,
                                uniqueId: a,
                                userId: a,
                                servers: f,
                                nickName: u || "",
                                params: l,
                                sysInfo: d
                            }, g = Nn() + "/platform-gateway-server/api/v1/aggr", [4, bn.post(g, h)];

                        case 2:
                            return p = n.sent(), [4, this._renderResult(p.data, l)];

                        case 3:
                            return [2, n.sent()];
                    }
                });
            });
        },
        _renderResult: function (e, r) {
            return t(this, void 0, void 0, function () {
                var t, i, o;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = e || {}, i = {}, Object.keys(t).forEach(function (e) {
                                var n = {
                                        data: null,
                                        err: null
                                    },
                                    r = t[e] || {},
                                    o = r.data,
                                    s = r.meta;
                                s && s.errCode ? n.err = s : n.data = o, i[e] = n;
                            }), [4, C(Yt, {
                                req: r,
                                resp: i
                            })];

                        case 1:
                            return o = n.sent(), [2, Object.assign(i, o)];
                    }
                });
            });
        }
    },
    ri = function (e) {
        return Un.init(e);
    },
    ii = {
        getExtUserInfo: function () {
            return t(this, void 0, void 0, function () {
                var e, t, r, i, o;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return e = Un.sdkConfig().gameId, t = Tn.platform.information, r = (t.getUserInfo() || {}).uniqueId,
                                i = {
                                    userId: r,
                                    gameId: e
                                }, o = Nn() + "/wechat/user-info", [4, bn.get(o, i)];

                        case 1:
                            return [2, n.sent().data];
                    }
                });
            });
        }
    },
    oi = {
        init: function () {
            b(Xt, this._processAggr.bind(this));
        },
        checkIps: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s, a, c, u, d;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = e.interfaceIds, r = e.userId, i = Un.sdkConfig(), o = i.gameId, s = i.gameVersion,
                                a = Tn.platform.information, c = (a.getUserInfo() || {}).uniqueId, u = {
                                    gameId: o,
                                    gameVersion: s,
                                    interfaceIds: t || [],
                                    userId: r || c
                                }, d = Nn() + "/ipregion/api/v1/blockstatus/multi", [4, bn.post(d, u)];

                        case 1:
                            return [2, n.sent().data];
                    }
                });
            });
        },
        _processAggr: function (e) {
            if (!e || !e.ipregion) return null;
            var t = (Tn.platform.information.getUserInfo() || {}).uniqueId,
                n = Object.assign({}, e.ipregion);
            return e.ipregion.userId || (n = Object.assign(n, {
                userId: t || ""
            })), {
                ipregion: n
            };
        }
    };

oi.init();

var si = {
        Text: 1,
        Image: 2,
        Scroll: 4
    },
    ai = si.Text | si.Image,
    ci = {
        NoticeTypes: si,
        getNotice: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = Un.sdkConfig().gameId, r = Object.assign({}, {
                                gameId: t,
                                tp: ai
                            }, e || {}), i = tn.combHost + "/capi/v1/notice", [4, bn.get(i, r)];

                        case 1:
                            return [2, n.sent().data];
                    }
                });
            });
        }
    },
    ui = {
        ERROR: "error",
        WARN: "warn",
        DEBUG: "debug"
    },
    di = {
        LOG_TP: ui,
        init: function () {
            var e = this;
            Zt.on("EVT_LOGIN_FAIL", function (t) {
                e.postLog(ui.ERROR, t.data);
            }), Zt.on(Ft, function (t) {
                e.postLog(ui.ERROR, t.data);
            });
        },
        postLog: function (e, t, n) {
            t && "object" == (void 0 === t ? "undefined" : Ot(t)) && !n && (n = t, t = "");
            var r = n || {},
                o = r.msg,
                s = r.errMsg,
                a = r.message,
                c = r.logTp,
                u = t || o || a || s;
            i(e + ": " + u, n);
            var d = Tn.platform.information,
                l = d.getUserInfo() || {},
                f = l.userId,
                h = l.uniqueId,
                g = d.getConfig(),
                p = g.gameId,
                m = g.gameVersion,
                v = d.getSystemStr(),
                y = Object.assign({
                    msg: u,
                    logTp: c,
                    gameId: p,
                    gameVersion: m,
                    userId: f,
                    uniqueId: h,
                    sysInfo: v,
                    hortorMsg: u,
                    hortorLogTp: e
                }, n || {}),
                w = tn.logHost + "/wxlog/api/v1/log";
            bn.post(w, y).then(function () {
                i("log remote success");
            }).catch(function (e) {
                i("log remote fail", e);
            });
        }
    };

di.init();

var li = {
    init: function () {
        b(Xt, this._processAggr.bind(this)), b(Yt, this._processAggrReq.bind(this));
    },
    _renderSwitches: function (e) {
        var t = [];
        return e.map(function (e) {
            if (e) {
                var n = "string" == typeof e ? e : e.switchId;
                t.some(function (e) {
                    return e.switchId === n;
                }) || t.push({
                    switchId: n
                });
            }
        }), t;
    },
    _renderParams: function (e) {
        var t = {};
        if (e)
            for (var n in e) {
                var r = e[n];
                void 0 !== r && "nickName" !== n && (t[n] = r);
            }
        return t;
    },
    _getRequestData: function (e, t) {
        var n = (t || {}).nickName,
            r = Tn.platform.information,
            i = r && r.getUserInfo() || {},
            o = i.userId,
            s = i.uniqueId,
            a = i.channel,
            c = r && r.getLaunchOpts() || {},
            u = c.scene,
            d = Un.sdkConfig();
        return {
            gameId: d.gameId,
            nickName: n,
            gameTp: "minigame",
            platform: "minigame",
            gameVersion: d.gameVersion,
            uniqueId: s,
            channel: a,
            openId: o,
            scene: u,
            defCustomParams: t,
            switchIdList: e
        };
    },
    _transformResult: function (e, t) {
        var n = {};
        return t.forEach(function (t, r) {
            n[t] = e[r];
        }), i("switch result", n), n;
    },
    _processAggr: function (e) {
        if (!e || !e.customSwitch) return null;
        var t = e.customSwitch,
            n = t.switches,
            r = t.params;
        return {
            customSwitch: this._getRequestData(n, r)
        };
    },
    _processAggrReq: function (e) {
        if (!(e && e.resp && e.req && e.req.customSwitch && e.resp.customSwitch)) return null;
        var t = e.req.customSwitch.switches,
            n = e.resp.customSwitch.data;
        return {
            customSwitch: {
                data: this._transformResult(n, t)
            }
        };
    },
    check: function (e, r) {
        return t(this, void 0, void 0, function () {
            var t, i, o;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        if (n.trys.push([0, 2, , 3]), 0 == Un._hasInitSuccess) throw lr;
                        return t = tn.combHost + "/comb-custom-switch-server/api/v1/switch/multi/status",
                            i = this._getRequestData(e, r), [4, bn.post(t, i)];

                    case 1:
                        return o = n.sent(), [2, this._transformResult(o.data, i.switchIdList)];

                    case 2:
                        return [2, n.sent()];

                    case 3:
                        return [2];
                }
            });
        });
    }
};

li.init();

var fi = u("createBannerAd", "2.0.4"),
    hi = u("createRewardedVideoAd", "2.0.4"),
    gi = u("createRewardedVideoAd", "2.8.0"),
    pi = u("createInterstitialAd", "2.6.0");

u("createGridAd", "2.9.2");

var mi = "",
    vi = {
        create: function (e) {
            var t = e || {},
                n = t.adUnitId;
            mi = t.customScene;
            var r = function (e) {
                return fi ? wx.createBannerAd(e) : null;
            }(e);
            return r && (yn.defineProperty(r, "show", this._showHandler.bind(this, n)), yn.defineProperty(r, "hide", this._hideHandler.bind(this, n)),
                r.onError(function (e) {
                    i("banner ad err", e);
                })), r;
        },
        _showHandler: function (e, t) {
            var n = this;
            return function () {
                return new Promise(function (r, o) {
                    n._postLog(e, 28), t().then(function (t) {
                        r(t), i("banner ad show"), n._postLog(e, 21);
                    }).catch(function (e) {
                        o(e), i("banner ad show fail", e);
                    });
                });
            };
        },
        _hideHandler: function (e, t) {
            var n = this;
            return function (r) {
                t(r), i("banner ad hide"), n._postLog(e, 22);
            };
        },
        _postLog: function (e, t) {
            var n = U(),
                r = n.scene,
                i = {
                    adUnitId: e,
                    logType: t,
                    channel: (n.custom || {}).channel,
                    scene: r,
                    customScene: mi || ""
                };
            Zt.dispatch(Kt, {
                log: i
            });
        }
    },
    yi = "";

R.prototype = {
    bindedOnClose: null,
    injectKeys: ["Close", "Error", "Load"],
    injectHandlers: {},
    create: function (e) {
        var t, n = (t = e, pi ? wx.createInterstitialAd(t) : null);
        return n && (yn.defineProperty(n, "show", this._showHandler.bind(this)), yn.defineProperty(n, "destroy", this._destroyHandler.bind(this)),
            yn.defineProperty(n, "offClose", this._offCloseHandler.bind(this)), this.adInstance = n,
            this._bindOnClose(), n.onError(function (e) {
                i("interstitial ad err", e);
            })), n;
    },
    destroy: function () {
        !this.destroyed && this.adInstance && (this.destroyed = !0, this.adInstance.destroy(),
            this.adInstance = null);
    },
    setOptions: function (e) {
        var t = this;
        if (e) {
            var n = e.customScene;
            yi = n || yi, this.options = e, this.injectKeys.forEach(function (n) {
                var r = "on" + n;
                yn.isFun(e[r]) && (t.options = t.options || {}, t.options[r] = e[r]);
            });
        }
    },
    bindHandlers: function () {
        var e = this;
        this.adInstance && this.injectKeys.forEach(function (t) {
            var n = "on" + t,
                r = function (t) {
                    e.options && yn.isFun(e.options[n]) && e.options[n](t);
                };
            e.injectHandlers[n] = r, e.adInstance[n] && e.adInstance[n](r);
        });
    },
    unbindHandlers: function () {
        var e = this;
        this.adInstance && (this.injectKeys.forEach(function (t) {
            var n = "off" + t,
                r = "on" + t,
                i = e.injectHandlers[r];
            e.adInstance[n] && i && e.adInstance[n](i);
        }), this.options = null, this.injectHandlers = {});
    },
    _showHandler: function (e) {
        var t = this;
        return function () {
            return new Promise(function (n, r) {
                yn.isFun(e) || r(ir), t._postLog(25), e().then(function (e) {
                    n(e), t._postLog(26), t._stdInterstitialAdLog(!0);
                }).catch(function (e) {
                    r(e), t._stdInterstitialAdLog(!1, e.errCode), i("interstitial ad show fail", e);
                });
            });
        };
    },
    _stdInterstitialAdLog: function (e, t) {
        void 0 === t && (t = 0), i("interstitial this.options", this.options);
        var n = this.options,
            r = n.adUnitId,
            o = n.sequenceInfo;
        Zt.dispatch(kr, {
            adUnitId: r,
            isEnded: e,
            playFailCode: t,
            spentTime: 0,
            sequenceInfo: o,
            adType: 1
        });
    },
    _destroyHandler: function (e) {
        var t = this;
        return function (n) {
            t._unbindOnClose(), t.destroyed = !0, t.adInstance = null, yn.isFun(e) && e(n);
        };
    },
    _offCloseHandler: function (e) {
        var t = this;
        return function (n) {
            yn.isFun(e) && (e(n), n || t.destroyed || (t._unbindOnClose(), t._bindOnClose()));
        };
    },
    _unbindOnClose: function () {
        var e = this.adInstance;
        this.bindedOnClose && e && yn.isFun(e.offClose) && e.offClose(this.bindedOnClose),
            this.bindedOnClose = null;
    },
    _bindOnClose: function () {
        var e = this,
            t = this.adInstance;
        !this.bindedOnClose && t && yn.isFun(t.onClose) && (this.bindedOnClose = function () {
            i("interstitial ad close"), e._postLog(27);
        }, t.onClose(this.bindedOnClose));
    },
    _postLog: function (e) {
        var t = U(),
            n = t.scene,
            r = (t.custom || {}).channel;
        Zt.dispatch(Kt, {
            log: {
                adUnitId: this.adUnitId,
                logType: e,
                channel: r,
                scene: n,
                customScene: yi || ""
            }
        });
    }
};

var wi = {},
    Ii = {
        create: function (e) {
            return new R(e).adInstance;
        },
        createAdManager: function (e) {
            var t = e.adUnitId,
                n = new R(e);
            return n.bindHandlers(), wi[t] = n, n;
        },
        preLoad: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r = this;
                return n(this, function (n) {
                    if (!(t = e.adUnitIds) || !t.length) throw or;
                    if (!pi) throw ir;
                    return t.forEach(function (e) {
                        wi[e] = wi[e] || r.createAdManager({
                            adUnitId: e
                        });
                    }), i("preLoad ad success"), [2, wi];
                });
            });
        },
        show: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            if (i("show interstitial ad ", e), t = e.adUnitId, (r = wi[t] || this.createAdManager(e)).setOptions(e),
                                !(o = r.adInstance)) throw ir;
                            return [4, o.show()];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        getInterstitialAd: function (e) {
            i("get interstitial ad ", e);
            var t = e.adUnitId,
                n = (wi[t] || this.createAdManager(e)).adInstance;
            if (!n) throw ir;
            return n;
        },
        _destroy: function (e) {
            var t = wi[e];
            t && (t.unbindHandlers(), t.destroy(), wi[e] = null);
        },
        destroy: function (e) {
            var t = this;
            i("destroy interstitial ad", e);
            var n = (e || {}).adUnitId;
            if (n) return this._destroy(n);
            Object.keys(wi || {}).forEach(function (e) {
                t._destroy(e);
            });
        }
    },
    _i = "hortor视频广告",
    Si = "",
    Ti = function (e, t, n) {
        void 0 === n && (n = ""), Si = n || Si;
        var r = U(),
            i = r.scene,
            o = {
                adUnitId: e,
                logType: t,
                channel: (r.custom || {}).channel,
                scene: i,
                customScene: Si || ""
            };
        Zt.dispatch(Kt, {
            log: o
        });
    },
    bi = function (e) {
        var t = e.sequenceInfo;
        Zt.dispatch(Cr, {
            sequenceInfo: t,
            adType: 2
        }), Zt.dispatch(Or);
    };

q.prototype = {
    _sCool: function () {
        this.coolLoad = !1, this.coolTimer = null;
    },
    _sRest: function () {
        this.loaded = !1, this.loading = !0, this.isNeedConsumeQueue = !0, this._sCool();
    },
    _sLoad: function (e) {
        i("ad loaded", e), this.loaded = !0, this.loading = !1, this.fstLoaded = !0, this._sCool();
    },
    _sError: function (e) {
        i("ad err", e), this.loaded = !1, this.loading = !1, this.fstLoaded = !0;
        var t = e.errCode;
        !this.coolTimer && [1002, 1004].indexOf(t) > -1 && (this.coolLoad = !0, this.coolTimer = setTimeout(this._sCool.bind(this), this.loadCoolTime));
    },
    _loadAd: function (e, r) {
        return t(this, void 0, void 0, function () {
            var t;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        i("ad reload"), n.label = 1;

                    case 1:
                        if (n.trys.push([1, 3, , 4]), this.coolLoad && r) throw r;
                        return [4, e.load()];

                    case 2:
                        return n.sent(), this._sLoad(), [2, !0];

                    case 3:
                        throw t = n.sent(), this._sError(t), t;

                    case 4:
                        return [2];
                }
            });
        });
    },
    _showAd: function (e, r) {
        return t(this, void 0, void 0, function () {
            var t;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        i("ad show", r), n.label = 1;

                    case 1:
                        return n.trys.push([1, 3, , 5]), [4, e.show(r)];

                    case 2:
                        return [2, n.sent()];

                    case 3:
                        return t = n.sent(), [4, this._loadAd(e, t)];

                    case 4:
                        return n.sent(), [2, e.show()];

                    case 5:
                        return [2];
                }
            });
        });
    },
    _waitResult: function (e) {
        var t = this;
        return i("ad wait"), new Promise(function (n, r) {
            var o = setTimeout(function () {
                if (i("ad wait timeout"), t.fstLoaded) return t._sLoad("fake"), n(!0);
                t._loadAd(e).then(n).catch(r);
            }, t.callTimeout);
            e.onLoad(function (t) {
                e.offLoad(this), clearTimeout(o), n(!0);
            }), e.onError(function (t) {
                e.offError(this), clearTimeout(o), r(t);
            });
        });
    },
    getInstance: function (e) {
        if (void 0 !== this.adInstance) return this.adInstance;
        var t = function (e) {
            return hi ? wx.createRewardedVideoAd(e) : null;
        }(e);
        return this.adInstance = t, t ? (t.onLoad(this._sLoad.bind(this)), t.onError(this._sError.bind(this)),
            this.adInstance) : null;
    },
    _getAdInstance: function (e) {
        return t(this, void 0, void 0, function () {
            var t;
            return n(this, function (n) {
                if (this.destroyed) throw ar;
                if (!(t = this.getInstance(e))) throw ir;
                return [2, t];
            });
        });
    },
    _checkLoaded: function (e) {
        return t(this, void 0, void 0, function () {
            return n(this, function (t) {
                switch (t.label) {
                    case 0:
                        return this.loaded ? [2, !0] : this.loading ? [4, this._waitResult(e)] : [3, 2];

                    case 1:
                    case 3:
                        return [2, t.sent()];

                    case 2:
                        return this.coolLoad ? [3, 4] : (i("ad try load"), [4, this._loadAd(e)]);

                    case 4:
                        if (!this.loaded) throw cr;
                        return [2, !0];
                }
            });
        });
    },
    destroy: function () {
        this.adInstance && (this.adInstance.destroy(), this.adInstance = null), this.destroyed = !0,
            this._sRest(), this.loading = !1;
    },
    _showStart: function (e) {
        this.loadReported = !1, Zt.dispatch(br, {
            adUnitId: e
        });
    },
    _showSuccess: function (e) {
        Zt.dispatch(br, {
            adUnitId: e,
            playSuccess: !0
        });
    },
    _showFinish: function (e, t, n, r, i) {
        void 0 === n && (n = 0);
        var o = r ? Math.max(yn.getTime() - r, 0) : 0;
        Zt.dispatch(Cr, {
            adUnitId: e,
            isEnded: t,
            playFailCode: n,
            spentTime: o,
            sequenceInfo: i,
            adType: 0
        }), t && this._initVideoFreezeTime();
    },
    _initVideoFreezeTime: function () {
        var e = Cn.get("__sdk_std_seq") || {};
        if (this.videoPlayFreezeEnable = e.video_play_freeze_enable || 0, this.videoPlayFreezeTime = e.video_play_freeze_time || 0,
            this.activeFreezeTime = this.videoPlayFreezeTime, clearTimeout(this.freezeTimer),
            !(this.activeFreezeTime <= 0 || 0 === this.videoPlayFreezeEnable)) {
            var t = this;
            ! function e() {
                t.activeFreezeTime--, clearTimeout(t.freezeTimer), t.activeFreezeTime <= 0 || (t.freezeTimer = setTimeout(function () {
                    e();
                }, 1e3));
            }();
        }
    },
    show: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, o, s, a, c, u, d, l, f, h, g = this;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return i("调用展示广告"), [4, this._getAdInstance(e)];

                    case 1:
                        t = n.sent(), r = e.adUnitId, o = e.onClose, s = e.sequenceInfo, a = e.customScene,
                            i("showing ad", r), c = yn.getTime(), u = function (e) {
                                t.offClose(u), o && o(e);
                                var n = (e || {}).isEnded,
                                    i = void 0 === n || n;
                                Ti(r, i ? 17 : 18, a), g._showFinish(r, i, 0, c, s);
                            }, t.onClose(u), Ti(r, 15, a), this._showStart(r), n.label = 2;

                    case 2:
                        return n.trys.push([2, 5, , 6]), [4, this._checkLoaded(t)];

                    case 3:
                        return n.sent(), [4, this._showAd(t, e)];

                    case 4:
                        return d = n.sent(), this._showSuccess(r), this._sRest(), Ti(r, 16, a), [2, d];

                    case 5:
                        throw l = n.sent(), t.offClose(u), f = (l || {}).errCode, h = void 0 === f ? 1 : f,
                            this._showFinish(r, !1, h, c, s), i("ad show err", r, l), Zt.dispatch(xr, {
                                adUnitId: r,
                                err: l
                            }), l;

                    case 6:
                        return [2];
                }
            });
        });
    },
    prepareShowHortorVedioAd: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return t = JSON.parse(JSON.stringify(this.cacheHortorAdInfo)), this.cacheHortorAdInfo = null,
                            this.isNeedConsumeQueue = !0, [4, this._hortorAdCheck(e)];

                    case 1:
                        return n.sent(), r = new Promise(function (e, n) {
                            var r = t || {},
                                i = r.jumpConfig,
                                o = r.videoResource;
                            i && o ? e(t) : n(dr);
                        }), [2, r];
                }
            });
        });
    },
    check: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, o, s;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return [4, this._getAdInstance(e)];

                    case 1:
                        t = n.sent(), i("checking ad", r = e.adUnitId), this.loadReported || Ti(r, 23),
                            n.label = 2;

                    case 2:
                        return n.trys.push([2, 4, 5, 6]), [4, this._checkLoaded(t)];

                    case 3:
                        return o = n.sent(), this.loadReported || Ti(r, 24), [2, o];

                    case 4:
                        throw s = n.sent(), i("ad check err", r, s), Zt.dispatch(xr, {
                            adUnitId: r,
                            err: s
                        }), s;

                    case 5:
                        return this.loadReported = !0, [7];

                    case 6:
                        return [2];
                }
            });
        });
    },
    _getConnomHorotrAdParams: function (e) {
        var t = Tn.platform.information,
            n = t.getUserInfo() || {},
            r = n.gameId,
            i = n.uniqueId,
            o = n.openId,
            s = t.getSystemInfo();
        return {
            adPositionId: e.hortorAdUnitId,
            gameId: r,
            uniqueId: i,
            openId: o,
            sysInfo: JSON.stringify(s)
        };
    },
    _getAdQueueInfo: function (e) {
        return t(this, void 0, void 0, function () {
            var t, i, o, s, a, c, u;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        if (i = (t = this).isOnlyUseWX, (o = t.cacheQueue).length > 1) return [2, {
                            isOnlyUseWX: i,
                            cacheQueue: o
                        }];
                        s = Nn() + "/ad-platform-server/api/v1/platform/strategy", a = this._getConnomHorotrAdParams(e),
                            n.label = 1;

                    case 1:
                        return n.trys.push([1, 3, , 4]), [4, bn.post(s, a)];

                    case 2:
                        return c = n.sent().data, u = c.strategyList || [], this.isOnlyUseWX = c.isOnlyUseWX,
                            this.cacheQueue = r(this.cacheQueue, u), [2, {
                                isOnlyUseWX: this.isOnlyUseWX,
                                cacheQueue: this.cacheQueue
                            }];

                    case 3:
                        return n.sent(), [2, Promise.resolve({
                            isOnlyUseWX: this.isOnlyUseWX,
                            cacheQueue: this.cacheQueue
                        })];

                    case 4:
                        return [2];
                }
            });
        });
    },
    _hortorAdCheck: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, o, s, a, c;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return t = {
                            isHaveAd: !1,
                            adType: "hortor",
                            msg: "无hortor视频广告",
                            isFreeze: !1,
                            freezeTime: 0
                        }, this.cacheHortorAdInfo ? [2, Object.assign(t, {
                            isHaveAd: !0,
                            msg: _i
                        })] : (r = Nn() + "/ad-platform-server/api/v1/platform/fetch", o = this._getConnomHorotrAdParams(e),
                            [4, bn.post(r, o)]);

                    case 1:
                        return s = n.sent(), a = s.data, c = s.meta, i("get ad info", a, c), c && 0 !== c.errCode ? [2, t] : (this.cacheHortorAdInfo = a,
                            [2, Object.assign(t, {
                                isHaveAd: !0,
                                msg: _i
                            })]);
                }
            });
        });
    },
    _wxAdCheck: function (e) {
        return t(this, void 0, void 0, function () {
            var t;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return i("_wxAdCheck"), [4, this.check(e)];

                    case 1:
                        return i("wx ad check", t = n.sent()), [2, {
                            isHaveAd: t,
                            adType: "wx",
                            msg: t ? "微信视频广告" : "无微信视频广告",
                            isFreeze: !1,
                            freezeTime: 0
                        }];
                }
            });
        });
    },
    _consumeQueue: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, o, s, a;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return n.trys.push([0, 6, , 7]), t = ["_wxAdCheck", "_hortorAdCheck"], r = 0,
                            this.isNeedConsumeQueue ? (r = this.cacheQueue.shift(), this.preAd = r, this.isNeedConsumeQueue = !1,
                                i("consume queue", r)) : i("no consume queue", r = this.preAd), o = null, r >= t.length ? [4, this._wxAdCheck(e)] : [3, 2];

                    case 1:
                        return [2, o = n.sent()];

                    case 2:
                        return s = t[r], a = t[Number(!r)], [4, this[s](e)];

                    case 3:
                        return (o = n.sent()).isHaveAd ? [3, 5] : [4, this[a](e)];

                    case 4:
                        o = n.sent(), n.label = 5;

                    case 5:
                        return o.isHaveAd || (o = {
                            isHaveAd: !1,
                            adType: "",
                            msg: "暂无视频广告",
                            isFreeze: !1,
                            freezeTime: 0
                        }), [2, o];

                    case 6:
                        throw n.sent();

                    case 7:
                        return [2];
                }
            });
        });
    },
    mixCheck: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, o, s, a, c, u, d, l;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        if (t = {}, r = e.adUnitId, o = e.hortorAdUnitId, !r) throw ur;
                        return a = (s = this).activeFreezeTime, s.videoPlayFreezeEnable && a > 0 ? [2, t = {
                            isHaveAd: !1,
                            adType: "",
                            msg: "视频广告冻结期间, 暂无视频广告",
                            isFreeze: !0,
                            freezeTime: this.activeFreezeTime
                        }] : (c = !0, o ? [4, this._getAdQueueInfo(e)] : [3, 2]);

                    case 1:
                        u = n.sent(), d = u.isOnlyUseWX, l = u.cacheQueue, c = d || 0 === l.length, i("get ad queue", u),
                            n.label = 2;

                    case 2:
                        return c ? (i("isWxAd"), [4, this._wxAdCheck(e)]) : [3, 4];

                    case 3:
                        return i("adInfo", t = n.sent()), [2, t];

                    case 4:
                        return [4, this._consumeQueue(e)];

                    case 5:
                        return i("ad result", t = n.sent()), [2, t];
                }
            });
        });
    }
};

var Ci, xi = "global",
    ki = {
        managerOrder: [],
        adManagers: {},
        idToManagerKeys: {},
        _getOpt: function (e) {
            var t = Object.assign({}, e),
                n = t.multiton,
                r = t.type;
            return t.multiton = !(!n && !r || !gi), t;
        },
        _getManagerKey: function (e) {
            var t = e.adUnitId,
                n = e.multiton,
                r = e.type;
            return this.idToManagerKeys[t] || (n ? (this.idToManagerKeys[t] = r || t, r || t) : (this.idToManagerKeys[t] = xi,
                xi));
        },
        _getAdManager: function (e) {
            var t = this._getManagerKey(e),
                n = this.adManagers[t] || null;
            if (n) return n;
            var r = D().maxTempVideoAdLen;
            this.managerOrder.length >= r && this.destroy(this.managerOrder[0]);
            var o = e.adUnitId,
                s = new q();
            return i("create adManager", t, o), this.adManagers[t] = s, this.managerOrder.push(t),
                this.idToManagerKeys[o] = t, s;
        },
        destroy: function (e) {
            var t = "";
            if ((t = "string" == typeof e ? this.idToManagerKeys[e] || e || "" : e ? this._getManagerKey(this._getOpt(e)) : "") && t !== xi) {
                var n = this.adManagers[t];
                if (n) {
                    n.destroy(), this.adManagers[t] = null;
                    var r = this.managerOrder.indexOf(t);
                    r > -1 && this.managerOrder.splice(r, 1), i("destroy adManager", t);
                }
            }
        },
        check: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = this._getOpt(e), [4, this._getAdManager(t).check(t)];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        mixCheck: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = this._getOpt(e), [4, this._getAdManager(t).mixCheck(t)];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        show: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = this._getOpt(e), [4, this._getAdManager(t).show(t)];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        prepareShowHortorVedioAd: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = this._getOpt(e), [4, this._getAdManager(t).prepareShowHortorVedioAd(t)];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        play: function (e) {
            var t = this;
            return new Promise(function (n, r) {
                var i = (e || {}).onShow;
                t.show(Object.assign({}, e || {}, {
                    onClose: function (e) {
                        n(e || {
                            isEnded: !0
                        });
                    }
                })).then(function (e) {
                    i && i(e);
                }).catch(r);
            });
        },
        getVideoAd: function (e) {
            var t = this._getOpt(e);
            return this._getAdManager(t).getInstance(t);
        },
        adPointShow: function (e, t) {
            void 0 === e && (e = ""), void 0 === t && (t = ""), Ti(e, 20, t);
        },
        hortorAdPlaySuccess: function (e) {
            bi(e);
        }
    },
    Oi = "",
    Pi = {
        create: function (e) {
            var t = e || {},
                n = t.adUnitId;
            Oi = t.customScene;
            var r = function (e) {
                return u("createCustomAd", "2.11.1") ? wx.createCustomAd(e) : null;
            }(e);
            return r && (yn.defineProperty(r, "show", this._showHandler.bind(this, n)), yn.defineProperty(r, "hide", this._hideHandler.bind(this, n)),
                r.onError(function (e) {
                    i("custom ad err", e);
                })), r;
        },
        _showHandler: function (e, t) {
            var n = this;
            return function () {
                return new Promise(function (r, o) {
                    n._postLog(e, 41), t().then(function (t) {
                        r(t), i("custom ad show"), n._postLog(e, 42);
                    }).catch(function (e) {
                        o(e), i("custom ad show fail", e);
                    });
                });
            };
        },
        _hideHandler: function (e, t) {
            var n = this;
            return function (r) {
                t(r), i("custom ad hide"), n._postLog(e, 43);
            };
        },
        _postLog: function (e, t) {
            var n = U(),
                r = n.scene,
                i = {
                    adUnitId: e,
                    logType: t,
                    channel: (n.custom || {}).channel,
                    scene: r,
                    customScene: Oi || ""
                };
            Zt.dispatch(Kt, {
                log: i
            });
        }
    };

Zt.once(Rt, F);

var Ei = "__APM_TEMP_LOGS",
    Ai = function () {
        function e(e, t) {
            this.wx = e, this._temp = null, this._max = t.MaxTempFailLogLength || 0, this.enable = t.EnabledTempFailLog;
        }
        return e.prototype.setStorage = function (e) {
            try {
                this._temp = e, this.wx.setStorageSync(Ei, e);
            } catch (e) {
                console.log("[APM] set storage err: ", e);
            }
        }, e.prototype.getStorage = function () {
            var e = this._temp;
            if (e) return e;
            try {
                e = this.wx.getStorageSync(Ei), this._temp = e;
            } catch (t) {
                e = "", console.log("[APM] get storage err: ", t);
            }
            return e;
        }, e.prototype.limitLens = function (e, t) {
            var n = e,
                r = e.length - t;
            return t > 0 && r > 0 && (n = e.slice(r)), n;
        }, e.prototype.setTemp = function (e) {
            if (this.enable) {
                var t = this._temp || [];
                t.push(e), this._temp = this.limitLens(t, this._max), console.log("[APM] storage fail log: ", this._temp),
                    this.setStorage(this._temp);
            }
        }, e.prototype.mergeNum = function (e, t) {
            var n = e || t;
            if (n) {
                for (var r in t = t || {}, e = e || {}, n) t[r] = t[r] || 0, t[r] += e[r] || 0;
                return t;
            }
        }, e.prototype.mergeTemp = function (e, t) {
            var n = t || {},
                r = n.logs,
                i = n.sockets,
                o = n.times,
                s = e || {},
                a = s.logs,
                c = s.sockets,
                u = s.times,
                d = {};
            d.logs = this.limitLens((a || []).concat(r || []), this._max), d.sockets = this.mergeNum(i, c);
            var l = o || u;
            if (l)
                for (var f in d.times = {}, l) d.times[f] = this.mergeNum((o || {})[f], (u || {})[f]);
            return d;
        }, e.prototype.getTemp = function (e) {
            var t = this;
            if (!this.enable) return e;
            var n = this.getStorage(),
                r = Object.assign({}, e || {});
            return n && n.length && (n.forEach(function (e) {
                r = t.mergeTemp(e, r);
            }), console.log("[APM] merge storage log: ", r), this.clear()), r;
        }, e.prototype.checkTemp = function () {
            return this.enable && this.getStorage();
        }, e.prototype.clear = function () {
            this.setStorage("");
        }, e;
    }(),
    Ui = function () {
        function e(e, t) {
            this.clientInfo = null, this.wx = e, this.config = t, this.initNetworkType(), this.logTemper = new Ai(this.wx, t);
        }
        return e.prototype.setUserInfo = function (e) {
            this.config.userInfo = Object.assign(this.config.userInfo || {}, e);
        }, e.prototype.initNetworkType = function () {
            var e = this;
            this.netTp = "unknown", this.wx.getNetworkType({
                success: function (t) {
                    e.netTp = t.networkType;
                }
            }), this.wx.onNetworkStatusChange && "function" == typeof this.wx.onNetworkStatusChange && (this.bindedNetChangge || (this.bindedNetChangge = !0,
                this.wx.onNetworkStatusChange(function (t) {
                    e.netTp = t.networkType;
                })));
        }, e.prototype.getClientInfo = function () {
            if (this.clientInfo) return this.clientInfo.netType = this.netTp, this.clientInfo;
            var e = this.wx.getSystemInfoSync();
            return this.clientInfo = {
                version: e.version,
                system: e.system,
                platform: e.platform,
                sdk: e.SDKVersion,
                model: e.model,
                netType: this.netTp,
                brand: e.brand
            };
        }, e.prototype.report = function (e, t) {
            var n = this;
            void 0 === e && (e = {});
            var r = e.logs,
                i = e.times,
                o = e.sockets;
            if (this.logTemper.checkTemp() || e.logs && e.logs.length || e.times || e.sockets) {
                var s = [];
                r.length > 0 && (s = r.map(function (e) {
                    return e.toJSON();
                }));
                var a = this.logTemper.getTemp({
                    logs: s,
                    times: i,
                    sockets: o
                });
                if (!a.logs || 0 != a.logs.length) {
                    var c = this.config,
                        u = {
                            game: {
                                gameId: c.gameId,
                                version: c.gameVersion,
                                env: c.env
                            },
                            client: this.getClientInfo(),
                            user: c.userInfo,
                            logs: a.logs
                        };
                    this.post(u, function (e, r) {
                        r ? n.logTemper.setTemp(a) : t && t(e);
                    });
                }
            }
        }, e.prototype.getReportUrl = function () {
            return this.config.Debug ? this.config.reportUrlDev : this.config.reportUrlProc;
        }, e.prototype.post = function (e, t) {
            this.wx.request({
                url: this.getReportUrl(),
                method: "POST",
                data: e,
                header: {
                    "content-type": "application/json"
                },
                success: function (e) {},
                fail: function (e) {}
            });
        }, e;
    }(),
    Di = ["comb-platform", "comb-platform-test", "comb-platform-dev"],
    Mi = "requestTimes",
    Ni = "downloadTimes",
    Li = function () {
        function e(e) {
            this.collector = e, this.reset();
        }
        return e.prototype.getPlatformByUrl = function (e) {
            var t = [];
            "string" == typeof e && (t = e.split("//"));
            var n = [];
            "string" == typeof t[1] && (n = t[1].split("."));
            var r = n.length ? n[0] : "";
            return Di.indexOf(r) > -1 ? "platformSource" : "gameSource";
        }, e.prototype.add = function (e, t) {
            if (e) {
                this.hadData = !0;
                var n = this.getPlatformByUrl(e);
                this.requestInfo[n][t] += 1;
            }
        }, e.prototype.reset = function () {
            this.hadData = !1, this.requestInfo = {
                platformSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                },
                gameSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                }
            };
        }, e.prototype.getInfo = function () {
            return this.hadData ? this.requestInfo : {
                platformSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                },
                gameSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                }
            };
        }, e;
    }(),
    Ri = function () {
        function e(e) {
            this.collector = e, this.reset();
        }
        return e.prototype.add = function (e) {
            e && (this.hasSocketData = !0, this.socketInfo[e] += 1);
        }, e.prototype.reset = function () {
            this.hasSocketData = !1, this.socketInfo = {
                connectTimes: 0,
                disconnectTimes: 0
            };
        }, e.prototype.getInfo = function () {
            return this.hasSocketData ? this.socketInfo : {
                connectTimes: 0,
                disconnectTimes: 0
            };
        }, e;
    }(),
    qi = {
        Debug: !1,
        ReportDelay: 6e4,
        ErrorReportDelay: 2e3,
        ClearRepeatLog: !0,
        EnabledDownLoadErr: !0,
        EnabledDownLoadPerf: !0,
        EnabledUpLoadErr: !0,
        EnabledUpLoadPerf: !1,
        EnabledConsoleErr: !1,
        EnabledAppOnErr: !0,
        EnabledAppLaunch: !1,
        EnabledPagePerf: !1,
        EnabledResErr: !0,
        EnabledResPerf: !0,
        EnabledSocket: !0,
        EnabledSocketTimes: !0,
        EnabledMemoryWarning: !0,
        EnabledTempFailLog: !1,
        MaxTempFailLogLength: 100,
        Filters: [],
        reportUrlProc: "https://platform-apm.hortorgames.com/apm/api/v1/collect",
        reportUrlDev: "https://platform-apm-test.hortorgames.com/apm/api/v1/collect"
    },
    Hi = {
        Filters: [/\/v1\/statlog$/, /\/v1\/log$/, /\/v1\/log\/multi$/, /apm\/api\/v1\/collect$/]
    },
    Fi = function () {
        function e(e, t) {
            this.logs = [], this.started = !1, this.wx = e, this.config = t, this.reporter = new Ui(this.wx, t),
                this.timeser = new Li(), this.socketTimeser = new Ri();
        }
        return e.prototype.clearReporter = function (e) {
            return e && clearTimeout(e), null;
        }, e.prototype.finalReport = function () {
            var e = this.logs,
                t = this.timeser.getInfo(),
                n = this.socketTimeser.getInfo();
            this.reporter.report({
                    logs: e,
                    times: t,
                    sockets: n
                }, function (e) {}), this.logs = [], this.timeser.reset(), this.socketTimeser.reset(),
                this.errorReporter = this.clearReporter(this.errorReporter), this.fixedReporter = this.clearReporter(this.fixedReporter),
                this.fixedReport();
        }, e.prototype.fixedReport = function () {
            this.fixedReporter = setTimeout(this.finalReport.bind(this), this.config.ReportDelay);
        }, e.prototype.startFixedReport = function () {
            this.started || (this.started = !0, this.fixedReport());
        }, e.prototype.tryReport = function (e) {
            this.checkValid(e) && (this.add(e), this.errorReporter || (this.errorReporter = setTimeout(this.finalReport.bind(this), this.config.ErrorReportDelay)));
        }, e.prototype.collect = function (e) {
            this.checkValid(e) && this.add(e);
        }, e.prototype.checkValid = function (e) {
            return !(!e || e.resURI && e.resURI.startsWith(this.reporter.getReportUrl()) || e.resURI && (this.filters || (this.filters = Hi.Filters || [],
                this.filters = this.filters.concat(this.config.Filters)), this.filters.length && this.filters.some(function (t) {
                return t && t.test && t.test(e.resURI);
            })));
        }, e.prototype.isRepeat = function (e, t) {
            return void 0 === e && (e = {}), void 0 === t && (t = {}), !(!e.id || e.id !== t.id) || !!this.config.ClearRepeatLog && ["resURI", "logType", "extra"].every(function (n) {
                return JSON.stringify(e[n]) == JSON.stringify(t[n]);
            });
        }, e.prototype.add = function (e) {
            var t = this;
            this.logs.some(function (n, r) {
                if (t.isRepeat(e, n)) return (!e.timestamp || e.timestamp > n.timestamp) && (t.logs[r] = e),
                    !0;
            }) || (this.logs.push(e), this.startFixedReport());
        }, e;
    }(),
    ji = 1,
    Vi = ["comb-platform", "comb-platform-test", "comb-platform-dev"],
    Gi = "unc-err",
    Wi = "soc-err",
    Ki = function () {
        function e(e, t) {
            void 0 === t && (t = {}), this.id = ji++, this.logType = e, this.extra = {}, this.collected = !1,
                this.collector = t, this.initTimes();
        }
        return e.prototype.setType = function (e) {
            return this.logType = e, this;
        }, e.prototype.addExtra = function (e) {
            return e.url && (this.resURI = e.url), e.errMsg && !e.msg && (e.msg = e.errMsg),
                this.extra = Object.assign(this.extra, e), this;
        }, e.prototype.updateTimes = function (e) {
            return this.requestInfo = e.requestInfo, this.socketInfo = e.socketInfo, this;
        }, e.prototype.initTimes = function (e) {
            e && "all" != e ? "requestInfo" == e ? this.initRequestInfo() : this.initSocketInfo() : (this.initRequestInfo(),
                this.initSocketInfo());
        }, e.prototype.initRequestInfo = function () {
            this.requestInfo = {
                platformSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                },
                gameSource: {
                    requestTimes: 0,
                    downloadTimes: 0
                }
            };
        }, e.prototype.initSocketInfo = function () {
            this.socketInfo = {
                connectTimes: 0,
                disconnectTimes: 0
            };
        }, e.prototype.addRequestTimes = function (e, t) {
            var n = this.getPlatformByUrl(e);
            this.requestInfo[n][t] += 1;
        }, e.prototype.addSocketTimes = function (e) {
            this.socketInfo[e] += 1;
        }, e.prototype.start = function () {
            return this.startTime = new Date().getTime(), this;
        }, e.prototype.end = function () {
            return this.timestamp = new Date().getTime() - this.startTime, this.timestamp = this.timestamp < 0 ? 0 : this.timestamp,
                this.collect(), this;
        }, e.prototype.collect = function () {
            return this.collected || "function" != typeof this.collector.collect || (this.collected = !0,
                this.collector.collect(this)), this;
        }, e.prototype.tryReport = function () {
            return this.collected || "function" != typeof this.collector.tryReport || (this.collected = !0,
                this.collector.tryReport(this)), this;
        }, e.prototype.toJSON = function () {
            return {
                res: this.resURI,
                type: this.logType,
                ts: this.timestamp,
                ext: this.extra,
                requestInfo: this.requestInfo,
                socketInfo: this.socketInfo
            };
        }, e.prototype.getPlatformByUrl = function (e) {
            var t = [];
            "string" == typeof e && (t = e.split("//"));
            var n = [];
            "string" == typeof t[1] && (n = t[1].split("."));
            var r = n.length ? n[0] : "";
            return Vi.indexOf(r) > -1 ? "platformSource" : "gameSource";
        }, e;
    }(),
    Bi = function () {
        function e(e) {
            var t = e.wx,
                n = e.config,
                r = e.collector;
            this.wx = t, this.config = n, this.collector = r;
        }
        return e.prototype.handle = function () {}, e.prototype.isFun = function (e) {
            return !(!e || "function" != typeof e);
        }, e.prototype.tracker = function (e, t) {
            return void 0 === t && (t = {}), new Ki(e, this.collector).addExtra(t);
        }, e;
    }(),
    zi = function (t) {
        function n(e) {
            return t.call(this, e) || this;
        }
        return e(n, t), n.prototype.handle = function () {
            (this.config.EnabledDownLoadErr || this.config.EnabledDownLoadPerf) && V(this.wx, "downloadFile", this.downloadFileHandler.bind(this));
        }, n.prototype.downloadFileHandler = function (e) {
            var t = this;
            return function (n) {
                var r = t.tracker("", {
                        url: n.url,
                        filePath: n.filePath
                    }).start(),
                    i = function (e) {
                        console.log("[APM] download err", e), t.config.EnabledDownLoadErr && (r.addRequestTimes(n.url, Ni),
                            r.setType("down-err").addExtra(e).end());
                    };
                return e(Object.assign({}, n, {
                    success: function (e) {
                        void 0 === e && (e = {});
                        var o, s = e.statusCode,
                            a = e.header ? e.header["Content-Length"] : 0;
                        200 == s ? (o = {
                            status: s,
                            size: a
                        }, t.config.EnabledDownLoadPerf && (r.addRequestTimes(n.url, Ni), r.setType("down-req").addExtra(o).end())) : i({
                            status: s,
                            err: e.data,
                            size: a
                        }), n.success && n.success.call(this, e);
                    },
                    fail: function (e) {
                        i({
                            err: e
                        }), n.fail && n.fail.call(this, e);
                    }
                }));
            };
        }, n;
    }(Bi),
    Ji = function (t) {
        function n(e) {
            return t.call(this, e) || this;
        }
        return e(n, t), n.prototype.handle = function () {
            (this.config.EnabledResErr || this.config.EnabledResPerf) && V(this.wx, "request", this.requestHandler.bind(this));
        }, n.prototype.requestHandler = function (e) {
            var t = this;
            return function (n) {
                var r = t.tracker("", {
                        url: n.url,
                        method: n.method
                    }).start(),
                    i = function (e) {
                        t.config.EnabledResErr && (r.addRequestTimes(n.url, Mi), r.setType("res-err").addExtra(e).end());
                    };
                return e(Object.assign({}, n, {
                    success: function (e) {
                        void 0 === e && (e = {});
                        var o, s = e.header ? e.header["Content-Length"] : 0,
                            a = e.statusCode;
                        200 == a ? (o = {
                            status: a,
                            size: s
                        }, t.config.EnabledResPerf && (r.addRequestTimes(n.url, Mi), r.setType("res-req").addExtra(o).end())) : i({
                            status: a,
                            err: e.data,
                            size: s
                        }), n.success && n.success.call(this, e);
                    },
                    fail: function (e) {
                        i({
                            err: e
                        }), n.fail && n.fail.call(this, e);
                    }
                }));
            };
        }, n;
    }(Bi),
    Qi = function (t) {
        function n(e) {
            return t.call(this, e) || this;
        }
        return e(n, t), n.prototype.handle = function () {
            (this.config.EnabledUpLoadErr || this.config.EnabledUpLoadPerf) && V(this.wx, "uploadFile", this.uploadFileHandler.bind(this));
        }, n.prototype.uploadFileHandler = function (e) {
            var t = this;
            return function (n) {
                var r = t.tracker("", {
                        url: n.url,
                        filePath: n.method
                    }).start(),
                    i = function (e) {
                        t.config.EnabledUpLoadErr && (r.addRequestTimes(n.url, Mi), r.setType("up-err").addExtra(e).end());
                    };
                return e(Object.assign({}, n, {
                    success: function (e) {
                        void 0 === e && (e = {});
                        var o, s = e.statusCode,
                            a = e.header ? e.header["Content-Length"] : 0;
                        200 == s ? (o = {
                            status: s,
                            size: a
                        }, t.config.EnabledUpLoadPerf && (r.addRequestTimes(n.url, Mi), r.setType("up-req").addExtra(o).end())) : i({
                            status: s,
                            err: e.data,
                            size: a
                        }), n.success && n.success.call(this, e);
                    },
                    fail: function (e) {
                        i({
                            err: e
                        }), n.fail && n.fail.call(this, e);
                    }
                }));
            };
        }, n;
    }(Bi),
    Xi = function (t) {
        function n(e) {
            return t.call(this, e) || this;
        }
        return e(n, t), n.prototype.handle = function () {
            (this.config.EnabledSocket || this.config.EnabledSocketTimes) && V(this.wx, "connectSocket", this.connectSocketHandler.bind(this));
        }, n.prototype.connectSocketHandler = function (e) {
            var t = this;
            return function (n) {
                var r = void 0;
                if (t.config.EnabledSocket) {
                    var i = {
                        url: n.url,
                        method: n.method,
                        protocols: n.protocols
                    };
                    t.log = t.tracker("", i).start(), (r = e(Object.assign({}, n, {
                        success: function (e) {
                            var r;
                            r = {
                                status: 200
                            }, t.log.setType("soc-req").addExtra(r).end(), n.success && n.success.call(this, e);
                        },
                        fail: function (e) {
                            ! function (e) {
                                t.log.setType(Wi).addExtra(e).end();
                            }({
                                err: e
                            }), n.fail && n.fail.call(this, e);
                        }
                    }))) && r.onError(function (e) {
                        ! function (e) {
                            t.tracker(Wi, i).addExtra(e).collect();
                        }({
                            err: e
                        });
                    });
                } else r = e(n);
                return r && t.config.EnabledSocketTimes && (t.log.initTimes("socketInfo"), t.log.addSocketTimes("connectTimes"),
                    r.onClose(function (e) {
                        1e3 !== e.code && (t.log.initTimes("socketInfo"), t.log.addSocketTimes("disconnectTimes"));
                    })), r;
            };
        }, n;
    }(Bi),
    Yi = [];

"function" == typeof wx.onError && wx.onError(G);

var $i = [];

"function" == typeof wx.onUnhandledRejection && wx.onUnhandledRejection(W);

var Zi = function (t) {
        function n(e) {
            return t.call(this, e) || this;
        }
        return e(n, t), n.prototype.handle = function () {
            "undefined" != typeof console && this.config.EnabledConsoleErr && V(console, "error", this.consoleErrorHandler.bind(this)),
                this.wx.onError && this.config.EnabledAppOnErr && (V(this.wx, "onError", this.onErrorhandler.bind(this)),
                    this.bindOnError(), this.wx.offError && V(this.wx, "offError", this.offErrorhandler.bind(this)));
        }, n.prototype.renderErrMsg = function (e) {
            if (void 0 === e && (e = ""), e && "string" != typeof e) return {
                msg: JSON.stringify(e)
            };
            var t = e.split("\n"),
                n = t.slice(0, 2).join("\n"),
                r = t.slice(2),
                i = (r[1] || "").split(":"),
                o = (i.pop() || "").replace(")", "") - 0,
                s = (i.pop() || "") - 0;
            return {
                line: s = isNaN(s) ? 0 : s,
                column: o,
                msg: n,
                stack: r
            };
        }, n.prototype.bindOnError = function () {
            var e = this;
            this.bindedOnError || (this.bindedOnError = !0, Yi.length && (Yi.forEach(function (t) {
                e.handleWXOnError(t);
            }), Yi = []), wx.offError(G), wx.onError(function (t) {
                e.handleWXOnError(t);
            }), "function" == typeof wx.onUnhandledRejection && ($i.length && ($i.forEach(function (t) {
                e.handleWXOnUnhandledRejection(t);
            }), $i = []), wx.offUnhandledRejection(W), wx.onUnhandledRejection(function (t) {
                e.handleWXOnUnhandledRejection(t);
            })));
        }, n.prototype.handleWXOnError = function (e) {
            console.log("[APM] onError error", e);
            var t = this.renderErrMsg(e.message);
            t.stack = e.stack || t.stack, this.tracker(Gi).addExtra(t).tryReport();
        }, n.prototype.handleWXOnUnhandledRejection = function (e) {
            var t, n;
            if (console.log("[APM] onUnhandledRejection error", e), null === (t = null == e ? void 0 : e.reason) || void 0 === t ? void 0 : t.message) {
                var r = this.renderErrMsg("onUnhandledRejection: " + e.reason.message);
                (null === (n = e.reason) || void 0 === n ? void 0 : n.stack) && "function" == typeof e.reason.stack.split && (r.stack = e.reason.stack.split("\n")),
                    this.tracker(Gi).addExtra(r).tryReport();
            }
        }, n.prototype.onErrorhandler = function (e) {
            var t = this;
            return function (n) {
                return t.bindOnError(), e(n);
            };
        }, n.prototype.offErrorhandler = function (e) {
            var t = this;
            return function (n) {
                var r = e(n);
                return n || (t.bindedOnError = !1, t.bindOnError()), r;
            };
        }, n.prototype.consoleErrorHandler = function (e) {
            var t = this;
            return function () {
                for (var n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
                return function (e) {
                    void 0 === e && (e = {});
                    var n = t.renderErrMsg(e[0]);
                    t.tracker(Gi).addExtra(n).tryReport();
                }(n), e.apply(void 0, n);
            };
        }, n;
    }(Bi),
    eo = function (t) {
        function n(e) {
            var n = t.call(this, e) || this;
            return n.bindTimes = 0, n.reported = !1, n;
        }
        return e(n, t), n.prototype.handle = function () {
            this.isFun(this.wx.onMemoryWarning) && this.config.EnabledMemoryWarning && (V(this.wx, "onMemoryWarning", this.memoryWranHandler.bind(this)),
                this.firstBind());
        }, n.prototype.firstBind = function () {
            this.wx.onMemoryWarning(function (e) {});
        }, n.prototype.report = function (e, t) {
            this.reported || t != this.bindTimes || (this.tracker("mem-warn").addExtra(e || {}).collect(),
                this.reported = !0);
        }, n.prototype.memoryWranHandler = function (e) {
            var t = this;
            return function (n) {
                var r = ++t.bindTimes;
                return e(function (e) {
                    t.report(e, r), t.isFun(n) && n(e);
                });
            };
        }, n;
    }(Bi),
    to = function () {
        function e(e, t) {
            this.wx = e, this.config = t, this.collector = new Fi(e, t);
            var n = {
                wx: e,
                config: t,
                collector: this.collector
            };
            this.handlers = [new Xi(n), new Zi(n), new Ji(n), new zi(n), new Qi(n), new eo(n)];
        }
        return e.prototype.track = function () {
            return this.handlers.forEach(function (e) {
                e.handle();
            }), this;
        }, e.prototype.tracker = function (e, t) {
            return void 0 === t && (t = {}), new Ki(e, this.collector).addExtra(t);
        }, e.prototype.setUserInfo = function (e) {
            this.collector && this.collector.reporter.setUserInfo(e);
        }, e;
    }(),
    no = {
        version: "1.9.0",
        date: 1601443721480,
        mode: "dev"
    },
    ro = new(function () {
        function e() {}
        return e.prototype.init = function (e) {
            var t = Object.assign({}, e);
            t.Debug = !t.env || "Prod" !== t.env || t.Debug, this.wxTracker = new to(wx, Object.assign({}, qi, no, t)).track();
        }, e.prototype.notify = function (e) {
            var t = e.msg,
                n = e.data;
            return this.wxTracker ? this.wxTracker.tracker("game-notice", Object.assign({
                msg: t
            }, n)).collect() : {
                errMsg: "please init apm first"
            };
        }, e.prototype.notifyError = function (e) {
            var t = e.msg,
                n = e.data;
            return this.notify({
                msg: t,
                data: n
            });
        }, e.prototype.newTracker = function (e) {
            var t = e.msg,
                n = e.data;
            return this.wxTracker ? this.wxTracker.tracker("game-track", Object.assign({
                msg: t
            }, n)) : {
                errMsg: "please init apm first"
            };
        }, e.prototype.setUserInfo = function (e) {
            this.wxTracker && this.wxTracker.setUserInfo(e);
        }, e;
    }())();

Zt.once(Rt, function () {
    var e = D();
    ro.init(e);
}), Zt.on(Vt, function (e) {
    var t, n;
    ro.setUserInfo({
        userId: null === (n = null === (t = null == e ? void 0 : e.data) || void 0 === t ? void 0 : t.userSdk) || void 0 === n ? void 0 : n.uniqueId
    });
});

var io = ro,
    oo = "sdk_share",
    so = "sdk_video_ad_show",
    ao = "track",
    co = "user_set",
    uo = 2,
    lo = 4,
    fo = {
        INIT: {
            topic: "",
            eventType: ao,
            eventName: "sdk_init",
            logType: uo
        },
        LOGIN: {
            topic: "",
            eventType: ao,
            eventName: "sdk_login",
            logType: uo
        },
        AUTH: {
            topic: "",
            eventType: co,
            eventName: "sdk_auth",
            logType: lo
        },
        OPEN: {
            topic: "",
            eventType: ao,
            eventName: "sdk_open",
            logType: lo
        },
        CLOSE: {
            topic: "",
            eventType: ao,
            eventName: "sdk_close",
            logType: lo
        },
        SHARE: {
            topic: "",
            eventType: ao,
            eventName: oo,
            logType: uo
        },
        SHARE_END: {
            topic: "",
            eventType: ao,
            eventName: oo,
            logType: uo | lo
        },
        VIDEO_AD_SHOW: {
            topic: "",
            eventType: ao,
            eventName: so,
            logType: uo
        },
        VIDEO_AD_END: {
            topic: "",
            eventType: ao,
            eventName: so,
            logType: uo | lo
        },
        BEAT: {
            topic: "",
            eventType: ao,
            eventName: "sdk_heartbeat",
            logType: lo
        },
        PROFILE: {
            topic: "",
            eventType: co,
            eventName: "sdk_user_profile",
            logType: lo
        },
        SET_USER_INFO: {
            topic: "",
            eventType: co,
            eventName: "wx_game_role",
            logType: lo
        },
        SHARE_FRIEND: {
            topic: "",
            eventType: ao,
            eventName: "sdk_share_to_friend",
            logType: uo
        }
    },
    ho = {};

Object.keys(fo).map(function (e) {
    ho[e] = e, fo[e].topic = e;
});

var go, po = fo,
    mo = ho;

! function () {
    t(this, void 0, void 0, function () {
        var e;
        return n(this, function (t) {
            switch (t.label) {
                case 0:
                    return [4, f()];

                case 1:
                    return e = t.sent(), go = e.networkType, [2];
            }
        });
    });
}();

var vo = {
        getCommonData: function () {
            return t(this, void 0, void 0, function () {
                var e;
                return n(this, function (t) {
                    switch (t.label) {
                        case 0:
                            return this.baseData || (this.baseData = this._getBaseData()), [4, this._getChangeData()];

                        case 1:
                            return (e = t.sent()).clientInfo = Object.assign({}, this.baseData ? this.baseData.clientInfo : {}, e.clientInfo || {}),
                                [2, Object.assign({}, this.baseData, e)];
                    }
                });
            });
        },
        getLogDataByTopic: function (e, t) {
            switch (e) {
                case po.OPEN.topic:
                    return this._getOpenData(t);

                case po.AUTH.topic:
                    return this._getAuthData(t);

                case po.SHARE.topic:
                    return this._getShareData(t);

                case po.SHARE_END.topic:
                    return this._getShareEndData(t);

                case po.VIDEO_AD_SHOW.topic:
                    return this._getVideoAdPlayData(t);

                case po.VIDEO_AD_END.topic:
                    return this._getVideoAdEndData(t);

                case po.LOGIN.topic:
                    return this._getLoginData(t);

                case po.BEAT.topic:
                    return this._getHeartbeatData(t);

                case po.PROFILE.topic:
                    return this._getUserProfileData(t);

                case po.SET_USER_INFO.topic:
                    return this._getGameUserData(t);

                default:
                    return this._getBasicData(t);
            }
        },
        refreshDataByTopic: function (e, t) {
            return e === po.OPEN.topic ? this._refreshOpenData(t) : t;
        },
        _getBaseData: function () {
            var e = D(),
                t = e.gameId,
                n = e.gameVersion,
                r = d();
            return {
                gameId: t,
                gameVersion: n,
                logSource: "mini-sdk",
                clientInfo: {
                    clientType: "weixin",
                    version: r.version,
                    language: r.language,
                    model: r.model,
                    system: r.system,
                    brand: r.brand,
                    pixelRatio: r.pixelRatio,
                    screenWidth: r.screenWidth,
                    screenHeight: r.screenHeight,
                    platform: r.platform,
                    sdkVersion: r.SDKVersion,
                    hsdkVersion: r.hortorSDKVersion
                }
            };
        },
        _getChangeData: function () {
            return t(this, void 0, void 0, function () {
                var e, t, r, i, o, s, a, c;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return e = function () {
                                    var e = D(),
                                        t = e.gameId + "_" + e.env + "_tgaDistinctId",
                                        n = Bn.getStorage(t);
                                    return n || (n = yn.generateGuid(), Bn.setStorage(t, n)), n;
                                }(), t = Mr.getSDKUserInfo() || {}, r = t.uniqueId, i = t.userId, o = t.channel,
                                s = t.gameUser, a = void 0 === s ? {} : s, [4, f()];

                        case 1:
                            return c = n.sent().networkType, [2, {
                                distinctId: e,
                                platformId: r,
                                openId: i,
                                channel: o,
                                clientInfo: {
                                    netType: go = c
                                },
                                accountId: a.accountId || ""
                            }];
                    }
                });
            });
        },
        _pkg: function (e, t) {
            return {
                property: e,
                extra: t
            };
        },
        _getBasicData: function (e) {
            var t, n, r = e || {},
                i = r.extend;
            if ("track" === r.eventType) {
                var o = d(),
                    s = D(),
                    a = U() || {},
                    c = a.scene,
                    u = a.query,
                    l = void 0 === u ? {} : u,
                    f = (o.platform || "").toLowerCase(),
                    h = (go || "WIFI").toUpperCase(),
                    g = Mr.getSDKUserInfo() || {},
                    p = g.channel;
                i = Object.assign({
                    "#scene": c || 0,
                    "#os": {
                        android: "Android",
                        ios: "iOS",
                        devtools: "devtools"
                    } [f] || f || "",
                    "#os_version": (null == o ? void 0 : o.system.split(" ")[1]) || "",
                    "#screen_height": o.screenHeight || 0,
                    "#network_type": h,
                    "#lib": "weixin",
                    "#lib_version": "1.9.0",
                    "#device_model": o.model,
                    "#manufacturer": o.brand,
                    "#system_language": o.language,
                    sdk_time: T(),
                    sdk_client: "minigame",
                    hsdk_version: "1.9.0",
                    client_versioin: o.version,
                    sdk_client_version: o.version,
                    app_sdk_version: o.SDKVersion,
                    game_version: s.gameVersion,
                    sdk_first_channel: p,
                    sdk_current_channel: l.channel || "hortor",
                    game_channel: p,
                    game_origin_channel: l.channel || "hortor",
                    idfa: "",
                    trackplatform: "sdk_frontend"
                }, i || {}), (null === (n = null === (t = null == o ? void 0 : o.model) || void 0 === t ? void 0 : t.toLowerCase()) || void 0 === n ? void 0 : n.includes("ipad")) ? i.sdk_is_ipad = !0 : i.sdk_is_ipad = !1;
            }
            return this._pkg(null, i);
        },
        _getShareData: function (e) {
            var t = e || {},
                n = t.extend,
                r = t.wx_share_type;
            return this._pkg({
                event_step: "begin",
                wx_share_type: r
            }, n);
        },
        _getShareEndData: function (e) {
            var t = e || {},
                n = t.shareData,
                r = t.shareSuccess,
                i = t.spentTime,
                o = t.extend,
                s = t.wx_share_type,
                a = n || {},
                c = a.title,
                u = a.imageUrl,
                d = a.shareType,
                l = a.shareConfigId,
                f = a.shareGuid,
                h = (a.sequenceInfo || {}).modelId;
            return this._pkg({
                share_guid: f || "",
                share_content_id: l || "",
                share_content_title: c || "",
                share_content_img: u || "",
                share_content_type: d || "",
                share_use_time: i || 0,
                event_state: r ? 0 : 1,
                event_step: r ? "suc" : "fail",
                model_algorithm_id: h || "",
                wx_share_type: s
            }, o);
        },
        _getVideoAdPlayData: function (e) {
            var t = e || {},
                n = t.adUnitId,
                r = t.playSuccess,
                i = t.extend;
            return this._pkg({
                ad_id: n || "",
                event_step: r ? "suc" : "begin"
            }, i);
        },
        _getVideoAdEndData: function (e) {
            var t = e || {},
                n = t.adUnitId,
                r = t.isEnded,
                i = t.playFailCode,
                o = t.spentTime,
                s = t.sequenceInfo,
                a = t.extend,
                c = t.adType,
                u = s || {},
                d = u.modelId,
                l = u.shareGuid,
                f = void 0 === r ? -1 : r ? 0 : 1,
                h = i ? 1004 === i || 1002 === i ? 2 : 1 : 0 === i ? 0 : 1;
            return this._pkg({
                ad_id: n || "",
                event_state: h,
                ad_close_type: f,
                ad_show_time: o || 0,
                event_step: h ? "fail" : f > 0 ? "abort" : "complete",
                model_algorithm_id: d || "",
                share_guid: l || "",
                ad_type: c || 0
            }, a);
        },
        _getGameUserData: function (e) {
            var t = (U() || {}).query,
                n = "toNumber",
                r = "toNStr",
                i = {
                    roleId: r,
                    roleName: r,
                    serverId: r,
                    level: n,
                    vipLevel: n,
                    energy: n,
                    money1Consume: n,
                    teamName: r,
                    teamJob: r,
                    roleCtime: n,
                    id: r,
                    wxUnionId: r,
                    extend: "",
                    accountId: r
                },
                o = {
                    query_string: JSON.stringify(t)
                },
                s = (e || {}).extend;
            return Object.keys(i).map(function (t) {
                var n = e[t],
                    r = i[t];
                if (r) {
                    var s = "user_" + yn.toLine(t);
                    o[s] = yn[r](n);
                }
            }), this._pkg(o, s);
        },
        _getAuthData: function (e) {
            var t = Mr.getSDKUserInfo() || {},
                n = t.name,
                r = t.sex,
                i = ((U() || {}).query || {}).share_guid,
                o = e || {},
                s = o.gender,
                a = void 0 === s ? r : s,
                c = o.nickName,
                u = void 0 === c ? n : c,
                d = o.extend;
            return this._pkg({
                gender: a || 0,
                nick: u || "",
                share_guid: i || ""
            }, d);
        },
        _getOpenData: function (e) {
            var t = Mr.getSDKUserInfo() || {},
                n = t.isNewUser,
                r = t.createdAt;
            n && (i("change local isNewUser to false"), Mr.updateIsNewUser());
            var o = U() || {},
                s = o.query,
                a = o.scene,
                c = o.coldStart,
                u = o.referrerInfo,
                d = (s || {}).share_guid,
                l = e || {},
                f = l.isColdStart,
                h = void 0 === f ? !!c : f,
                g = l.isNewUser,
                p = void 0 === g ? n : g,
                m = l.extend,
                v = Object.assign(s, {
                    referrerInfo: u
                }),
                y = this._pkg({
                    is_new_user: p ? 0 : 1,
                    open_type: h ? 0 : 1,
                    source_type: a || 0,
                    share_guid: d || "",
                    query_string: JSON.stringify(v),
                    reg_time: r
                }, m);
            return i("onShowReport", y), y;
        },
        _getUserProfileData: function (e) {
            var t = e || {},
                n = t.label,
                r = t.extend;
            return this._pkg({
                wx_tags_general: n || 0
            }, r);
        },
        _getHeartbeatData: function (e) {
            var t = (e || {}).interval;
            return this._pkg({
                interval: t || 60
            });
        },
        _getLoginData: function (e) {
            var t = (Mr.getSDKUserInfo() || {}).isNewUser,
                n = U() || {},
                r = n.query,
                i = n.scene,
                o = (r || {}).shareConfigId,
                s = e || {},
                a = s.isNewUser,
                c = void 0 === a ? t : a,
                u = s.extend,
                d = this._getBasicData({
                    eventType: "track"
                });
            return u = Object.assign(d.extra || {}, u || {}), this._pkg({
                is_new: c,
                f_share_id: o,
                wx_scene: i
            }, u);
        },
        _refreshOpenData: function (e) {
            var t = Mr.getSDKUserInfo() || {},
                n = t.isNewUser,
                r = t.createdAt;
            return e && e.property && (e.property.is_new_user = n ? 0 : 1, e.property.reg_time = r),
                e;
        }
    },
    yo = "scope.userInfo",
    wo = u("createUserInfoButton", "2.0.1"),
    Io = null,
    _o = function (e) {
        return new Promise(function (t, n) {
            wx.showModal(Object.assign({
                success: t,
                fail: n
            }, e));
        });
    },
    So = function () {
        function e() {}
        return e.decode = function (e, t, n, r, i) {
            var o = t,
                s = this.transCode(o, n),
                a = this.getKey(s, r);
            return this.crypto(e, a, a.length >> i);
        }, e.encode = function (e, t, n, r, i) {
            return this.decode(e, t, n, r, i);
        }, e.crypto = function (e, t, n) {
            if (null != e && null != t) {
                for (var r = "", i = 0; i < e.length; i++) n >= t.length && (n = 0), r += String.fromCharCode(e[i].charCodeAt(0) ^ t[n].charCodeAt(0)),
                    n++;
                return r;
            }
            return null;
        }, e.getKey = function (e, t) {
            for (var n = e, r = "", i = Math.floor(e.length / t), o = 0; o < i; o++) r += n[o * t];
            return r;
        }, e.transCode = function (e, t) {
            if (t > 0) {
                t--;
                var n = this.rightSide(e),
                    r = this.leftSide(e);
                return this.transCode(n, t) + this.transCode(r, t);
            }
            return e;
        }, e.swap = function (e) {
            return this.rightSide(e) + this.leftSide(e);
        }, e.rightSide = function (e) {
            return e.length % 2 != 0 ? null : e.substring(e.length / 2, e.length);
        }, e.leftSide = function (e) {
            return e.length % 2 != 0 ? null : e.substring(0, e.length / 2);
        }, e;
    }(),
    To = "function" == typeof btoa,
    bo = "function" == typeof Buffer;

"function" == typeof TextDecoder && new TextDecoder();

var Co, xo = "function" == typeof TextEncoder ? new TextEncoder() : void 0,
    ko = Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");

Co = {}, ko.forEach(function (e, t) {
    return Co[e] = t;
});

var Oo = String.fromCharCode.bind(String);

"function" == typeof Uint8Array.from && Uint8Array.from.bind(Uint8Array);

var Po, Eo = To ? function (e) {
        return btoa(e);
    } : bo ? function (e) {
        return Buffer.from(e, "binary").toString("base64");
    } : function (e) {
        for (var t, n, r, i, o = "", s = e.length % 3, a = 0; a < e.length;) {
            if ((n = e.charCodeAt(a++)) > 255 || (r = e.charCodeAt(a++)) > 255 || (i = e.charCodeAt(a++)) > 255) throw new TypeError("invalid character found");
            o += ko[(t = n << 16 | r << 8 | i) >> 18 & 63] + ko[t >> 12 & 63] + ko[t >> 6 & 63] + ko[63 & t];
        }
        return s ? o.slice(0, s - 3) + "===".substring(s) : o;
    },
    Ao = bo ? function (e) {
        return Buffer.from(e).toString("base64");
    } : function (e) {
        for (var t = [], n = 0, r = e.length; n < r; n += 4096) t.push(Oo.apply(null, e.subarray(n, n + 4096)));
        return Eo(t.join(""));
    },
    Uo = function (e) {
        if (e.length < 2) return (t = e.charCodeAt(0)) < 128 ? e : t < 2048 ? Oo(192 | t >>> 6) + Oo(128 | 63 & t) : Oo(224 | t >>> 12 & 15) + Oo(128 | t >>> 6 & 63) + Oo(128 | 63 & t);
        var t = 65536 + 1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320);
        return Oo(240 | t >>> 18 & 7) + Oo(128 | t >>> 12 & 63) + Oo(128 | t >>> 6 & 63) + Oo(128 | 63 & t);
    },
    Do = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,
    Mo = bo ? function (e) {
        return Buffer.from(e, "utf8").toString("base64");
    } : xo ? function (e) {
        return Ao(xo.encode(e));
    } : function (e) {
        return Eo(e.replace(Do, Uo));
    },
    No = function (e, t) {
        return void 0 === t && (t = !1), t ? function (e) {
            return e.replace(/=/g, "").replace(/[+\/]/g, function (e) {
                return "+" == e ? "-" : "_";
            });
        }(Mo(e)) : Mo(e);
    },
    Lo = !1,
    Ro = !1,
    qo = null,
    Ho = null,
    Fo = null,
    jo = {
        roleId: ""
    },
    Vo = !1;

he({
    listener: function () {
        Vo = !0;
    }
});

var Go = {
        temps: void 0,
        report: function (e) {
            var t = this._getTempLogs(e && e.logs);
            if (Vo && this._clearTempLogs(), t && t.length) {
                var n = U().query;
                t.forEach(function (e) {
                    e.queryRaw = JSON.stringify(n);
                });
                var r = tn.logHost + "/htlog/api/v1/log/comb";
                if (t = this._sortByTimeStamp(t), D().isGameTGALogUseRoleId) {
                    var i = [],
                        o = [];
                    if (t.forEach(function (e) {
                            var t;
                            "game_c" === (null === (t = null == e ? void 0 : e.extra) || void 0 === t ? void 0 : t.sdk_trackplatform) ? i.push(e): o.push(e);
                        }), i.length) {
                        i = this._sortByTimeStamp(i);
                        var s = Object.assign({}, e, {
                            logs: i,
                            gameTp: "minigame"
                        });
                        s.platformId = jo.roleId, s.accountId = "", bn.post(r, s).then(function () {}).catch(function () {});
                    }
                    if (o.length) {
                        o = this._sortByTimeStamp(o);
                        var a = Object.assign({}, e, {
                            logs: o,
                            gameTp: "minigame"
                        });
                        a.accountId = "", bn.post(r, a).then(function () {}).catch(function () {});
                    }
                } else {
                    var c = Object.assign({}, e, {
                        logs: t,
                        gameTp: "minigame"
                    });
                    bn.post(r, c).then(function () {}).catch(function () {});
                }
            }
        },
        _sortByTimeStamp: function (e) {
            return e.sort(function (e, t) {
                return (null == e ? void 0 : e.timestamp) && (null == t ? void 0 : t.timestamp) ? e.timestamp - t.timestamp : 1;
            });
        },
        _getTempLogs: function (e) {
            return void 0 === this.temps && Vo && (this.temps = Cn.get(zn)), this._limitLogs((this.temps || []).concat(e || []));
        },
        _setTempLogs: function (e) {
            e.forEach(function (e) {
                e.extra && (e.extra.sdk_is_from_storage = 1);
            }), this.temps = this._limitLogs(e), Cn.set(zn, this.temps);
        },
        _clearTempLogs: function () {
            this.temps = [], Cn.set(zn, "");
        },
        _limitLogs: function (e) {
            var t = (e ? e.length : 0) - 50;
            return (e || []).slice(t > 0 ? t : 0);
        }
    },
    Wo = {
        lastLog: {},
        logs: [],
        reporting: !1,
        delayCollect: 800,
        delayReport: 5e3,
        collect: function (e) {
            if (e) {
                var t = e.topic;
                if (t) {
                    var n = this.lastLog[t],
                        r = n && !n.fromPlatform ? n : e;
                    0 === ((n || {}).params || {}).open_type && (r.params.open_type = 0), this.lastLog[t] = r,
                        n || setTimeout(this._reduceLog.bind(this, t), this.delayCollect);
                } else this._reportLog(e);
            }
        },
        _reportLog: function (e) {
            var t = e || {},
                n = t.immediateReport,
                r = t.params;
            r && (this.logs.push(r), this._report(n).catch(function () {}));
        },
        _reduceLog: function (e) {
            var t = this.lastLog[e];
            t && (this._reportLog(t), this.lastLog[e] = null);
        },
        _report: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return e ? [3, 2] : this.reporting ? [2] : (this.reporting = !0, [4, yn.wait(this.delayReport)]);

                        case 1:
                            n.sent(), this.reporting = !1, n.label = 2;

                        case 2:
                            return [4, vo.getCommonData()];

                        case 3:
                            return t = n.sent(), r = this.logs, Go.report(Et(Et({}, t), {
                                logs: r
                            })), this.logs = [], [2];
                    }
                });
            });
        }
    };

ge.prototype = {
    _init: function (e) {
        var t = {
            immediateReport: !1,
            stopWhenShare: !1,
            callAfterLogin: !1
        };
        switch (this.topic) {
            case po.CLOSE.topic:
                t.stopWhenShare = !0, t.immediateReport = !0;
                break;

            case po.OPEN.topic:
                t.stopWhenShare = !0, t.callAfterLogin = this.fromPlatform;
        }
        this.config = t, this.data = {}, this.createAt = yn.getTime(), this._setData(e);
    },
    getConfig: function () {
        return this.config;
    },
    start: function () {
        this.startTime = yn.getTime();
    },
    stop: function (e) {
        e && (e.spentTime = this.startTime ? Math.max(0, yn.getTime() - this.startTime) : 0),
            this._setData(e);
    },
    refreshData: function () {
        return this.data = vo.refreshDataByTopic(this.topic, this.data), this;
    },
    _setData: function (e) {
        var t = vo.getLogDataByTopic(this.topic, e),
            n = t.property,
            r = t.extra,
            i = this.data,
            o = i.property,
            s = i.extra;
        return n && (this.data.property = Object.assign(o || {}, n)), r && (this.data.extra = Object.assign(s || {}, r)),
            this;
    },
    _getData: function () {
        var e = this.opt,
            t = e.eventName,
            n = e.eventType,
            r = e.logType;
        return Object.assign({}, this.data, {
            logId: this.guid,
            logType: r,
            eventType: n,
            eventName: t,
            timestamp: this.createAt || 0
        });
    },
    toLogData: function () {
        var e = this._getData(),
            t = this.getConfig().immediateReport;
        return {
            topic: this.topic,
            fromPlatform: this.fromPlatform,
            immediateReport: t,
            params: e
        };
    }
};

var Ko = {},
    Bo = {
        setState: function (e, t) {
            Ko[e] = t;
        },
        getState: function (e) {
            return !!Ko[e];
        }
    },
    zo = [];

! function () {
    Zt.once(Rt, pe.bind(this));
}();

var Jo, Qo = {},
    Xo = "invalid ad id in gm-v2",
    Yo = {},
    $o = {},
    Zo = {
        _canUseNavigate: u("navigateToMiniProgram", "2.2.0"),
        navigateToMiniProgram: function (e, t) {
            var n = this;
            return new Promise(function (r, i) {
                if (!n._canUseNavigate) return t ? r(n.previewImage(t)) : i(or);
                var o = Object.assign({}, e, {
                    success: r,
                    fail: function (e) {
                        var o = (e || {}).errMsg;
                        if ((void 0 === o ? "" : o).indexOf("cancel") > -1) e.isCancel = !0;
                        else if (t) return r(n.previewImage(t));
                        i(e || or);
                    }
                });
                wx.navigateToMiniProgram(o);
            });
        },
        previewImage: function (e) {
            return new Promise(function (t, n) {
                if (!e) return n(or);
                wx.previewImage({
                    current: e,
                    urls: [e],
                    success: t,
                    fail: n
                });
            });
        }
    },
    es = {
        _canUseCustomer: u("openCustomerServiceConversation", "2.0.3"),
        openCustomerServiceConversation: function (e) {
            var t = this;
            return new Promise(function (n, r) {
                t._canUseCustomer ? wx.openCustomerServiceConversation(Object.assign({}, e, {
                    success: n,
                    fail: r
                })) : r(ir);
            });
        }
    },
    ts = {
        _getAppInfo: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s, a, c;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            if (this.jumpInfo) return [2, this.jumpInfo];
                            if (t = D().gameId, r = Mr.getSDKUserInfo() || {}, i = r.uniqueId, o = r.channel,
                                !(s = Object.assign({}, e || {}, {
                                    fromGameId: t,
                                    fromUserId: i,
                                    channel: o
                                })).fromUserId) throw sr;
                            return a = tn.combHost + "/sdk/conf/api/v1/customer/get", [4, bn.get(a, s)];

                        case 1:
                            return c = n.sent().data, this.jumpInfo = c || {}, [2, c];
                    }
                });
            });
        },
        goCustomer: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return [4, this._getAppInfo(e)];

                        case 1:
                            return t = n.sent(), [4, Zo.navigateToMiniProgram(t, t.url)];

                        case 2:
                            return n.sent(), [2];
                    }
                });
            });
        },
        openCustomer: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 3, , 4]), null == e.customerData || e.customerData.constructor !== Object ? [3, 2] : [4, this._getAppInfo(e.customerData)];

                        case 1:
                            t = n.sent(), e.sessionFrom = No(t.path + "&eventName=customer"), e.showMessageCard = !1,
                                n.label = 2;

                        case 2:
                            return i("jump customer data:", e), [2, es.openCustomerServiceConversation(e)];

                        case 3:
                            return [2, n.sent()];

                        case 4:
                            return [2];
                    }
                });
            });
        }
    },
    ns = function (e) {
        return new Promise(function (t, n) {
            wx.requestMidasPayment(Object.assign({}, e, {
                success: t,
                fail: n
            }));
        });
    },
    rs = function (e) {
        e.layer = cc.Layers.Enum.UI_2D;
    },
    is = function (e, t) {
        e.setContentSize(t);
    },
    os = function (e, t) {
        var n = e.addComponent("cc.Widget");
        return null != t.top && (n.top = t.top, n.isAlignTop = !0), null != t.bottom && (n.bottom = t.bottom,
                n.isAlignBottom = !0), null != t.right && (n.right = t.right, n.isAlignRight = !0),
            null != t.left && (n.left = t.left, n.isAlignLeft = !0), null != t.isHorizontal && (n.isAlignHorizontalCenter = !0),
            null != t.isVertical && (n.isAlignVerticalCenter = !0), n;
    },
    ss = function (e) {
        return e.getComponent("cc.UITransform") || e.getComponent("cc.UITransformComponent");
    },
    as = null,
    cs = 1,
    us = 2,
    ds = 3,
    ls = "",
    fs = 0;

ze.prototype = {
    _init: function () {
        var e = this.opt,
            t = e.list,
            n = e.lastIndex,
            r = e.weightCount;
        if (t && t.length) {
            this.lastIndex = "number" == typeof n ? n : -1;
            var i = 0;
            "number" == typeof r ? i = r : t.map(function (e) {
                var t = e.weight;
                i += (void 0 === t ? 0 : t) - 0;
            }), 0 === i && (this.allZero = !0, i = t.length * this.unitWeight), this.allWeight = i;
        }
    },
    _setLastIndex: function (e) {
        this.lastIndex = e;
    },
    _getLastIndex: function () {
        return this.lastIndex;
    },
    _getRandomIndex: function () {
        var e = this,
            t = this.opt.list,
            n = Math.floor(Math.random() * this.allWeight),
            r = 0;
        return t.findIndex(function (t) {
            var i = e.allZero ? e.unitWeight : t.weight,
                o = !!(r <= n && n < r + i);
            return o || (r += i), o;
        });
    },
    _getUniqueIndex: function () {
        var e = this._getLastIndex(),
            t = this._getRandomIndex();
        return t !== e ? (this._setLastIndex(t), t) : this._getUniqueIndex();
    },
    getIndex: function () {
        var e = -1;
        switch (this.opt.list.length) {
            case 0:
                e = -1;
                break;

            case 1:
                e = 0;
                break;

            default:
                e = this._getUniqueIndex();
        }
        return e;
    },
    getData: function () {
        var e = (this.opt || {}).list;
        return (void 0 === e ? [] : e)[this.getIndex()];
    }
};

var hs = {
        _renderQuery: function (e) {
            var t = e || {},
                n = t.query,
                r = t.shareConfigId,
                i = t.activityId,
                o = t.shareGuid,
                s = yn.getTimeSec(),
                a = Mr.getSDKUserInfo() || {},
                c = a.h_shareCode,
                u = void 0 === c ? "" : c,
                d = a.channel,
                l = void 0 === d ? "hortor_" : d,
                f = a.origChannel,
                h = void 0 === f ? "" : f,
                g = {
                    channel: yn.endsWith(l, "_") ? l : l + "_",
                    h_shareCode: u,
                    timestamp: s,
                    origChannel: h,
                    shareConfigId: r,
                    activityId: i,
                    share_guid: o,
                    activityKey: Ss
                };
            return yn.addToQuery(n, g);
        },
        _renderTitle: function (e) {
            var t = e || {},
                n = t.title,
                r = t.titleParams;
            return n ? (r && "object" == (void 0 === r ? "undefined" : Ot(r)) && Object.keys(r).forEach(function (e) {
                if (new RegExp("({{" + e + "}})").test(n)) {
                    var t = r[e] + "";
                    n = n.replace(RegExp.$1, t);
                }
            }), n = n.replace(/({{[-\w]*}})/g, "")) : "";
        },
        _renderImageUrl: function (e) {
            var t = e || {},
                n = t.imageUrl,
                r = t.imageParams;
            return n ? (r && "object" == (void 0 === r ? "undefined" : Ot(r)) && Object.keys(r).forEach(function (e) {
                if (new RegExp("({{" + e + "}})").test(n)) {
                    var t = r[e] + "";
                    n = n.replace(RegExp.$1, t);
                }
            }), n = n.replace(/({{[-\w]*}})/g, "")) : "";
        },
        _renderShareGuid: function (e) {
            var t = e || {},
                n = t.query,
                r = t.shareGuid,
                i = void 0 === r ? "" : r,
                o = (t.sequenceInfo || {}).shareGuid;
            if (!yn.isEmpty(o)) return o;
            if (!yn.isEmpty(i)) return i;
            var s = yn.queryToJson(n);
            return yn.isEmpty(s.share_guid) ? yn.generateGuid() : s.share_guid;
        },
        _renderForceResult: function (e) {
            return ((e || {}).sequenceInfo || {}).forceResult;
        },
        _renderShareId: function (e) {
            var t = e || {},
                n = t.id,
                r = t.query;
            return n || yn.queryToJson(r).shareConfigId || "";
        },
        renderShare: function (e, t) {
            var n = (e || {}).beforeShare,
                r = yn.isFun(n) ? n(t) : null,
                i = Object.assign({}, t || {}, e || {}, r || {});
            return i.shareConfigId = this._renderShareId(i), i.title = this._renderTitle(i),
                i.imageUrl = this._renderImageUrl(i), i.shareGuid = this._renderShareGuid(i), i.query = this._renderQuery(i),
                i.forceResult = this._renderForceResult(i), yn.copy(i, ["id", "gameID", "beforeShare", "success", "fail", "complete"]);
        },
        renderShareThemes: function (e) {
            if (!e || !e.length) return {};
            var t = {},
                n = {};
            for (var r in e.map(function (e) {
                    t[e.type] = t[e.type] || [], t[e.type].push(e);
                }), t) n[r] = new ze({
                list: t[r]
            });
            return n;
        },
        renderPostParams: function (e) {
            var t = e || {},
                n = t.shareConfigId;
            return {
                shareConfigId: void 0 === n ? "" : n,
                customShareType: t.shareType,
                activityId: t.activityId,
                content: yn.copy(e, ["activityId", "shareType", "shareConfigId"])
            };
        }
    },
    gs = u("updateShareMenu", "1.2.0"),
    ps = u("updateShareMenu", "2.4.0"),
    ms = {
        set: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return r = (t = e || {}).activityId, i = t.templateInfo, [4, Qe({
                                withShareTicket: !0,
                                isUpdatableMessage: !0,
                                activityId: r,
                                templateInfo: void 0 === i ? {} : i
                            })];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        },
        clear: function () {
            return t(this, void 0, void 0, function () {
                return n(this, function (e) {
                    switch (e.label) {
                        case 0:
                            return [4, yn.wait(1)];

                        case 1:
                            return e.sent(), [4, Qe({
                                withShareTicket: !0,
                                isUpdatableMessage: !1,
                                templateInfo: {}
                            })];

                        case 2:
                            return [2, e.sent()];
                    }
                });
            });
        }
    };

Xe.prototype = {
    init: function (e) {
        if (!this.inited) {
            this.inited = !0;
            var t = e || {},
                n = t.forceResult,
                r = t.shareSuccessDiff,
                i = t.onShareCallbackTime,
                o = t.success,
                s = t.fail,
                a = t.complete;
            this.successDiff = r || 2e3, this.onCallbackTime = i || 500, this.forceResult = n,
                this.showEnv = this.onShow.bind(this, {
                    success: o,
                    fail: s,
                    complete: a
                }), this._bind();
        }
    },
    _bind: function () {},
    _unbind: function () {},
    onShow: function (e, t) {
        if (!this.destroyed) {
            var n = e || {},
                r = n.success,
                i = n.fail,
                o = n.complete,
                s = ((t || {}).data || {}).hideDuration;
            this._check(s || 0).then(function (e) {
                o && yn.isFun(o) && o(e), yn.isFun(r) && r(e);
            }).catch(function (e) {
                o && yn.isFun(o) && o(e), yn.isFun(i) && i(e);
            });
        }
    },
    _check: function (e) {
        return t(this, void 0, void 0, function () {
            var t, r;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        return yn.getTime(), t = this.successDiff, this.destroy(), [4, yn.wait(this.onCallbackTime)];

                    case 1:
                        if (n.sent(), r = {
                                isForce: !1,
                                isFake: !0,
                                diffTime: e,
                                successDiff: t,
                                errMsg: "微信分享回调已经废弃，这是模拟分享成功"
                            }, "success" === this.forceResult) return r.isForce = !0, r.errMsg = "强制分享成功", [2, r];
                        if ("fail" === this.forceResult) throw r.isForce = !0, r.errMsg = "强制分享失败", r;
                        if (e < t) throw r.errMsg = "分享操作太快，模拟分享失败", r;
                        return [2, r];
                }
            });
        });
    },
    destroy: function () {
        this.destroyed || (this._unbind(), this.destroyed = !0);
    }
};

var vs = {
        withShareTicket: !0,
        openGetShareTheme: !0,
        shareSuccessDiff: 2e3,
        onShareCallbackTime: 500,
        useShareAdapter: !0
    },
    ys = {},
    ws = {},
    Is = "",
    _s = !1,
    Ss = "";

Zt.once(Rt, function () {
    var e;
    b(Yt, Ye), e = D();
    var r = (ys = Object.assign({}, ys || vs, e || {})).openShareTimeline,
        o = void 0 !== r && r,
        s = u("onShareTimeline", "2.11.3") && o;
    Je(s ? {
        withShareTicket: !0,
        menus: ["shareAppMessage", "shareTimeline"]
    } : {
        withShareTicket: !0
    }), ot(function () {
        return {};
    }), s && st(function () {
        return {};
    });
    var a = ys || {},
        c = a.openGetShareTheme,
        d = void 0 === c || c,
        l = a.shareThemes;
    d && function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = (ys || {}).gameId, r = {
                                gameID: t
                            }, e && e.length && (r.shareTypes = e), i = "" + tn.combHost + sn, [4, bn.post(i, {
                                gameId: t,
                                gameTp: "minigame",
                                shareSceneTypes: [1, 2]
                            })];

                        case 1:
                            return [2, n.sent()];
                    }
                });
            });
        }(l).then(function (e) {
            $e(e);
        }).catch(function (e) {
            i("getShareTheme err", e);
        }),
        function (e) {
            u("onShareMessageToFriend", "2.9.4") && wx.onShareMessageToFriend(e);
        }(function (e) {
            Zt.dispatch(Tr, e);
        });
}), Zt.once(Vt, function () {
    at();
});

var Ts = u("requestSubscribeMessage", "2.8.3"),
    bs = u("requestSubscribeWhatsNew", "2.10.4"),
    Cs = {
        accept: "acceptIds",
        reject: "rejectIds",
        ban: "banIds"
    },
    xs = {
        TasksErr: {
            errCode: 70001,
            errMsg: "获取任务失败"
        },
        NoTask: {
            errCode: 70002,
            errMsg: "任务不存在"
        },
        GoErr: {
            errCode: 70003,
            errMsg: "跳转任务失败"
        },
        AwardGetted: {
            errCode: 70004,
            errMsg: "已经领取奖励"
        },
        GetAwardErr: {
            errCode: 70005,
            errMsg: "领奖失败"
        }
    },
    ks = "panel",
    Os = {
        InBox: 1,
        InGame: 2,
        Login: 3,
        Play: 4,
        PlayNoSDK: 5
    },
    Ps = "",
    Es = function () {
        if (!Ps) {
            var e = d();
            Ps = JSON.stringify({
                SDKVersion: e.SDKVersion,
                brand: e.brand,
                model: e.model,
                system: e.system,
                version: e.version,
                wallSDKV: e.hortorSDKVersion
            });
        }
        return Ps;
    },
    As = function (e) {
        var t = D() || {},
            n = t.gameId,
            r = t.wallKey,
            i = t.gameVersion,
            o = t.key,
            s = Mr.getSDKUserInfo() || {},
            a = s.userId,
            c = s.uniqueId,
            u = s.sex,
            d = s.channel,
            l = s.origChannel,
            f = s.masterUniqueId,
            h = Mr.getGameUser(),
            g = h.serverId,
            p = void 0 === g ? "" : g,
            m = h.roleId,
            v = U();
        v.scene;
        var y = v.custom || {},
            w = y.channel,
            I = y.origChannel;
        return Object.assign({
            gameId: n,
            key: r || o,
            gameVersion: i,
            openId: a || m,
            gameServerId: p,
            sex: u,
            uniqueId: c || m,
            masterUniqueId: f || m,
            channel: d || w,
            origChannel: l || I,
            sysInfo: Es()
        }, e || {});
    },
    Us = "",
    Ds = As,
    Ms = function () {
        return Us;
    },
    Ns = function (e, t) {
        ! function (e) {
            var t = D() || {},
                n = t.wallKey,
                r = t.key;
            if (n || r) {
                var i = (U().custom || {}).boxCode,
                    o = void 0 === i ? "" : i,
                    s = As(Object.assign({
                        traceId: "",
                        wallCode: o
                    }, e || {})),
                    a = tn.combHost + "/wall/api/v1/log";
                bn.postForm(a, s).then(function (e) {
                    Us = ((e || {}).data || {}).traceIdStr || "";
                }).catch(function () {});
            }
        }(Et({
            logType: e
        }, t));
    },
    Ls = {
        createQRCode: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o, s, a, c;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 4, 5, 6]), i("creating code ", e), r = (t = e || {}).codeUrl,
                                o = t.backUrl, wx.showLoading(Object.assign({
                                    title: "请稍等..."
                                }, u || {})), [4, this._createImages({
                                    codeUrl: r,
                                    backUrl: o
                                })];

                        case 1:
                            return s = n.sent(), [4, this._drawQRCodeMiniGame(s)];

                        case 2:
                            return a = n.sent().tempFilePath, [4, Zo.previewImage(a)];

                        case 3:
                            return [2, n.sent()];

                        case 4:
                            throw i("create code fail ", c = n.sent()), c;

                        case 5:
                            return wx.hideLoading(), [7];

                        case 6:
                            return [2];
                    }
                    var u;
                });
            });
        },
        _createImages: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s, a, c;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            for (i in t = {}, r = [], e) r.push(i);
                            o = 0, n.label = 1;

                        case 1:
                            return o < r.length ? (s = r[o], a = t, c = s, [4, (u = e[s], new Promise(function (e, t) {
                                var n = wx.createImage();
                                n.src = u, n.onload = function (t) {
                                    e(n);
                                }, n.onerror = t;
                            }))]) : [3, 4];

                        case 2:
                            a[c] = n.sent(), n.label = 3;

                        case 3:
                            return o++, [3, 1];

                        case 4:
                            return [4, yn.wait(100)];

                        case 5:
                            return n.sent(), [2, t];
                    }
                    var u;
                });
            });
        },
        _drawQRCodeMiniGame: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return t = e.backUrl, r = e.codeUrl, (i = {
                                    w: 750,
                                    h: 1334,
                                    cw: 260,
                                    cp: .05,
                                    cx: .5,
                                    cy: .828
                                }).cx = parseInt(String(i.cx * i.w), 10), i.cy = parseInt(String(i.cy * i.h), 10),
                                i.cp = parseInt(String(i.cp * i.cw), 10), i.cr = parseInt(String(i.cw / 2), 10),
                                i.cqw = parseInt(String(i.cw - 2 * i.cp), 10), i.cqx = parseInt(String(i.cx - i.cqw / 2), 10),
                                i.cqy = parseInt(String(i.cy - i.cqw / 2), 10), (o = wx.createCanvas()).width = i.w,
                                o.height = i.h, (s = o.getContext("2d")).drawImage(t, 0, 0, i.w, i.h), s.beginPath(),
                                s.arc(i.cx, i.cy, i.cr, 0, 2 * Math.PI), s.fillStyle = "rgba(255,255,255,1)", s.fill(),
                                s.clip(), s.drawImage(r, i.cqx, i.cqy, i.cqw, i.cqw), [4, yn.wait(100)];

                        case 1:
                            return n.sent(), [4, this._toTempFilePath(o, i)];

                        case 2:
                            return [2, n.sent()];
                    }
                });
            });
        },
        _toTempFilePath: function (e, t) {
            return new Promise(function (n, r) {
                var i = t.x,
                    o = void 0 === i ? 0 : i,
                    s = t.y,
                    a = void 0 === s ? 0 : s,
                    c = t.w,
                    u = t.h;
                e.toTempFilePath({
                    x: o,
                    y: a,
                    width: c,
                    height: u,
                    destWidth: c,
                    destHeight: u,
                    success: n,
                    fail: r
                });
            });
        }
    },
    Rs = !1,
    qs = "hsdk_wall_tasks",
    Hs = {
        logined: !1,
        tasksMap: {},
        lastTask: null,
        onlineTimer: null,
        onlineTime: 0,
        onlineTotal: 0,
        allTasks: [],
        dataSource: "",
        init: function () {
            Zt.once(qt, this._onLaunch.bind(this)), Zt.once(Bt, this._onLogined.bind(this));
        },
        _onLaunch: function () {
            var e = Mr.getSDKUserInfo() || {},
                t = e.userId,
                n = e.uniqueId;
            if (t && n) return Ns(2);
            Zt.once(Vt, function () {
                Ns(2);
            });
        },
        _onLogined: function () {
            this.logined || (this.logined = !0, i("wall logined"), this.postLog(3), this._startOnline(),
                this._bindEvent());
        },
        _startOnline: function () {
            var e = this;
            if ((U().custom || {}).boxCode) {
                var t = function () {
                        e.onlineTime += 10, e.onlineTotal += 10;
                        var t = Ms();
                        !t || e.onlineTime < 60 || (e.postLog(6, {
                            wallCode: "",
                            online: e.onlineTime,
                            onlineTotal: e.onlineTotal,
                            traceIdStr: t
                        }), e.onlineTime = 0);
                    },
                    n = function () {
                        i("wall start beat"), yn.reclearInterval(e.onlineTimer), e.onlineTimer = yn.resetInterval(t, 1e4);
                    };
                Zt.on(qt, n), Zt.on(Ht, function () {
                    i("wall clear beat"), yn.reclearInterval(e.onlineTimer);
                }), n();
            }
        },
        _bindEvent: function () {
            var e = this,
                t = null,
                n = (D() || {}).taskCheckDelay || 1500;
            Zt.on(qt, function (r) {
                var i = (r || {}).data;
                e._fixOnlineLog(i), t = setTimeout(e.checkLastTask.bind(e), n);
            }), Zt.on(Ht, function () {
                t && (clearTimeout(t), t = null);
            });
        },
        _getTasks: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o, s, a, c, u, d;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return (t = function () {
                                var e = Bn.getStorage(qs);
                                if (!e) return null;
                                try {
                                    var t = JSON.parse(e),
                                        n = new Date().getTime(),
                                        r = t.saveTime;
                                    return n - r > 6e4 || n <= r ? null : t;
                                } catch (e) {
                                    return null;
                                }
                            }()) ? (i("wall get cache tasks", t.taskList), this.handleTaskMap(t.taskList), [2, t]) : [3, 1];

                        case 1:
                            return r = tn.combHost + "/wall/api/v1/tasks", o = Ds(), e && (o = Object.assign(o, e)),
                                [4, bn.postForm(r, o)];

                        case 2:
                            if (s = n.sent().data, c = (a = s || {}).tasks, (u = a.dataSource) && (this.dataSource = u),
                                i("wall get tasks", s), !c) throw xs.TasksErr;
                            return this.handleTaskMap(c), c = c.filter(function (e) {
                                    return "hideTask" !== e.wallLimitMissIcon;
                                }),
                                function (e) {
                                    e.saveTime = new Date().getTime(), Bn.setStorage(qs, JSON.stringify(e));
                                }(d = {
                                    taskList: c
                                }), [2, d];
                    }
                });
            });
        },
        getTasks: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), [4, this._getTasks(e)];

                        case 1:
                            return [2, n.sent()];

                        case 2:
                            throw i("wall get tasks err", t = n.sent()), t;

                        case 3:
                            return [2];
                    }
                });
            });
        },
        _goTask: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o, s, a, c, u, d, l, f, h, g, p, m, v, y, w, I, _;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            if (r = (t = e || {}).taskId, o = t.wallPosition, !(s = this.tasksMap[r])) throw xs.NoTask;
                            return (a = Ds({
                                    taskId: r,
                                    wallPosition: o,
                                    isABTest: Rs
                                }) || {}).dataSource = this.dataSource, c = tn.combHost + "/wall/api/v1/go_task",
                                [4, bn.postForm(c, a)];

                        case 1:
                            if (u = n.sent().data, d = (u || {}).traceId, i("wall go task", u), !d) throw u || xs.GoErr;
                            f = (l = u || {}).useNav, h = l.appId, g = l.appPath, p = l.appEnvVersion, m = l.appExtraData,
                                v = l.mixedQrcodeImg, y = {
                                    appId: h,
                                    path: g,
                                    envVersion: p || "release",
                                    extraData: m ? JSON.parse(m) : {}
                                }, w = (D() || {}).gameId, I = (Mr.getSDKUserInfo() || {}).uniqueId, y.extraData = Object.assign(y.extraData, {
                                    origGameId: w || "",
                                    origUniqueId: I || ""
                                }), n.label = 2;

                        case 2:
                            return n.trys.push([2, 7, , 9]), pt(), f && Zo._canUseNavigate ? (i("wall jump params", y, v),
                                [4, Zo.navigateToMiniProgram(y, v)]) : [3, 4];

                        case 3:
                            return n.sent(), [3, 6];

                        case 4:
                            return [4, Zo.previewImage(v)];

                        case 5:
                            n.sent(), n.label = 6;

                        case 6:
                            return [3, 9];

                        case 7:
                            if ((_ = n.sent()).isCancel) throw _;
                            return i("wall try go err", _), [4, Ls.createQRCode({
                                codeUrl: u.qrcodeImg,
                                backUrl: u.qrcodeBg,
                                posX: u.qrcodePosX,
                                posY: u.qrcodePosY
                            })];

                        case 8:
                            return n.sent(), [3, 9];

                        case 9:
                            return this.postLog(5, {
                                taskId: r,
                                traceId: d,
                                wallPosition: o,
                                isABTest: Rs
                            }), this._setLastTask(s, d), pt(), [2, u];
                    }
                });
            });
        },
        goTask: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), i("wall start go", e), [4, this._goTask(e)];

                        case 1:
                            return [2, n.sent()];

                        case 2:
                            throw i("wall go task err", t = n.sent()), t;

                        case 3:
                            return [2];
                    }
                });
            });
        },
        _getAward: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o, s, a;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            if (!(t = this.tasksMap[e])) throw xs.NoTask;
                            if (0 != t.awareAccpetStatus) throw xs.AwardGetted;
                            return r = Ds({
                                taskId: e
                            }), o = tn.combHost + "/wall/api/v1/award", [4, bn.postForm(o, r)];

                        case 1:
                            if (s = n.sent().data, a = (s || {}).traceId, i("wall get award", s), !a) throw s || xs.GetAwardErr;
                            return pt(), [2, s];
                    }
                });
            });
        },
        getAward: function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), [4, this._getAward(e)];

                        case 1:
                            return [2, n.sent()];

                        case 2:
                            throw i("wall get award err", t = n.sent()), t;

                        case 3:
                            return [2];
                    }
                });
            });
        },
        _setLastTask: function (e, t) {
            this.lastTask = Et({
                traceId: "" + t
            }, e);
        },
        _checkLastTask: function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, o, s, a;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return r = (t = e || {}).taskId, o = t.actionType, r && -1 !== [Os.Play, Os.PlayNoSDK].indexOf(o) ? (i("wall check task", r, o),
                                s = tn.combHost + "/wall/api/v1/task/status", [4, bn.get(s, Ds({
                                    taskId: r
                                }))]) : [2, null];

                        case 1:
                            return ((a = n.sent().data) || {}).isAlert ? [4, _o(Object.assign({
                                title: "提醒",
                                content: "还有游戏没体验完",
                                showCancel: !1,
                                confirmText: "确定"
                            }, a))] : [2, null];

                        case 2:
                            return [2, n.sent()];
                    }
                });
            });
        },
        checkLastTask: function () {
            var e = this;
            this._checkLastTask(this.lastTask).then(function () {
                e.lastTask = null;
            }).catch(function (e) {
                i("wall check task err", e);
            });
        },
        _fixOnlineLog: function (e) {
            var t = this.lastTask || {},
                n = t.traceId,
                r = t.taskId,
                o = t.actionType;
            if (r && n && o === Os.PlayNoSDK) {
                var s = (e || {}).hideDuration;
                i("wall fix log", r, s);
                var a = Math.floor(s / 1e3);
                this.postLog(8, {
                    traceId: n,
                    traceIdStr: n,
                    onlineTotal: a,
                    online: 60,
                    wallCode: ""
                });
            }
        },
        postLog: function (e, t) {
            void 0 === t && (t = {}), t.dataSource = this.dataSource, Ns(e, t);
        },
        logOpenTaskPanel: function () {
            var e = this.allTasks.map(function (e) {
                return e.gameId;
            }).join(",");
            this.postLog(4, {
                wallPosition: ks,
                isABTest: Rs,
                adGames: e
            });
        },
        handleTaskMap: function (e) {
            var t = this;
            e.length && (Rs = !!e[0].isABTest), e.map(function (e) {
                t.tasksMap[e.taskId] = e;
            }), this.allTasks = e;
        }
    };

Hs.init();

var Fs, js = u("createFeedbackButton", "2.1.2"),
    Vs = u("getLogManager", "2.1.0");

Zt.on(Gt, function () {
    yt("log", "update start");
}), Zt.on(jt, function () {
    yt("log", "login start");
}), Zt.on(fr, function (e) {
    var t = ((e || {}).data || {}).err;
    if (t) return yt("warn", "checkSession err:", t);
    yt("log", "checkSession success");
}), Zt.on(hr, function (e) {
    var t = ((e || {}).data || {}).err;
    if (t) return yt("warn", "wx login err:", t);
    yt("log", "wx logined");
}), Zt.on(gr, function (e) {
    yt("log", "tracklogin: ", e && e.data);
}), Zt.on(pr, function () {
    yt("log", "wx need auth");
}), Zt.on(mr, function () {
    yt("log", "wx authed");
}), Zt.on(vr, function () {
    yt("log", "wx auth deny");
}), Zt.on(Vt, function () {
    yt("log", "logined");
}), Zt.on(Wt, function () {
    yt("log", "updated");
}), Zt.on(qt, function (e) {
    yt("log", "onshow");
}), Zt.on(Ft, function (e) {
    yt("warn", "onerr:", e && e.data);
}), Zt.on(yr, function (e) {
    yt("warn", "pay fail:", e && e.data);
}), Zt.on(xr, function (e) {
    yt("warn", "video ad err:", e && e.data);
});

var Gs = {
        confTp: "",
        forceAlert: !1,
        wxSendConf: {},
        displayTimes: 0,
        moneyStart: 0,
        moneyEnd: 0,
        wechatIdImg: {
            backgroundImg: "",
            closeImg: "",
            closeCoordinate: {
                x: 0,
                y: 0
            },
            confirmImg: "",
            confirmCoordinate: {
                x: 0,
                y: 0
            },
            wechatIdCoordinate: {
                x: 0,
                y: 0
            }
        },
        customerSessionImg: {
            backgroundImg: "",
            closeImg: "",
            closeCoordinate: {
                x: 0,
                y: 0
            },
            confirmImg: "",
            confirmCoordinate: {
                x: 0,
                y: 0
            },
            wechatIdCoordinate: {
                x: 0,
                y: 0
            }
        }
    },
    Ws = !1,
    Ks = "",
    Bs = "scope.writePhotosAlbum",
    zs = "minigame",
    Js = [];

Zt.on(Vt, function (e) {
    var t = U().query;
    "brandWall" === (null == t ? void 0 : t.sdkFrom) && kt("login");
});

var Qs = !1;

wx.onShow(function (e) {
        1023 === e.scene && (Qs = !0);
    }), exports.AddicationType = Xr, exports.BindPlatformType = Qr, exports.ENV = Hr,
    exports.EventType = jr, exports.GSFlowType = ei, exports.GSLogType = $r, exports.GSServiceType = Zr,
    exports.LogType = Fr, exports.MicroProgramType = Jr, exports.MonitorType = qr, exports.NoticeType = Vr,
    exports.QQMicroAppType = Br, exports.QQScene = Wr, exports.SMSCodeType = Gr, exports.SwitchStatus = Yr,
    exports.VibrateType = ti, exports.WXMicroAppType = zr, exports.WXScene = Kr, exports._getWXCode = function () {
        return ee();
    }, exports.aggregationRequest = function (e) {
        return ni.post(e);
    }, exports.brandWallShowTrack = function () {
        kt("show");
    }, exports.checkCanGetOneTimeReward = function () {
        return new Promise(function (e, t) {
            var n = D().combGameId,
                r = (Mr.getSDKUserInfo() || {}).uniqueId;
            bn.post(tn.combHost + "/comb-platform-server/api/v1/mp/sdk/user_subscribe", {
                gameId: n,
                uniqueId: r
            }).then(function (n) {
                (null == n ? void 0 : n.data) ? e({
                    canGetReward: n.data.subscribe
                }): t(n);
            }).catch(function (e) {
                t(e);
            });
        });
    }, exports.checkIPs = function (e) {
        return oi.checkIps(e);
    }, exports.checkIsAddedToMyMiniProgram = function () {
        return new Promise(function (e, t) {
            wx.checkIsAddedToMyMiniProgram ? wx.checkIsAddedToMyMiniProgram({
                success: function (n) {
                    n && "boolean" == typeof n.added ? e({
                        isAdded: n.added
                    }) : t({
                        errMsg: "回调参数值异常",
                        res: n
                    });
                },
                fail: function (e) {
                    t({
                        errMsg: e
                    });
                }
            }) : t({
                errMsg: ir
            });
        });
    }, exports.checkSwitches = function (e) {
        var t = [];
        return e && e.switchIdList && "function" == typeof e.switchIdList.forEach && e.switchIdList.forEach(function (e) {
            t.push(e);
        }), li.check(t, e.params);
    }, exports.chooseImage = function (e) {
        return new Promise(function (e, t) {
            wx.chooseImage({
                count: 1,
                sizeType: ["compressed"],
                success: function (t) {
                    e({
                        imagePath: t.tempFilePaths[0]
                    });
                },
                fail: t
            });
        });
    }, exports.closeMacPayModal = function () {
        return ke(Jo), Promise.resolve();
    }, exports.closeWindowsPayModal = Ae, exports.createFeedbackButton = function (e) {
        return vt(e);
    }, exports.createUserInfoButton = function (e) {
        return J(e);
    }, exports.debug = i, exports.debugLog = function (e) {
        void 0 === e && (e = {}), di.postLog(di.LOG_TP.DEBUG, e.msg, e.data);
    }, exports.decodeShareTicket = function () {
        return t(this, void 0, void 0, function () {
            return n(this, function (e) {
                return [2, ct()];
            });
        });
    }, exports.errorLog = function (e) {
        void 0 === e && (e = {}), di.postLog(di.LOG_TP.ERROR, e.msg, e.data);
    }, exports.gameTrack = ye, exports.getAggregationTypes = function () {
        return Promise.resolve({
            type: ni.AggrType
        });
    }, exports.getAward = function (e) {
        return Hs.getAward(e.id);
    }, exports.getBattery = function () {
        return new Promise(function (e, t) {
            new Promise(function (e, t) {
                wx.getBatteryInfo({
                    success: e,
                    fail: t
                });
            }).then(function (t) {
                e({
                    battery: null == t ? void 0 : t.level,
                    isCharging: null == t ? void 0 : t.isCharging
                });
            }).catch(t);
        });
    }, exports.getBrandWallList = function () {
        return new Promise(function (e, t) {
            var n = (Mr.getSDKUserInfo() || {}).uniqueId,
                r = D().gameId;
            bn.post(tn.combHost + "/brand_wall-server/api/v1/brand_game", {
                gameId: r,
                uniqueId: n,
                gameTp: zs,
                sysInfo: l()
            }).then(function (t) {
                (null == t ? void 0 : t.data) && (t.data.forEach(function (e, t) {
                    e.index = t;
                }), Js = t.data, e(t.data));
            }).catch(function (e) {
                t(e);
            });
        });
    }, exports.getBrightness = function () {
        return new Promise(function (e, t) {
            new Promise(function (e, t) {
                wt({
                    apiName: "getScreenBrightness",
                    version: "1.2.0"
                }).then(function () {
                    wx.getScreenBrightness({
                        success: e,
                        fail: t
                    });
                }).catch(t);
            }).then(function (t) {
                var n = t.value;
                e({
                    brightness: n
                });
            }).catch(t);
        });
    }, exports.getClipboard = function () {
        return new Promise(function (e, t) {
            wx.getClipboardData().then(function (t) {
                e({
                    text: t.data
                });
            }).catch(t);
        });
    }, exports.getConfig = D, exports.getExtUserInfo = function () {
        return ii.getExtUserInfo();
    }, exports.getGSInfo = function () {
        var e = (Mr.getSDKUserInfo() || {}).uniqueId,
            t = tn.combHost + "/customer/api/v1/gs/new/comb/info?gameId=" + Un.option.combGameId + "&gameTp=comb&uniqueId=" + e + "&system=" + (wn ? "ios" : "android");
        return new Promise(function (e, n) {
            bn.get(t).then(function (t) {
                var r, i, o, s, a, c, u, d, l, f, h, g, p, m, v, y, w, I, _, S, T, b, C, x, k, O, P, E;
                console.log(t), 0 === (null === (r = null == t ? void 0 : t.meta) || void 0 === r ? void 0 : r.errCode) && (null === (i = null == t ? void 0 : t.data) || void 0 === i ? void 0 : i.conf) || n(t),
                    Gs = t.data.conf, ["gs", "secret"].includes(Gs.confTp) || n(t), Ws = !0, e({
                        serviceType: Gs.confTp,
                        isForceAlert: Gs.forceAlert,
                        secretMoneyRange: [Gs.moneyStart, Gs.moneyEnd],
                        gsFlowTp: t.data.gsFlowTp,
                        customer: {
                            backgroundImg: null === (o = Gs.customerSessionImg) || void 0 === o ? void 0 : o.backgroundImg,
                            closeImg: null === (s = Gs.customerSessionImg) || void 0 === s ? void 0 : s.closeImg,
                            closeX: null === (c = null === (a = Gs.customerSessionImg) || void 0 === a ? void 0 : a.closeCoordinate) || void 0 === c ? void 0 : c.x,
                            closeY: null === (d = null === (u = Gs.customerSessionImg) || void 0 === u ? void 0 : u.closeCoordinate) || void 0 === d ? void 0 : d.y,
                            jumpImg: null === (l = Gs.customerSessionImg) || void 0 === l ? void 0 : l.confirmImg,
                            jumpX: null === (h = null === (f = Gs.customerSessionImg) || void 0 === f ? void 0 : f.confirmCoordinate) || void 0 === h ? void 0 : h.x,
                            jumpY: null === (p = null === (g = Gs.customerSessionImg) || void 0 === g ? void 0 : g.confirmCoordinate) || void 0 === p ? void 0 : p.y
                        },
                        wechat: {
                            backgroundImg: null === (m = Gs.wechatIdImg) || void 0 === m ? void 0 : m.backgroundImg,
                            posX: null === (y = null === (v = Gs.wechatIdImg) || void 0 === v ? void 0 : v.wechatIdCoordinate) || void 0 === y ? void 0 : y.x,
                            posY: null === (I = null === (w = Gs.wechatIdImg) || void 0 === w ? void 0 : w.wechatIdCoordinate) || void 0 === I ? void 0 : I.y,
                            code: t.data.wechatId,
                            closeImg: null === (_ = Gs.wechatIdImg) || void 0 === _ ? void 0 : _.closeImg,
                            closeX: null === (T = null === (S = Gs.wechatIdImg) || void 0 === S ? void 0 : S.closeCoordinate) || void 0 === T ? void 0 : T.x,
                            closeY: null === (C = null === (b = Gs.wechatIdImg) || void 0 === b ? void 0 : b.closeCoordinate) || void 0 === C ? void 0 : C.y,
                            copyImg: null === (x = Gs.wechatIdImg) || void 0 === x ? void 0 : x.confirmImg,
                            copyX: null === (O = null === (k = Gs.wechatIdImg) || void 0 === k ? void 0 : k.confirmCoordinate) || void 0 === O ? void 0 : O.x,
                            copyY: null === (E = null === (P = Gs.wechatIdImg) || void 0 === P ? void 0 : P.confirmCoordinate) || void 0 === E ? void 0 : E.y
                        }
                    });
            }).catch(function (e) {
                n(e);
            });
        });
    }, exports.getGameClubData = function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, i, o, s;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        t = [1, 3, 4, 5, 6, 7, 8, 9].map(function (e) {
                            return {
                                type: e
                            };
                        }), (null == e ? void 0 : e.officialTopicId) && t.push({
                            type: 10,
                            subKey: e.officialTopicId
                        }), n.label = 1;

                    case 1:
                        return n.trys.push([1, 4, , 5]), [4, Tt(t)];

                    case 2:
                        return r = n.sent(), i = r.encryptedData, o = r.iv, s = r.signature, [4, bt(i, o, s)];

                    case 3:
                        return [2, n.sent()];

                    case 4:
                        throw n.sent();

                    case 5:
                        return [2];
                }
            });
        });
    }, exports.getGetUserInfoBtn = function (e) {
        return Po && !e ? Po : ce(e);
    }, exports.getGsSetting = It, exports.getHTLauchOptions = U, exports.getHasOpenedFromDesktopIcon = function () {
        return 1023 === wx.getLaunchOptionsSync().scene || Qs;
    }, exports.getHasSubscribedGameUpdate = function (e) {
        return function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), [4, lt(e)];

                        case 1:
                            return [2, n.sent()];

                        case 2:
                            return i("获取游戏更新订阅状态 err", t = n.sent()), [2, Promise.reject(t)];

                        case 3:
                            return [2];
                    }
                });
            });
        }(e);
    }, exports.getIsFromChannel = function () {
        return new Promise(function (e, t) {
            var n = x();
            e({
                isFromChannel: !!(n.query.adFrom && n.query.adFrom.length > 0)
            });
        });
    }, exports.getKeyByKeyType = function (e) {
        return t(this, void 0, void 0, function () {
            var t, r, i, o, s;
            return n(this, function (n) {
                switch (n.label) {
                    case 0:
                        if (n.trys.push([0, 2, , 3]), t = e.secretKeyType, !(r = (Mr.getSDKUserInfo() || {}).uniqueId)) throw new Error("");
                        return i = tn.combKMS + "/kms-server/api/v1/key/public", [4, bn.get(i, {
                            secretKeyType: t,
                            uniqueId: r
                        })];

                    case 1:
                        if (!(o = n.sent()).data) throw new Error("");
                        return [2, {
                            secretKey: o.data
                        }];

                    case 2:
                        throw s = n.sent(), {
                            errMsg: "公钥获取失败" + JSON.stringify(s)
                        };

                    case 3:
                        return [2];
                }
            });
        });
    }, exports.getNetworkType = function () {
        return new Promise(function (e, t) {
            new Promise(function (e, t) {
                wx.getNetworkType({
                    success: e,
                    fail: t
                });
            }).then(function (t) {
                var n = t.networkType;
                e({
                    networkType: n
                });
            }).catch(t);
        });
    }, exports.getNotchInfo = function () {
        return v();
    }, exports.getNotice = function (e) {
        return void 0 === e && (e = {}), ci.getNotice(e);
    }, exports.getProtocolText = function () {
        return new Promise(function (e, t) {
            Promise.all([Ct(0), Ct(1)]).then(function (t) {
                var n = t[0],
                    r = t[1];
                e({
                    userPolicyText: n,
                    privacyPolicyText: r
                });
            }).catch(function (e) {
                t(e);
            });
        });
    }, exports.getQuestionnaire = function (e) {
        return new Promise(function (t, n) {
            var r = (Mr.getSDKUserInfo() || {}).uniqueId,
                i = tn.combAPI + "questionnaires",
                o = {
                    gameId: Un.option.gameId,
                    roleLevel: (null == e ? void 0 : e.roleLevel) || 0,
                    uniqueId: r
                };
            bn.get(i, o).then(function (e) {
                var r, i, o, s, a, c, u;
                if (console.warn("getQuestionnaire", e), 0 == (null === (r = null == e ? void 0 : e.meta) || void 0 === r ? void 0 : r.errCode) && (null === (i = null == e ? void 0 : e.data) || void 0 === i ? void 0 : i.questionnaires) && (null === (s = null === (o = null == e ? void 0 : e.data) || void 0 === o ? void 0 : o.questionnaires) || void 0 === s ? void 0 : s.length) > 0) t(e.data.questionnaires);
                else {
                    if ((null === (a = null == e ? void 0 : e.data) || void 0 === a ? void 0 : a.questionnaires) && 0 != (null === (u = null === (c = null == e ? void 0 : e.data) || void 0 === c ? void 0 : c.questionnaires) || void 0 === u ? void 0 : u.length)) throw new Error(e.meta || {
                        errCode: -1,
                        errMsg: "获取问卷列表失败"
                    });
                    n({
                        errCode: -1,
                        errMsg: "问卷列表为空"
                    });
                }
            }).catch(function (e) {
                n(e);
            });
        });
    }, exports.getQuestionnaireConfig = function () {
        return new Promise(function (e, t) {
            var n = tn.combAPI + "questionnaires/config",
                r = {
                    gameId: Un.option.gameId || ""
                };
            bn.get(n, r).then(function (t) {
                if (console.warn("getQuestionnaireConfig", t), !(t && t.meta && 0 == t.meta.errCode && t.data)) throw new Error(t.meta || {
                    errCode: -1,
                    errMsg: "获取问卷配置失败"
                });
                e(t.data);
            }).catch(function (e) {
                t(e);
            });
        });
    }, exports.getShareData = function (e) {
        return (null == e ? void 0 : e.id) && (e.shareType = e.id + "-miniwechat"), new Promise(function (t, n) {
            var r = tt(e);
            r ? t(r) : n({
                errMsg: "getShareData failed"
            });
        });
    }, exports.getSubscribeMessageCount = function () {
        return function () {
            return t(this, void 0, void 0, function () {
                var e, t, r, o, s, a;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), e = D().gameId, t = Mr.getSDKUserInfo() || {},
                                r = t.userId, o = t.uniqueId, s = tn.subscribeHost + "/subscribe-server/api/v1/msg/num",
                                [4, bn.get(s, {
                                    gameId: e,
                                    openId: r,
                                    uniqueId: o
                                })];

                        case 1:
                            return [2, n.sent().data];

                        case 2:
                            return i("获取订阅次数 err", a = n.sent()), [2, Promise.reject(a)];

                        case 3:
                            return [2];
                    }
                });
            });
        }();
    }, exports.getTask = function (e) {
        return Hs.getTasks(e);
    }, exports.goTask = function (e) {
        return Hs.goTask({
            taskId: e.id,
            wallPosition: ks
        });
    }, exports.hideAd = function (e) {
        if (null == e ? void 0 : e.id) {
            var t = e.id,
                n = Qo[t];
            if (n) return new Promise(function (t, r) {
                "loaded" === n.status ? j().then(function (n) {
                    var r = n[null == e ? void 0 : e.id],
                        i = null == r ? void 0 : r.miniGameWxAdId;
                    "wxmg_template" === (null == r ? void 0 : r.adShowTp) ? (function (e) {
                        (null == e ? void 0 : e.id) && ($o[e.id].hide(), Ie({
                            state: "close",
                            type: "CustomAd",
                            id: e.id
                        }));
                    }(Object.assign({}, e, {
                        id: i
                    })), t(!0)) : "banner" === (null == r ? void 0 : r.adShowTp) && (function (e) {
                        (null == e ? void 0 : e.id) && Yo[e.id] && (Yo[e.id].hide(), Ie({
                            state: "close",
                            type: "Banner",
                            id: e.id
                        }));
                    }(Object.assign({}, e, {
                        id: i
                    })), t(!0));
                }).catch(function (e) {
                    r(e);
                }) : "loadFail" === n.status && r(n.loadFailReason);
            });
        }
    }, exports.hideLoading = function () {
        new Promise(function (e, t) {
            u("hideLoading", "1.1.0") ? wx.hideLoading({
                success: function () {
                    e();
                },
                fail: function (e) {
                    t(e);
                }
            }) : t({
                errMsg: ir
            });
        }).then(function (e) {
            i("hideLoading res", e);
        }).catch(function (e) {
            i("hideLoading err", e);
        });
    }, exports.information = Nr, exports.init = function (e) {
        return ri(e);
    }, exports.joinWechatGroup = function (e) {
        return new Promise(function (t, n) {
            var r = Un.sdkConfig().gameId,
                i = Un.sdkConfig().combGameId,
                o = tn.combHost + "/customer/api/v1/gameConfig/sdk/config?gameId=" + r;
            bn.get(o).then(function (r) {
                var o, s;
                console.warn(r), 0 == r.meta.errCode ? (o = r.data.ticketProgramAppId, s = Un.sdkConfig().env,
                    wx.showModal({
                        title: "加群方法",
                        content: "请点击下方按钮，跳转至小程序，长按识别二维码，并加入群聊",
                        showCancel: !1,
                        confirmText: "加入群聊",
                        success: function () {
                            wx.navigateToMiniProgram({
                                appId: o,
                                path: "/pages/wechatGroup/index?combGameId=" + i + "&env=" + s + "&attr=" + e.attr,
                                envVersion: s === HSDK.ENV.Production ? "release" : "trial",
                                success: t,
                                fail: n
                            });
                        },
                        fail: n
                    })) : n(r.meta.errMsg);
            }).catch(function (e) {
                console.warn(e), n(e);
            });
        });
    }, exports.jumpBrandWallGame = function (e) {
        return new Promise(function (t, n) {
            kt("click");
            var r = e.index,
                i = Js[r],
                o = i.appId,
                s = i.path,
                a = i.extraData,
                c = void 0 === a ? {} : a,
                u = i.envVersion;
            Zo.navigateToMiniProgram({
                appId: o,
                path: s,
                extraData: c,
                envVersion: u
            }).then(function (e) {
                t();
            }).catch(function (e) {
                n(e);
            });
        });
    }, exports.jumpGSCustomer = function () {
        return Ws ? Se(Gs.wxSendConf) : Promise.reject({
            errMsg: "has no gs conf"
        });
    }, exports.jumpGsMiniProgram = function (e) {
        var r = this;
        return new Promise(function (i, o) {
            return t(r, void 0, void 0, function () {
                var t, r, s;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            if (t = Un.sdkConfig().gameId, r = Un.sdkConfig().combGameId, Ks) return [3, 4];
                            n.label = 1;

                        case 1:
                            return n.trys.push([1, 3, , 4]), [4, It(1)];

                        case 2:
                            return n.sent(), [3, 4];

                        case 3:
                            return s = n.sent(), o(s), [3, 4];

                        case 4:
                            return wx.navigateToMiniProgram({
                                appId: Ks || "wx8d5d32e5505a18b0",
                                path: "/pages/index/index?userKey=" + e.userKey + "&gameId=" + r + "&subGameId=" + t,
                                success: i,
                                fail: o
                            }), [2];
                    }
                });
            });
        });
    }, exports.logOpenTaskPanel = function () {
        Hs.logOpenTaskPanel();
    }, exports.login = function (e) {
        return z(e, !1);
    }, exports.logout = function () {
        return we({
            eventName: "sdk_logout"
        }), Mr.clearUserInfo(), Promise.resolve();
    }, exports.network = Kn, exports.offError = function (e) {
        var t;
        t = (e = A(e, "offError")).listener, wx.offError(t);
    }, exports.offHide = function (e) {
        var t;
        t = (e = A(e, "offHide")).listener, wx.offHide(t);
    }, exports.offShow = function (e) {
        var t;
        t = (e = A(e, "offShow")).listener, wx.offShow(t);
    }, exports.onError = function (e) {
        var t;
        t = (e = A(e, "onError")).listener, wx.onError(t);
    }, exports.onHide = function (e) {
        O((e = A(e, "onHide")).listener);
    }, exports.onLogin = he, exports.onNeedPrivacyAuth = function (e) {
        var t = e.showPrivacyAuthUI,
            n = void 0 === t ? function (e) {
                e.onAgree, e.onRefuse;
            } : t,
            r = e.onNotSupport,
            i = void 0 === r ? function () {} : r;
        xt("onNeedPrivacyAuthCall"), "function" == typeof wx.onNeedPrivacyAuthorization ? wx.onNeedPrivacyAuthorization(function (e) {
            e({
                event: "exposureAuthorization"
            }), xt("onNeedPrivacyAuthExposure"), n({
                onAgree: function () {
                    e({
                        event: "agree"
                    }), xt("onNeedPrivacyAuthAgree");
                },
                onRefuse: function () {
                    e({
                        event: "disagree"
                    }), xt("onNeedPrivacyAuthRefuse");
                }
            });
        }) : (i(), xt("onNeedPrivacyAuthNotSupport"));
    }, exports.onShare = function (e) {
        return (null == e ? void 0 : e.id) && (e.shareType = e.id + "-miniwechat"),
            function (e) {
                ot(function () {
                    return e;
                });
            }(e);
    }, exports.onShareTimeline = function (e) {
        return (null == e ? void 0 : e.id) && (e.shareType = e.id + "-minifriend"),
            function (e) {
                st(function () {
                    return e;
                });
            }(e);
    }, exports.onShow = function (e) {
        k((e = A(e, "onShow")).listener);
    }, exports.openCustomerMiniApp = function (e) {
        return ts.goCustomer(e);
    }, exports.openCustomerServiceConversation = Se, exports.openPrivacyContract = function () {
        return xt("openPrivacyContractCall"), new Promise(function (e, t) {
            "function" == typeof wx.openPrivacyContract ? wx.openPrivacyContract({
                success: function (t) {
                    e(t), xt("openPrivacyContractSuccess");
                },
                fail: function (e) {
                    t(e), xt("openPrivacyContractFail: " + JSON.stringify(e));
                }
            }) : (t({
                errMsg: "微信基础库不支持"
            }), xt("openPrivacyContractNotSupport"));
        });
    }, exports.pay = function (e) {
        return function (e) {
            return t(this, void 0, void 0, function () {
                var t, r, i, o, s;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 18, , 19]), ls = null == e ? void 0 : e.orderId, fs = null == e ? void 0 : e.money,
                                Ue({
                                    state: "sdksuccess"
                                }), [4, De(e)];

                        case 1:
                            if (!(null == (t = n.sent()) ? void 0 : t.data)) throw Me(t), null == t ? void 0 : t.meta;
                            switch (r = t.data, i = r.orderId, Ue({
                                    state: "ordersuccess",
                                    type: o = r.platType
                                }), o) {
                                case "mdsPay":
                                    return [3, 2];

                                case "shellJump":
                                    return [3, 4];

                                case "miniH5":
                                    return [3, 6];

                                case "miniH5Qr":
                                    return [3, 8];

                                case "miniH5IOSQrWxPay":
                                case "miniH5IOSQrAliPay":
                                case "miniH5IOSQrMixPay":
                                    return [3, 10];

                                case "miniWinQr":
                                    return [3, 12];

                                case "miniH5IOSLinkWxPay":
                                case "miniH5IOSLinkAliPay":
                                case "miniH5IOSLinkMixPay":
                                    return [3, 14];
                            }
                            return [3, 16];

                        case 2:
                            return r.mdsPayInfo.orderId = i, [4, Fe(i, r.mdsPayInfo)];

                        case 3:
                        case 5:
                        case 7:
                        case 9:
                        case 11:
                        case 13:
                        case 15:
                            return [2, n.sent()];

                        case 4:
                            return r.shellPayInfo.orderId = i, [4, je(r.shellPayInfo)];

                        case 6:
                            return [4, Ne(r.miniH5PayInfo, e)];

                        case 8:
                            return [4, Re(r, e.parent)];

                        case 10:
                            return [4, qe(r, e.parent)];

                        case 12:
                            return [4, Le(r.miniH5WinQrPayInfo, e)];

                        case 14:
                            return [4, Ke(r.miniH5IOSLinkWxPayInfo)];

                        case 16:
                            throw Me(t), null == t ? void 0 : t.meta;

                        case 17:
                            return [3, 19];

                        case 18:
                            throw Ue({
                                state: "orderfail",
                                errMsg: S(s = n.sent())
                            }), s;

                        case 19:
                            return [2];
                    }
                });
            });
        }(e);
    }, exports.platformType = Mt, exports.postAPMLog = K, exports.postLog = function (e) {
        return void 0 === e && (e = {}), Wn.post(e.data, e.immediate);
    }, exports.preloadAd = function (e) {
        if (null == e ? void 0 : e.id) {
            var t = e.id;
            Qo[t] = {
                status: "loading"
            };
            var n = Qo[t];
            return new Promise(function (r, i) {
                j().then(function (o) {
                    var s = o[t];
                    if (void 0 === s) i({
                        errMsg: Xo
                    });
                    else {
                        var a = null == s ? void 0 : s.miniGameWxAdId;
                        "reward_video" === (null == s ? void 0 : s.adShowTp) ? function (e) {
                            return (null == e ? void 0 : e.id) && (e.adUnitId = e.id), "boolean" == typeof (null == e ? void 0 : e.isMulti) && (e.multiton = e.isMulti),
                                ki.check(e);
                        }(Object.assign({}, e, {
                            id: a
                        })).then(function (e) {
                            r(e), n.status = "loaded", n.isImmediateShow && _e(n.showOption);
                        }).catch(function (e) {
                            var t;
                            i(e), K({
                                msg: "preloadVideoAd err",
                                data: {
                                    adItem: n,
                                    err: e
                                }
                            }), n.status = "loadFail", n.loadFailReason = e, n.isImmediateShow && H(null === (t = n.showOption) || void 0 === t ? void 0 : t.onLoadFail, e);
                        }): "interstitial" === (null == s ? void 0 : s.adShowTp) ? function (e) {
                            return new Promise(function (t, n) {
                                (null == e ? void 0 : e.id) ? Ii.preLoad({
                                    adUnitIds: [e.id]
                                }).then(function (e) {
                                    t(!0);
                                }).catch(function (e) {
                                    n(e);
                                }): n({
                                    errMsg: "id is empty"
                                });
                            });
                        }(Object.assign({}, e, {
                            id: a
                        })).then(function (e) {
                            r(e), n.status = "loaded", n.isImmediateShow && _e(n.showOption);
                        }).catch(function (e) {
                            var t;
                            i(e), K({
                                msg: "preloadInterstitialAd err",
                                data: {
                                    adItem: n,
                                    err: e
                                }
                            }), n.status = "loadFail", n.loadFailReason = e, n.isImmediateShow && H(null === (t = n.showOption) || void 0 === t ? void 0 : t.onLoadFail, e);
                        }) : "wxmg_template" === (null == s ? void 0 : s.adShowTp) ? function (e) {
                            return new Promise(function (t, n) {
                                (null == e ? void 0 : e.id) ? (e.adUnitId = e.id, $o[e.id] = Pi.create(e), t($o[e.id])) : n({
                                    errMsg: "id is empty"
                                });
                            });
                        }(Object.assign({}, e, {
                            id: a
                        })).then(function (e) {
                            r(e), n.status = "loaded", n.isImmediateShow && _e(n.showOption);
                        }).catch(function (e) {
                            var t;
                            i(e), K({
                                msg: "preloadCustomAd err",
                                data: {
                                    adItem: n,
                                    err: e
                                }
                            }), n.status = "loadFail", n.loadFailReason = e, n.isImmediateShow && H(null === (t = n.showOption) || void 0 === t ? void 0 : t.onLoadFail, e);
                        }) : "banner" === (null == s ? void 0 : s.adShowTp) && function (e) {
                            if (null == e ? void 0 : e.id) return Yo[e.id] || (Yo[e.id] = vi.create(Object.assign({
                                adUnitId: e.id
                            }, e)), null !== Yo[e.id]) ? Promise.resolve(Yo[e.id]) : Promise.reject({
                                errMsg: "create bannerAd fail"
                            });
                        }(Object.assign({}, e, {
                            id: a
                        })).then(function (e) {
                            r(e), n.status = "loaded", n.isImmediateShow && _e(n.showOption);
                        }).catch(function (e) {
                            var t;
                            i(e), K({
                                msg: "preloadBannerAd err",
                                data: {
                                    adItem: n,
                                    err: e
                                }
                            }), n.status = "loadFail", n.loadFailReason = e, n.isImmediateShow && H(null === (t = n.showOption) || void 0 === t ? void 0 : t.onLoadFail, e);
                        });
                    }
                }).catch(function (e) {
                    var r;
                    i(e), K({
                        msg: "getAdScheme err",
                        data: {
                            id: t,
                            err: e
                        }
                    }), n.status = "loadFail", n.loadFailReason = e, n.isImmediateShow && H(null === (r = n.showOption) || void 0 === r ? void 0 : r.onLoadFail, e);
                });
            });
        }
        return Promise.reject({
            errMsg: "广告id不能为空"
        });
    }, exports.receiveMsgFromMainModule = function (e) {
        e = A(e, "receiveMsgFromMainModule"), Zt.on(Vt, function () {
            var t = D() || {},
                n = t.gameId,
                r = t.env,
                i = Mr.getTempUser() || {},
                o = Et({
                    gameId: n,
                    env: r
                }, i);
            e.listener && e.listener(o);
        });
    }, exports.receiveMsgWhileRunning = function () {
        var e = D() || {},
            t = e.gameId,
            n = e.env,
            r = Mr.getTempUser() || {};
        return Et({
            gameId: t,
            env: n
        }, r);
    }, exports.requestSubscribeGameUpdate = function (e) {
        return function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return n.trys.push([0, 2, , 3]), [4, ft(e)];

                        case 1:
                            return [2, n.sent()];

                        case 2:
                            return i("游戏更新订阅 err", t = n.sent()), [2, Promise.reject(t)];

                        case 3:
                            return [2];
                    }
                });
            });
        }(e);
    }, exports.requestSubscribeMessage = function (e) {
        return e.templateIdList && (e.tmplIds = e.templateIdList), new Promise(function (t, n) {
            ht(e).then(function (e) {
                var n = e || {};
                t({
                    playerId: n.playerId,
                    acceptIdList: n.acceptIds,
                    rejectIdList: n.rejectIds,
                    banIdList: n.banIds
                });
            }).catch(function (e) {
                n(e);
            });
        });
    }, exports.requirePrivacyAuth = function () {
        return xt("requirePrivacyAuthCall"), new Promise(function (e, t) {
            "function" == typeof wx.requirePrivacyAuthorize ? wx.requirePrivacyAuthorize({
                success: function (t) {
                    e(t), xt("requirePrivacyAuthSuccess");
                },
                fail: function (e) {
                    t(e), xt("requirePrivacyAuthFail: " + JSON.stringify(e));
                }
            }) : t({
                errMsg: "微信基础库不支持"
            });
        });
    }, exports.saveImage = function (e) {
        return new Promise(function (t, n) {
            try {
                var r = e.imagePath;
                wx.getSetting({
                    success: function (e) {
                        e.authSetting[Bs] ? St(r, t, n) : _t(r, t, n);
                    },
                    fail: function (e) {
                        _t(r, t, n);
                    }
                });
            } catch (e) {
                n({
                    errMsg: JSON.stringify(e)
                });
            }
        });
    }, exports.setBrightness = function (e) {
        (function (e) {
            var t = e.value;
            return new Promise(function (e, n) {
                wt({
                    apiName: "setScreenBrightness",
                    version: "1.2.0"
                }).then(function () {
                    wx.setScreenBrightness({
                        value: t,
                        success: e,
                        fail: n
                    });
                }).catch(n);
            });
        })({
            value: e.brightness
        }).then(function (e) {}).catch(function (e) {});
    }, exports.setClipboard = function (e) {
        return wx.setClipboardData({
            data: e.text
        });
    }, exports.setGameUserInfo = function (e) {
        var t;
        e && e.tgaInfo && (ye({
                eventType: "user_set",
                customData: e.tgaInfo
            }), delete e.tgaInfo), e && e.roleId && (void 0 === (t = {
                roleId: e.roleId
            }) && (t = {
                roleId: ""
            }), jo = t),
            function (e) {
                Mr.setGameUser(e);
            }(e);
    }, exports.setKeepScreenOn = function (e) {
        return new Promise(function (t, n) {
            try {
                wx.setKeepScreenOn({
                    keepScreenOn: e.isOn,
                    success: t,
                    fail: n
                });
            } catch (e) {
                n(e);
            }
        });
    }, exports.setVibrate = function (e) {
        return new Promise(function (t, n) {
            var r = {
                    errMsg: "setVibrate:ok"
                },
                i = e.type,
                o = {
                    type: "medium",
                    success: t(r),
                    fail: function (e) {
                        e && e.errMsg && e.errMsg.indexOf("style is not support") > 0 ? t(r) : n(e);
                    }
                };
            i === HSDK.VibrateType.Short ? wx.vibrateShort(o) : i === HSDK.VibrateType.Long ? (delete o.type,
                wx.vibrateLong(o)) : n(or);
        });
    }, exports.share = function (e) {
        return ut({
                state: "call",
                errMsg: S({
                    id: null == e ? void 0 : e.id
                })
            }), (null == e ? void 0 : e.id) && (e.shareType = e.id + "-miniwechat"), e.imagePath && (e.imageUrl = e.imagePath),
            new Promise(function (r, o) {
                (function (e) {
                    return t(this, void 0, void 0, function () {
                        return n(this, function (t) {
                            switch (t.label) {
                                case 0:
                                    if (Bo.getState(Pr)) throw rr;
                                    if (!e.activityId) return [3, 4];
                                    t.label = 1;

                                case 1:
                                    return t.trys.push([1, 3, , 4]), [4, ms.set(e)];

                                case 2:
                                    return t.sent(), [3, 4];

                                case 3:
                                    return i("update share err", t.sent()), [3, 4];

                                case 4:
                                    return [4, it(e)];

                                case 5:
                                    return [2, t.sent()];
                            }
                        });
                    });
                })(e).then(function (e) {
                    (null == e ? void 0 : e.shareData) && (e.shareData.id = e.shareData.type), r(e),
                        ut({
                            state: "success"
                        });
                }).catch(function (e) {
                    o(e), ut({
                        state: "fail",
                        errMsg: S(e)
                    });
                });
            });
    }, exports.showAd = _e, exports.showAppComment = function () {
        if (wx.openBusinessView) try {
            wx.openBusinessView({
                businessType: "servicecommentpage"
            });
        } catch (e) {}
    }, exports.showLoading = function (e) {
        void 0 === e && (e = {}), e.mask = (null == e ? void 0 : e.isShowMask) || !1, e.title || (e.title = ""),
            function (e) {
                return new Promise(function (t, n) {
                    u("showLoading", "1.1.0") ? wx.showLoading({
                        title: null == e ? void 0 : e.title,
                        mask: null == e ? void 0 : e.mask,
                        success: function () {
                            t();
                        },
                        fail: function (e) {
                            n(e);
                        }
                    }) : n({
                        errMsg: ir
                    });
                });
            }(e).then(function (e) {
                i("showLoading res", e);
            }).catch(function (e) {
                i("showLoading err", e);
            });
    }, exports.showModal = function (e) {
        return new Promise(function (t, n) {
            wx.showModal(Object.assign(e, {
                success: t,
                fail: n
            }));
        });
    }, exports.showQR = Te, exports.storage = Bn, exports.submitQuestionnaire = function (e) {
        return new Promise(function (t, n) {
            var r = (Mr.getSDKUserInfo() || {}).uniqueId,
                i = tn.combAPI + "questionnaires/" + e.questionnaireId + "/answers",
                o = {
                    roleId: e.roleId,
                    roleLevel: e.roleLevel || 0,
                    startTime: e.startTime,
                    endTime: e.endTime,
                    gameId: Un.option.gameId,
                    uniqueId: r,
                    answers: e.answers
                };
            bn.post(i, o).then(function (e) {
                if (console.warn("submitQuestionnaire", e), !e || !e.meta || 0 != e.meta.errCode) throw new Error((null == e ? void 0 : e.meta) || {
                    errCode: -1,
                    errMsg: "提交问卷失败"
                });
                t(e.meta);
            }).catch(function (e) {
                n(e);
            });
        });
    }, exports.trackGS = function (e) {
        if (void 0 === e && (e = {
                eventType: ""
            }), Ws) {
            var t = Mr.combUserInfo,
                n = t.envCombSdkInfo,
                r = t.combSdkInfo,
                i = r.uniqueId;
            n && n.uniqueId && (i = n.uniqueId);
            var o = tn.combHost + "/customer/api/v1/gs/new/log",
                s = e.eventType,
                a = {
                    gameId: Un.option.gameId,
                    confTp: Gs.confTp,
                    gameTp: "minigame",
                    eventTp: {
                        ICON_SHOW: 0,
                        ICON_CLICK: 1,
                        PAGE_SHOW_FORCE: 3,
                        PAGE_SHOW: 3,
                        JUMP_CUSTOMER_FORCE: 4,
                        JUMP_CUSTOMER: 4
                    } [s],
                    forceAlert: Gs.forceAlert,
                    isUserClick: "PAGE_SHOW" === s || "JUMP_CUSTOMER" === s,
                    IconShowTp: "game",
                    nodePlatform: "hortor_mix",
                    uniqueId: i,
                    guestOpenId: "",
                    parentUniqueId: r.uniqueId,
                    parentGuestOpenId: "",
                    parentMixGameId: Un.option.combGameId
                };
            bn.post(o, a).then(function (e) {}).catch(function (e) {});
        }
    }, exports.updateUserInfo = function (e) {
        return function (e) {
            return t(this, void 0, void 0, function () {
                var t;
                return n(this, function (n) {
                    switch (n.label) {
                        case 0:
                            return Zt.dispatch(Gt), [4, X(e, !1, !0)];

                        case 1:
                            return t = n.sent(), fe(45), Zt.dispatch(Wt, t), [2, t.combUser];
                    }
                });
            });
        }(e);
    }, exports.warnLog = function (e) {
        void 0 === e && (e = {}), di.postLog(di.LOG_TP.WARN, e.msg, e.data);
    }, exports.weakLogin = function (e) {
        return z(e, !0);
    }, exports.wxGetSetting = L;